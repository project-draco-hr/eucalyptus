{
  if (event instanceof StartComponentEvent) {
    StartComponentEvent e=(StartComponentEvent)event;
    if (Component.cluster.equals(e.getComponent()) && e.getConfiguration() instanceof ClusterConfiguration) {
      try {
        Cluster newCluster=ClusterUtil.createCluster((ClusterConfiguration)e.getConfiguration());
        this.registerClusterStateHandler(newCluster);
        ListenerRegistry.getInstance().fireEvent(new NewClusterEvent().setMessage(newCluster));
        return;
      }
 catch (      EucalyptusCloudException e1) {
        e.setFail(e1);
        return;
      }
catch (      EventVetoedException e1) {
        e.setFail(e1);
        return;
      }
    }
  }
 else   if (event instanceof StopComponentEvent) {
    StopComponentEvent e=(StopComponentEvent)event;
    if (Component.cluster.equals(e.getComponent()) && e.getConfiguration() instanceof ClusterConfiguration) {
      Cluster c=Clusters.getInstance().lookup(e.getConfiguration().getName());
      Clusters.getInstance().deregister(c.getName());
      c.getThreadGroup().stopThreads();
      try {
        ListenerRegistry.getInstance().fireEvent(new NewClusterEvent().setMessage(c));
        this.registerClusterStateHandler(c);
        return;
      }
 catch (      EventVetoedException e1) {
        e.setFail(e1);
        return;
      }
    }
  }
}
