{
  Map<String,String> formFields=new HashMap<String,String>();
  String contentType=httpRequest.getHeader(WalrusProperties.CONTENT_TYPE);
  if (contentType != null) {
    if (contentType.startsWith(WalrusProperties.MULTIFORM_DATA_TYPE)) {
      String boundary=getFormFieldKeyName(contentType,"boundary");
      boundary="--" + boundary + "\r\n";
      String message=getMessageString(httpRequest);
      String[] parts=message.split(boundary);
      for (      String part : parts) {
        Map<String,String> keyMap=getFormField(part,"name");
        Set<String> keys=keyMap.keySet();
        for (        String key : keys) {
          formFields.put(key,keyMap.get(key));
        }
      }
    }
  }
 else {
    throw new BindingException("No Content-Type specified");
  }
  return formFields;
}
