{
  if (event.getMessage() instanceof MappingHttpResponse) {
    MappingHttpResponse httpResponse=(MappingHttpResponse)event.getMessage();
    Binding binding=BindingManager.getBinding(BindingManager.sanitizeNamespace(namespace));
    OMElement omMsg=binding.toOM(httpResponse.getMessage());
    ByteArrayOutputStream byteOut=new ByteArrayOutputStream();
    omMsg.serialize(byteOut);
    byte[] req=byteOut.toByteArray();
    ChannelBuffer buffer=ChannelBuffers.copiedBuffer(req);
    httpResponse.addHeader(HttpHeaders.Names.CONTENT_LENGTH,String.valueOf(buffer.readableBytes()));
    httpResponse.addHeader(HttpHeaders.Names.CONTENT_TYPE,"text/plain");
    httpResponse.setContent(buffer);
  }
}
