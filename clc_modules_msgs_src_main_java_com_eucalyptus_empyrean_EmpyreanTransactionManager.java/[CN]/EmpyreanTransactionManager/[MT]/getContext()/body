{
  if (ctx != null) {
    return ctx;
  }
 else {
synchronized (EmpyreanTransactionManager.class) {
      if (ctx == null) {
        ctx=configureTm();
        try {
          tm=(TransactionManager)ctx.lookup(TransactionManagerServices.getConfiguration().getJndiUserTransactionName());
        }
 catch (        NamingException ex) {
          LOG.error(ex,ex);
        }
      }
      return ctx;
    }
  }
}
