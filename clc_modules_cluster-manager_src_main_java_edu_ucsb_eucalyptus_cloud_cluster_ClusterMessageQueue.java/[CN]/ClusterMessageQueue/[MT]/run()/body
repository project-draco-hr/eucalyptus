{
  while (!finished.get())   try {
    long start=System.currentTimeMillis();
    QueuedEvent event=this.msgQueue.poll(pollInterval,TimeUnit.MILLISECONDS);
    if (event != null) {
      LOG.trace("Dequeued message of type " + event.getCallback().getClass().getSimpleName());
      long msgStart=System.currentTimeMillis();
      try {
        ClusterConfiguration parentCluster=this.parent.getClusterInfo();
        Client nioClient=new NioClient(parentCluster.getHostName(),parentCluster.getPort(),parentCluster.getServicePath(),event instanceof QueuedLogEvent ? new LogClientPipeline(new NioResponseHandler()) : new ClusterClientPipeline(new NioResponseHandler()));
        event.trigger(nioClient);
        this.parent.setReachable(true);
      }
 catch (      Exception e) {
        LOG.error(e);
        this.parent.setReachable(false);
      }
 finally {
        event.getCallback().notifyHandler();
      }
      LOG.warn(String.format("[q=%04dms,send=%04dms,qlen=%02d] message type %s, cluster %s",msgStart - start,System.currentTimeMillis() - msgStart,this.msgQueue.size(),event.getCallback().getClass().getSimpleName(),this.parent.getClusterInfo().getName()));
    }
  }
 catch (  Exception e) {
    LOG.error(e,e);
  }
}
