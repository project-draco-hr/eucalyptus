{
  if (singleton != null) {
    return singleton.getBlock(length);
  }
 else {
synchronized (Counters.class) {
      if (singleton == null) {
        EntityWrapper<Counters> db=EntityWrapper.get(Counters.class);
        try {
          singleton=db.getUnique(new Counters());
        }
 catch (        EucalyptusCloudException e) {
          singleton=new Counters(0l);
          try {
            db.add(singleton);
            db.commit();
          }
 catch (          Exception e1) {
            db.rollback();
            LOG.fatal(e1,e1);
            LOG.fatal("Failed to initialize system counters.  These are important.");
          }
        }
catch (        Exception ex) {
          db.rollback();
        }
      }
    }
    return singleton.getBlock(length);
  }
}
