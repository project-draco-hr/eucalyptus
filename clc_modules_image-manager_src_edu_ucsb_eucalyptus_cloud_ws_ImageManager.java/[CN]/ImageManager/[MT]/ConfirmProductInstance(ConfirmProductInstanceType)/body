{
  ConfirmProductInstanceResponseType reply=(ConfirmProductInstanceResponseType)request.getReply();
  reply.set_return(false);
  VmInstance vm=null;
  try {
    vm=VmInstances.getInstance().lookup(request.getInstanceId());
  }
 catch (  NoSuchElementException e) {
    return reply;
  }
  EntityWrapper<ImageInfo> db=new EntityWrapper<ImageInfo>();
  try {
    ImageInfo found=db.getUnique(new ImageInfo(vm.getImageInfo().getImageId()));
    if (vm.getImageInfo().getImageId().equals(found)) {
      reply.set_return(true);
    }
  }
 catch (  EucalyptusCloudException e) {
  }
 finally {
    db.commit();
  }
  return reply;
}
