{
  final ReportType reportType=ReportType.valueOf(Param.type.get(req));
  final ReportFormat format=ReportFormat.valueOf(Param.format.get(req));
  final long start=Long.parseLong(Param.start.get(req));
  final long end=Long.parseLong(Param.end.get(req));
  final Period period=new Period(start,end);
  final int criterionId=Integer.parseInt(Param.criterionId.get(req));
  final int groupById=Integer.parseInt(Param.groupById.get(req));
  final ReportingCriterion criterion=ReportingCriterion.values()[criterionId + 1];
  final Units displayUnits=Units.DEFAULT_DISPLAY_UNITS;
  final ReportingCriterion groupByCriterion=(groupById > 0) ? ReportingCriterion.values()[groupById - 1] : null;
  ReportGenerator.generateReport(reportType,format,period,criterion,groupByCriterion,displayUnits,res.getOutputStream());
}
