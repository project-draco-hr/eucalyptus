{
  WebSession ws=WebSessionManager.getInstance().getSession(sessionId);
  if (ws == null) {
    throw new RuntimeException("Session verification failed:" + sessionId);
  }
  User user;
  try {
    user=EuareWebBackend.getUser(ws.getUserName(),ws.getAccountName());
  }
 catch (  EucalyptusServiceException ex) {
    throw new RuntimeException("Session verification failed",ex);
  }
  if (user == null || !user.isSystemAdmin()) {
    throw new RuntimeException("Only admins can generate reports");
  }
}
