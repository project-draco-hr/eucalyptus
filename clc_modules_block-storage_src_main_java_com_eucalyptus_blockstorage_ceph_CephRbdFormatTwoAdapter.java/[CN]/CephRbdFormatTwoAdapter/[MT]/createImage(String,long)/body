{
  return executeRbdOpInRandomPool(new Function<CephRbdConnectionManager,String>(){
    @Override public String apply(    @Nonnull CephRbdConnectionManager arg0){
      RbdImage image=null;
      try {
        LOG.debug("Creating image=" + imageName + ", pool="+ arg0.getPool()+ ", size="+ imageSize);
        int features=(1 << 0);
        arg0.getRbd().create(imageName,imageSize,features,0);
        LOG.trace("Opening image=" + imageName + ", pool="+ arg0.getPool()+ ", mode=read-only");
        image=arg0.getRbd().openReadOnly(imageName);
        return arg0.getPool() + CephRbdInfo.POOL_IMAGE_DELIMITER + imageName;
      }
 catch (      RbdException e) {
        LOG.warn("Caught error while creating image " + imageName + ": "+ e.getMessage());
        throw new EucalyptusCephException("Failed to create image " + imageName,e);
      }
 finally {
        if (image != null) {
          try {
            LOG.trace("Closing image=" + imageName + ", pool="+ arg0.getPool());
            arg0.getRbd().close(image);
          }
 catch (          Exception e) {
            LOG.debug("Caught exception closing image " + imageName + ", pool="+ arg0.getPool(),e);
          }
        }
      }
    }
  }
,imageName);
}
