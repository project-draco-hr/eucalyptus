{
  final String imageId=request.getImageId();
  final List<LaunchPermissionItemType> addList=request.getAdd();
  final List<LaunchPermissionItemType> remList=request.getRemove();
  EntityWrapper<ImageInfo> db=EntityWrapper.get(ImageInfo.class);
  ImageInfo imgInfo=null;
  try {
    imgInfo=db.getUnique(Images.exampleWithImageId(imageId));
  }
 catch (  EucalyptusCloudException e) {
    db.rollback();
    return false;
  }
  if (RestrictedTypes.checkPrivilege(request,PolicySpec.VENDOR_EC2,PolicySpec.EC2_RESOURCE_IMAGE,imageId,imgInfo.getOwner())) {
    return false;
  }
  try {
    applyImageAttributes(db,imgInfo,addList,true);
    applyImageAttributes(db,imgInfo,remList,false);
    db.commit();
    return true;
  }
 catch (  EucalyptusCloudException e) {
    LOG.warn(e);
    db.rollback();
    return false;
  }
}
