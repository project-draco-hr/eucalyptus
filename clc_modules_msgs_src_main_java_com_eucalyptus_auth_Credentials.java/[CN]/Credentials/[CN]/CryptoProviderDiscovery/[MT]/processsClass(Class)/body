{
  if (BaseProvider.class.isAssignableFrom(candidate) && !Modifier.isInterface(candidate.getModifiers()) && !Modifier.isAbstract(candidate.getModifiers())) {
    try {
      BaseProvider o=(BaseProvider)candidate.newInstance();
      for (      Class c : Credentials.providers.keySet()) {
        if (c.isAssignableFrom(candidate)) {
          Object curr=Credentials.providers.get(c);
          if (curr == null) {
            LOG.info(EventRecord.here(this.getClass(),EventType.PROVIDER_CONFIGURED,CertificateProvider.class.toString(),candidate.getCanonicalName()));
            Credentials.providers.put(c,o);
          }
 else           if (!candidate.getSimpleName().startsWith("Default")) {
            LOG.info(EventRecord.here(this.getClass(),EventType.PROVIDER_CONFLICT,CertificateProvider.class.getCanonicalName(),curr.getClass().getCanonicalName(),candidate.getCanonicalName()));
            Credentials.providers.put(c,o);
          }
 else {
            LOG.info(EventRecord.here(this.getClass(),EventType.PROVIDER_IGNORED,CertificateProvider.class.toString()));
            return false;
          }
        }
      }
      return true;
    }
 catch (    Exception e) {
      LOG.error(e,e);
      LOG.fatal("Provider class " + candidate + " failed during <init>().  This must be fixed for the system to run.");
      System.exit(-1);
    }
  }
  return false;
}
