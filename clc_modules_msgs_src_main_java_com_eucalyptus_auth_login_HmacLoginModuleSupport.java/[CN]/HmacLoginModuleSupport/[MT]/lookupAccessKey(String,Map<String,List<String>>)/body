{
  final String token=Iterables.getFirst(Objects.firstNonNull(parameters.get(SecurityParameter.SecurityToken.parameter()),Collections.<String>emptyList()),null);
  final AccessKey key=AccessKeys.lookupAccessKey(accessKeyId,token);
  if (!key.isActive())   throw new AuthException("Invalid access key or token");
  return key;
}
