{
  TransitionAction<P> action=new AbstractTransitionAction<P>(){
    @Override public void leave(    P parent,    Callback.Completion transitionCallback){
      try {
        if (!predicate.apply(parent)) {
          transitionCallback.fireException(Transitions.conditionFailed("Transition failed " + TransitionBuilder.this.fromState + " -> "+ TransitionBuilder.this.toState+ " for "+ parent.getName(),predicate));
        }
        transitionCallback.fire();
      }
 catch (      Throwable ex) {
        LOG.error(ex);
        transitionCallback.fireException(ex);
      }
    }
  }
;
}
