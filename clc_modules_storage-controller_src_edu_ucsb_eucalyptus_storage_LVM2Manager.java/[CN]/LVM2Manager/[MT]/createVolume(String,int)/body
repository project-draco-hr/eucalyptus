{
  File volumeDir=new File(StorageProperties.volumeRootDirectory);
  volumeDir.mkdirs();
  String vgName="vg-" + Hashes.getRandom(4);
  String lvName="lv-" + Hashes.getRandom(4);
  LVMVolumeInfo lvmVolumeInfo=new LVMVolumeInfo();
  String rawFileName=StorageProperties.volumeRootDirectory + "/" + volumeId;
  String loDevName=createLoopback(rawFileName,size);
  createLogicalVolume(loDevName,vgName,lvName);
  int vbladePid=exportVolume(lvmVolumeInfo,vgName,lvName);
  if (vbladePid < 0) {
    throw new EucalyptusCloudException();
  }
  lvmVolumeInfo.setVolumeId(volumeId);
  lvmVolumeInfo.setLoDevName(loDevName);
  lvmVolumeInfo.setLoFileName(rawFileName);
  lvmVolumeInfo.setPvName(loDevName);
  lvmVolumeInfo.setVgName(vgName);
  lvmVolumeInfo.setLvName(lvName);
  lvmVolumeInfo.setStatus(StorageProperties.Status.available.toString());
  lvmVolumeInfo.setSize(size);
  EntityWrapper<LVMVolumeInfo> db=new EntityWrapper<LVMVolumeInfo>();
  db.add(lvmVolumeInfo);
  db.commit();
}
