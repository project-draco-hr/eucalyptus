{
  EntityWrapper<LVMVolumeInfo> db=new EntityWrapper<LVMVolumeInfo>();
  LVMVolumeInfo lvmVolumeInfo=new LVMVolumeInfo(volumeId);
  LVMVolumeInfo foundLVMVolumeInfo=db.getUnique(lvmVolumeInfo);
  ArrayList<String> returnValues=new ArrayList<String>();
  if (foundLVMVolumeInfo != null) {
    returnValues.add(StorageProperties.storageRootDirectory + PATH_SEPARATOR + foundLVMVolumeInfo.getVolumeId());
    String dmDeviceName=foundLVMVolumeInfo.getVgName().replaceAll("-","--") + "-" + foundLVMVolumeInfo.getLvName().replaceAll("-","--");
    lvmVolumeInfo=new LVMVolumeInfo(snapshotId);
    foundLVMVolumeInfo=db.getUnique(lvmVolumeInfo);
    if (foundLVMVolumeInfo != null) {
      String snapshotRawFileName=StorageProperties.storageRootDirectory + PATH_SEPARATOR + foundLVMVolumeInfo.getVolumeId();
      String dupSnapshotDeltaFileName=snapshotRawFileName + "." + Hashes.getRandom(4);
      String returnValue=suspendDevice(dmDeviceName);
      if (!returnValue.contains(foundLVMVolumeInfo.getVgName().replaceAll("-","--"))) {
        db.rollback();
        resumeDevice(dmDeviceName);
        throw new EucalyptusCloudException("Could not suspend device " + dmDeviceName);
      }
      dupFile(snapshotRawFileName,dupSnapshotDeltaFileName);
      returnValue=resumeDevice(dmDeviceName);
      returnValues.add(dupSnapshotDeltaFileName);
    }
  }
 else {
    db.rollback();
    throw new EucalyptusCloudException();
  }
  return returnValues;
}
