{
  int majorNumber=-1;
  int minorNumber=-1;
  LVMMetaInfo metaInfo=new LVMMetaInfo(hostName);
  EntityWrapper<LVMMetaInfo> db=new EntityWrapper<LVMMetaInfo>();
  List<LVMMetaInfo> metaInfoList=db.query(metaInfo);
  if (metaInfoList.size() > 0) {
    LVMMetaInfo foundMetaInfo=metaInfoList.get(0);
    majorNumber=foundMetaInfo.getMajorNumber();
    minorNumber=foundMetaInfo.getMinorNumber();
    if (((++minorNumber) % MAX_LOOP_DEVICES) == 0) {
      ++majorNumber;
    }
    foundMetaInfo.setMajorNumber(majorNumber);
    foundMetaInfo.setMinorNumber(minorNumber);
  }
  db.commit();
  String absoluteLVName=lvmRootDirectory + PATH_SEPARATOR + vgName+ PATH_SEPARATOR+ lvName;
  int pid=exportManager.exportVolume(iface,absoluteLVName,majorNumber,minorNumber);
  boolean success=false;
  String returnValue="";
  int timeout=300;
  if (pid > 0) {
    for (int i=0; i < 5; ++i) {
      returnValue=aoeStatus(pid);
      if (returnValue.length() == 0) {
        success=false;
        try {
          Thread.sleep(timeout);
        }
 catch (        InterruptedException ie) {
          LOG.error(ie);
        }
        timeout+=300;
      }
 else {
        success=true;
        break;
      }
    }
  }
  if (!success) {
    throw new EucalyptusCloudException("Could not export AoE device " + absoluteLVName + " iface: "+ iface+ " pid: "+ pid+ " returnValue: "+ returnValue);
  }
  File vbladePidFile=new File(eucaHome + EUCA_VAR_RUN_PATH + "/vblade-"+ majorNumber+ minorNumber+ ".pid");
  try {
    FileOutputStream fileOutStream=new FileOutputStream(vbladePidFile);
    String pidString=String.valueOf(pid);
    fileOutStream.write(pidString.getBytes());
    fileOutStream.close();
  }
 catch (  Exception ex) {
    LOG.error("Could not write pid file vblade-" + majorNumber + minorNumber+ ".pid");
  }
  lvmVolumeInfo.setVbladePid(pid);
  lvmVolumeInfo.setMajorNumber(majorNumber);
  lvmVolumeInfo.setMinorNumber(minorNumber);
  return pid;
}
