{
  if (Bootstrap.isFinished()) {
    if (name.toString().endsWith("in-addr.arpa.")) {
      return TransientZone.getPtrZone(name);
    }
    try {
      Name internalName=TransientZone.getInternalName();
      Name externalName=TransientZone.getExternalName();
      if (!ZoneManager.zones.containsKey(externalName)) {
        ZoneManager.registerZone(externalName,TransientZone.getInstanceExternalZone());
        LOG.info("Registering zone: " + externalName.toString());
      }
 else       if (!ZoneManager.zones.containsKey(internalName)) {
        ZoneManager.registerZone(internalName,TransientZone.getInstanceInternalZone());
        LOG.info("Registering zone: " + internalName.toString());
      }
      if (name == internalName && !internal) {
        LOG.error("Invalid external query for " + internalName.toString());
        return null;
      }
    }
 catch (    Exception e) {
      LOG.debug(e,e);
    }
    return zones.get(name);
  }
 else {
    return null;
  }
}
