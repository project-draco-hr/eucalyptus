{
  if (started) {
    if (senders.containsKey(identifier)) {
      return senders.get(identifier);
    }
 else {
      QueueSenderImpl sender=new QueueSenderImpl(broker,identifier);
      sender.startup();
      senders.put(identifier,sender);
      log.info("Sender " + identifier + " started");
      return sender;
    }
  }
 else {
    throw new QueueRuntimeException("QueueFactory not started");
  }
}
