{
  QueueIdentifier identifier=(args[0].equalsIgnoreCase("storage")) ? QueueIdentifier.STORAGE : QueueIdentifier.INSTANCE;
  boolean listener=(args[1].equalsIgnoreCase("nowait")) ? false : true;
  System.out.println("Running listener for queue " + identifier + " as "+ (listener ? "listener" : "noWait"));
  QueueFactory queueFactory=QueueFactory.getInstance();
  QueueReceiver receiver=queueFactory.getReceiver(identifier);
  if (listener) {
    receiver.addEventListener(new EventListener(){
      @Override public void receiveEvent(      Event e){
        System.out.println("Event received:" + e);
      }
    }
);
  }
 else {
    for (Event event=receiver.receiveEventNoWait(); event != null; event=receiver.receiveEventNoWait()) {
      System.out.println("Event received:" + event);
    }
  }
}
