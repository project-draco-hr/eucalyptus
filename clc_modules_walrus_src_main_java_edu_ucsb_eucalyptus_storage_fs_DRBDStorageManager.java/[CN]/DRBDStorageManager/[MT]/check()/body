{
  try {
    if (!isConnected()) {
      connectResource();
      if (!isConnected()) {
        throw new EucalyptusCloudException("Resource is not connected to peer.");
      }
    }
    if (!isUpToDate()) {
      throw new EucalyptusCloudException("Resource is not up to date");
    }
    if (Component.State.ENABLED.equals(Components.lookup("walrus").getState())) {
      if (!isPrimary()) {
        throw new EucalyptusCloudException("I am the master, but not DRBD primary. Aborting!");
      }
    }
 else {
      if (Component.State.DISABLED.equals(Components.lookup("walrus").getState())) {
        if (!isSecondary()) {
          throw new EucalyptusCloudException("I am the slave, but not DRBD secondary. Aborting!");
        }
      }
    }
  }
 catch (  ExecutionException ex) {
    throw new EucalyptusCloudException(ex);
  }
}
