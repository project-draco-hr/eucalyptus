{
  try {
    Object requestMsg=muleMsg.getPayload();
    String requestString=requestMsg.toString();
    BaseMessage msg=(BaseMessage)BindingManager.getDefaultBinding().fromOM(requestString);
    Throwable ex=muleMsg.getException().getCause();
    StorageErrorMessageType errMsg=null;
    if (ex instanceof NoSuchVolumeException) {
      errMsg=new StorageErrorMessageType("NoSuchVolume","Volume not found",HttpStatus.SC_NOT_FOUND,msg.getCorrelationId());
      errMsg.setCorrelationId(msg.getCorrelationId());
    }
 else     if (ex instanceof VolumeInUseException) {
      errMsg=new StorageErrorMessageType("VolumeInUse","Volume in use",HttpStatus.SC_FORBIDDEN,msg.getCorrelationId());
      errMsg.setCorrelationId(msg.getCorrelationId());
    }
 else     if (ex instanceof NoSuchSnapshotException) {
      errMsg=new StorageErrorMessageType("NoSuchSnapshot","Snapshot not found",HttpStatus.SC_NOT_FOUND,msg.getCorrelationId());
      errMsg.setCorrelationId(msg.getCorrelationId());
    }
 else     if (ex instanceof VolumeAlreadyExistsException) {
      errMsg=new StorageErrorMessageType("VolumeAlreadyExists","Volume already exists",HttpStatus.SC_CONFLICT,msg.getCorrelationId());
      errMsg.setCorrelationId(msg.getCorrelationId());
    }
 else     if (ex instanceof VolumeNotReadyException) {
      errMsg=new StorageErrorMessageType("VolumeNotReady","Volume not ready yet",HttpStatus.SC_CONFLICT,msg.getCorrelationId());
      errMsg.setCorrelationId(msg.getCorrelationId());
    }
 else     if (ex instanceof SnapshotInUseException) {
      errMsg=new StorageErrorMessageType("SnapshotInUse","Snapshot in use",HttpStatus.SC_CONFLICT,msg.getCorrelationId());
      errMsg.setCorrelationId(msg.getCorrelationId());
    }
 else {
      replies.putMessage(new EucalyptusErrorMessageType(muleMsg.getComponentName(),msg,ex.getMessage()));
    }
    if (errMsg != null) {
      replies.putMessage(errMsg);
    }
  }
 catch (  Exception e) {
    LOG.error(e);
  }
}
