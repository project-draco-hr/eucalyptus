{
  signature=signature.replaceAll("=","");
  try {
    String queryKey=CredentialProvider.getSecretKey(accessKeyID);
    String authSig=checkSignature(queryKey,data);
    if (!authSig.equals(signature))     throw new AuthenticationException("User authentication failed. Could not verify signature");
    String userName=CredentialProvider.getUserName(accessKeyID);
    User user=CredentialProvider.getUser(userName);
    Contexts.lookup(httpRequest.getCorrelationId()).setUser(user);
  }
 catch (  Exception ex) {
    throw new AuthenticationException("User authentication failed. Unable to obtain query key");
  }
}
