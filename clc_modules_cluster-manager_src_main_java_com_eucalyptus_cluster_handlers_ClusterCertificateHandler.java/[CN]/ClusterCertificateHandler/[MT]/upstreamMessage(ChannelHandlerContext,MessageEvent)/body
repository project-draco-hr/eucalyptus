{
  if (e.getMessage() instanceof MappingHttpResponse) {
    MappingHttpResponse resp=(MappingHttpResponse)e.getMessage();
    GetKeysResponseType msg=(GetKeysResponseType)resp.getMessage();
    boolean certs=ClusterUtil.checkCerts(msg,this.getCluster());
    if (certs && !this.verified) {
      this.getCluster().start();
      try {
        ClusterUtil.registerClusterStateHandler(this.getCluster(),new NetworkStateHandler(this.getCluster()));
        ClusterUtil.registerClusterStateHandler(this.getCluster(),new AddressStateHandler(this.getCluster()));
        ClusterUtil.registerClusterStateHandler(this.getCluster(),new LogStateHandler(this.getCluster()));
        ClusterUtil.registerClusterStateHandler(this.getCluster(),new ResourceStateHandler(this.getCluster()));
        ClusterUtil.registerClusterStateHandler(this.getCluster(),new VmStateHandler(this.getCluster()));
      }
 catch (      Exception e1) {
        LOG.error(e1,e1);
      }
      LOG.info(LogUtil.header("Starting threads for cluster: " + this.getCluster()));
      this.verified=true;
    }
  }
 else {
    LOG.info("Received unknown message type. " + e.getMessage());
  }
  ctx.getChannel().close();
}
