{
  this.finished=new AtomicBoolean(false);
  this.msgQueue=new LinkedBlockingQueue<QueuedEvent>();
  this.clusterName=clusterName;
  this.threadFactory=ClusterThreadFactory.getThreadFactory(clusterName);
  this.workers=Executors.newFixedThreadPool(NUM_WORKERS,this.threadFactory);
  Runtime.getRuntime().addShutdownHook(new Thread(){
{
      ClusterMessageQueue.this.workers.shutdownNow();
    }
  }
);
}
