{
  while (!this.finished.get()) {
    try {
      final long start=System.currentTimeMillis();
      final QueuedEvent event=this.msgQueue.poll(this.pollInterval,TimeUnit.MILLISECONDS);
      if (event != null) {
        LOG.debug("-> Dequeued message of type " + event.getCallback().getClass().getSimpleName());
        final long msgStart=System.currentTimeMillis();
        try {
          Clusters.sendClusterEvent(this.clusterName,event);
          event.getCallback().waitForResponse();
        }
 catch (        final Throwable e) {
          LOG.debug(e,e);
        }
        LOG.info(LogUtil.subheader(String.format("--> [q=%04dms,send=%04dms,qlen=%02d] message type %s, cluster %s",msgStart - start,System.currentTimeMillis() - msgStart,this.msgQueue.size(),event.getCallback().getClass().getSimpleName(),this.clusterName)));
      }
    }
 catch (    final Throwable e) {
      LOG.error(e,e);
    }
  }
}
