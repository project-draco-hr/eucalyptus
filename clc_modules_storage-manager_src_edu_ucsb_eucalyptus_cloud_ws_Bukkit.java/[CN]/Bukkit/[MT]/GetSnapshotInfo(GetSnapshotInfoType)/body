{
  GetSnapshotInfoResponseType reply=(GetSnapshotInfoResponseType)request.getReply();
  String snapshotId=request.getKey();
  EntityWrapper<WalrusSnapshotInfo> db=new EntityWrapper<WalrusSnapshotInfo>();
  WalrusSnapshotInfo snapshotInfo=new WalrusSnapshotInfo(snapshotId);
  List<WalrusSnapshotInfo> foundSnapshotInfos=db.query(snapshotInfo);
  db.commit();
  if (foundSnapshotInfos.size() > 0) {
    WalrusSnapshotInfo foundSnapshotInfo=foundSnapshotInfos.get(0);
    String volumeId=foundSnapshotInfo.getVolumeId();
    WalrusVolumeInfo volumeInfo=new WalrusVolumeInfo(volumeId);
    EntityWrapper<WalrusVolumeInfo> db2=new EntityWrapper<WalrusVolumeInfo>();
    List<WalrusVolumeInfo> foundVolumeInfos=db2.query(volumeInfo);
    if (foundVolumeInfos.size() > 0) {
      WalrusVolumeInfo foundVolumeInfo=foundVolumeInfos.get(0);
      List<String> snapshotNames=reply.getSnapshotSet();
      snapshotNames.add(volumeId);
      for (      WalrusSnapshotInfo snapInfo : foundVolumeInfo.getSnapshotSet()) {
        snapshotNames.add(snapInfo.getSnapshotId());
      }
      db2.commit();
    }
 else {
      db2.rollback();
      throw new EucalyptusCloudException();
    }
  }
 else {
    throw new EucalyptusCloudException();
  }
  return reply;
}
