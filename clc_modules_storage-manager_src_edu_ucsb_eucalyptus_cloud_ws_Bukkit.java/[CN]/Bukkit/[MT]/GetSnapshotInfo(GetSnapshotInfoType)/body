{
  GetSnapshotInfoResponseType reply=(GetSnapshotInfoResponseType)request.getReply();
  String snapshotId=request.getKey();
  ArrayList<String> snapshotSet=reply.getSnapshotSet();
  EntityWrapper<WalrusSnapshotInfo> db=new EntityWrapper<WalrusSnapshotInfo>();
  WalrusSnapshotInfo snapshotInfo=new WalrusSnapshotInfo(snapshotId);
  List<WalrusSnapshotInfo> snapshotInfos=db.query(snapshotInfo);
  if (snapshotInfos.size() > 0) {
    WalrusSnapshotInfo foundSnapshotInfo=snapshotInfos.get(0);
    EntityWrapper<WalrusSnapshotSet> dbSet=db.recast(WalrusSnapshotSet.class);
    try {
      String snapshotSetId=foundSnapshotInfo.getSnapshotSetId();
      WalrusSnapshotSet snapshotSetInfo=dbSet.getUnique(new WalrusSnapshotSet(snapshotSetId));
      List<WalrusSnapshotInfo> walrusSnapshotInfos=snapshotSetInfo.getSnapshotSet();
      for (      WalrusSnapshotInfo walrusSnapshotInfo : walrusSnapshotInfos) {
        snapshotSet.add(walrusSnapshotInfo.getSnapshotId());
      }
    }
 catch (    Exception ex) {
      dbSet.rollback();
      db.rollback();
      throw new NoSuchEntityException(snapshotId);
    }
    dbSet.commit();
  }
 else {
    db.rollback();
    throw new NoSuchEntityException(snapshotId);
  }
  db.commit();
  return reply;
}
