{
  for (  final ScalingActivity activity : scalingActivities.listByActivityStatusCode(null,completedActivityStates)) {
    if (!completedActivityStates.contains(activity.getStatusCode()) && isTimedOut(activity.getLastUpdateTimestamp())) {
      scalingActivities.update(activity.getOwner(),activity.getActivityId(),new Callback<ScalingActivity>(){
        @Override public void fire(        final ScalingActivity scalingActivity){
          scalingActivity.setStatusCode(ActivityStatusCode.Cancelled);
          scalingActivity.setEndTime(new Date());
        }
      }
);
    }
  }
}
