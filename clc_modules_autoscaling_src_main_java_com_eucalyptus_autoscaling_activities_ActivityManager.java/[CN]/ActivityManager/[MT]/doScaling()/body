{
  timeoutScalingActivities();
  try {
    final List<AutoScalingInstance> failedToTerminate=autoScalingInstances.listByState(LifecycleState.Terminating);
    final Iterable<String> groupArns=Iterables.transform(failedToTerminate,AutoScalingInstances.groupArn());
    for (    final String groupArn : groupArns) {
      final Iterable<AutoScalingInstance> groupInstances=Iterables.filter(failedToTerminate,CollectionUtils.propertyPredicate(groupArn,AutoScalingInstances.groupArn()));
      runTask(terminateInstancesTask(groupInstances));
    }
  }
 catch (  Exception e) {
    logger.error(e,e);
  }
  try {
    for (    final AutoScalingGroup group : autoScalingGroups.listRequiringScaling()) {
      int compareResult=group.getCapacity().compareTo(group.getDesiredCapacity());
      if (compareResult < 0) {
        runTask(new LaunchInstancesScalingProcessTask(group));
      }
 else       if (compareResult > 0) {
        runTask(perhapsTerminateInstances(group,group.getCapacity() - group.getDesiredCapacity()));
      }
    }
  }
 catch (  Exception e) {
    logger.error(e,e);
  }
  try {
    for (    final AutoScalingGroup group : autoScalingGroups.listRequiringInstanceReplacement()) {
      runTask(perhapsReplaceInstances(group));
    }
  }
 catch (  Exception e) {
    logger.error(e,e);
  }
  try {
    for (    final AutoScalingGroup group : autoScalingGroups.listRequiringMonitoring(10000L)) {
      final List<AutoScalingInstance> groupInstances=autoScalingInstances.listByGroup(group);
      runTask(new MonitoringScalingProcessTask(group,Lists.newArrayList(Iterables.transform(Iterables.filter(groupInstances,LifecycleState.Pending),instanceId())),Lists.newArrayList(Iterables.transform(Iterables.filter(groupInstances,LifecycleState.InService),instanceId()))));
    }
  }
 catch (  Exception e) {
    logger.error(e,e);
  }
}
