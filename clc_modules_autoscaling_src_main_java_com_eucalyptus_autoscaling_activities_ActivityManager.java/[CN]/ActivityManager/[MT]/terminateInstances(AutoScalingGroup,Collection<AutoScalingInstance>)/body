{
  final String arn=group.getArn();
  final Set<String> arnSet=Sets.newHashSet(Iterables.transform(instances,AutoScalingInstances.groupArn()));
  if (arnSet.size() != 1 || !arnSet.iterator().next().equals(arn)) {
    throw new IllegalArgumentException("Instances for termination must belong to the given group.");
  }
  final List<String> instancesToTerminate=Lists.newArrayList();
  Iterables.addAll(instancesToTerminate,Iterables.transform(instances,AutoScalingInstances.instanceId()));
  final UserTerminateInstancesScalingProcessTask task=new UserTerminateInstancesScalingProcessTask(group,instancesToTerminate);
  runTask(task);
  return task.getActivities();
}
