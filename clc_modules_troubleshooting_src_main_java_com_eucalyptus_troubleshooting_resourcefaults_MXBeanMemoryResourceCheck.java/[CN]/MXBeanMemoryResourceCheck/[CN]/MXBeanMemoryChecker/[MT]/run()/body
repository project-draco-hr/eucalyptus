{
  List<MemoryPoolMXBean> beans=ManagementFactory.getMemoryPoolMXBeans();
  if (null != beans) {
    for (    MemoryPoolMXBean bean : beans) {
      String name=bean.getName();
      String identifier=bean.getName() + ":" + bean.getType().toString();
      LOG.debug("Polling memory pool " + identifier + " threshold = "+ mxBeanInfo.getThreshold(bean));
      try {
        long free=bean.getUsage().getMax() - bean.getUsage().getUsed();
        if (free < mxBeanInfo.getThreshold(bean)) {
          if (!this.alreadyFaulted.contains(identifier)) {
            FaultSubsystem.forComponent(Eucalyptus.class).havingId(MXBEAN_OUT_OF_MEMORY_FAULT_ID).withVar("component",Eucalyptus.INSTANCE.getFaultLogPrefix()).withVar("name",name).log();
            this.alreadyFaulted.add(identifier);
          }
 else {
          }
        }
 else {
          this.alreadyFaulted.remove(identifier);
        }
      }
 catch (      Exception ex) {
        LOG.error("Disk resource check failed for " + identifier,ex);
      }
    }
  }
 else {
  }
}
