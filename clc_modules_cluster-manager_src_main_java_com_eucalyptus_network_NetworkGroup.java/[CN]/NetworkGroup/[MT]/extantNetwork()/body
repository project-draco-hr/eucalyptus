{
  if (!NetworkGroups.networkingConfiguration().hasNetworking()) {
    return ExtantNetwork.bogus(this);
  }
 else   if (this.getExtantNetwork() == null) {
    final EntityTransaction db=Entities.get(NetworkGroup.class);
    ExtantNetwork exNet=null;
    for (    Integer i : Numbers.shuffled(NetworkGroups.networkTagInterval())) {
      try {
        exNet=Entities.uniqueResult(ExtantNetwork.named(i));
      }
 catch (      Exception ex) {
        try {
          this.setExtantNetwork(ExtantNetwork.create(this,i));
          Entities.merge(this);
          db.commit();
          return exNet;
        }
 catch (        Exception ex1) {
          Logs.exhaust().trace(ex1,ex1);
          db.rollback();
          throw new NotEnoughResourcesAvailable("Failed to allocate network tag for network: " + this.getFullName(),ex1);
        }
      }
    }
    db.rollback();
    throw new NotEnoughResourcesAvailable("Failed to allocate network tag for network: " + this.getFullName() + ": no network tags are free.");
  }
 else {
    return this.getExtantNetwork();
  }
}
