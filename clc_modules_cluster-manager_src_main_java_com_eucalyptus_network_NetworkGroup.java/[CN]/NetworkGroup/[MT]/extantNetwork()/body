{
  if (!NetworkGroups.networkingConfiguration().hasNetworking()) {
    return ExtantNetwork.bogus(this);
  }
 else   if (this.getExtantNetwork() == null) {
    ExtantNetwork exNet=null;
    final EntityTransaction db=Entities.get(NetworkGroup.class);
    try {
      exNet=Entities.uniqueResult(ExtantNetwork.named(this));
      db.rollback();
      return exNet;
    }
 catch (    TransactionException ex2) {
      for (      Integer i : NetworkGroups.shuffled(NetworkGroups.networkTagInterval())) {
        try {
          exNet=Entities.uniqueResult(ExtantNetwork.named(i));
        }
 catch (        TransactionException ex) {
        }
        if (exNet == null) {
          try {
            exNet=Entities.persist(ExtantNetwork.create(this,i));
          }
 catch (          Exception ex) {
            LOG.error(ex,ex);
          }
        }
      }
    }
    if (exNet != null) {
      db.commit();
      return exNet;
    }
 else {
      db.rollback();
      throw new NotEnoughResourcesAvailable("Failed to add extant network: " + this.extantNetwork + " due to: no network tags are free.");
    }
  }
 else {
    return this.getExtantNetwork();
  }
}
