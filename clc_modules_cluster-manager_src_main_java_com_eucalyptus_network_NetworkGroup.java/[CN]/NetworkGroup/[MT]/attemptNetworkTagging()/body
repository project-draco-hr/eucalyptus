{
  for (  Integer i : Numbers.shuffled(NetworkGroups.networkTagInterval())) {
    try {
      Entities.uniqueResult(ExtantNetwork.named(i));
      continue;
    }
 catch (    Exception ex) {
      try {
        ExtantNetwork exNet=ExtantNetwork.create(this,i);
        exNet.setNetworkGroup(this);
        this.setExtantNetwork(exNet);
        Entities.persist(exNet);
        return Entities.merge(this).extantNetwork;
      }
 catch (      Exception ex1) {
        Logs.exhaust().trace(ex1,ex1);
        throw new NotEnoughResourcesException("Failed to allocate network tag for network: " + this.getFullName(),ex1);
      }
    }
  }
  throw new NotEnoughResourcesException("Failed to allocate network tag for network: " + this.getFullName() + ": no network tags are free.");
}
