{
  this.canHas.writeLock().lock();
  try {
    String user=this.userId;
    if (!this.isPending()) {
      this.release();
      if (!Component.eucalyptus.name().equals(user) || !edu.ucsb.eucalyptus.util.EucalyptusProperties.getSystemConfiguration().isDoDynamicPublicAddresses()) {
        this.allocate(userId);
      }
    }
  }
  finally {
    this.canHas.writeLock().unlock();
  }
}
