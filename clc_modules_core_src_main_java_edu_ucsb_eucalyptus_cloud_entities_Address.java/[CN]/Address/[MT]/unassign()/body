{
  if (!this.pending.compareAndSet(false,true)) {
    throw new IllegalStateException("Trying to unassign an address which is already pending: " + this);
  }
 else {
    try {
      if (!this.state.compareAndSet(State.assigned,State.allocated)) {
        this.pending.set(false);
        throw new IllegalStateException("Trying to unassign an address which is not currently assigned: " + this);
      }
    }
  finally {
      this.state.set(State.allocated);
      LOG.debug(EventRecord.caller(this.getClass(),State.unassigning,this.toString()));
    }
  }
}
