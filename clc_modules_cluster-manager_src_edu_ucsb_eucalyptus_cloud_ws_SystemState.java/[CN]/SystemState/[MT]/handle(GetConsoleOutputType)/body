{
  GetConsoleOutputResponseType reply=(GetConsoleOutputResponseType)request.getReply();
  reply.set_return(true);
  try {
    Cluster cluster=null;
    VmInstance v=VmInstances.getInstance().lookup(request.getInstanceId());
    if (request.isAdministrator() || v.getOwnerId().equals(request.getUserId())) {
      cluster=Clusters.getInstance().lookup(v.getPlacement());
    }
    QueuedEvent<GetConsoleOutputType> event=new QueuedEvent<GetConsoleOutputType>(new ConsoleOutputCallback(cluster),request);
    cluster.getMessageQueue().enqueue(event);
    return;
  }
 catch (  NoSuchElementException e) {
    Messaging.dispatch("vm://ReplyQueue",new EucalyptusErrorMessageType(RequestContext.getEventContext().getService().getComponent().getClass().getSimpleName(),request,e.getMessage()));
    throw new EucalyptusCloudException(e.getMessage());
  }
}
