{
  final Context ctx=Contexts.lookup();
  final String accessKey=Accounts.getFirstActiveAccessKeyId(ctx.getUser());
  CreateBucketType createBucket=new CreateBucketType(){
{
      setAccessKeyID(accessKey);
      setBucket(bucketName);
    }
  }
.regardingUserRequest(ctx.getRequest());
  DeleteBucketType deleteBucket=new DeleteBucketType(){
{
      setAccessKeyID(accessKey);
      setBucket(bucketName);
    }
  }
.regardingUserRequest(ctx.getRequest());
  ServiceConfiguration walrusConfig=Topology.lookup(Walrus.class);
  try {
    AsyncRequests.sendSync(walrusConfig,createBucket);
    AsyncRequests.sendSync(walrusConfig,deleteBucket);
  }
 catch (  Exception ex) {
    throw new RuntimeException("Can't create the requested bucket",ex);
  }
}
