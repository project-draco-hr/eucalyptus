{
  final Context ctx=Contexts.lookup();
  final String accessKey=Accounts.getFirstActiveAccessKeyId(ctx.getUser());
  CreateBucketType createBucket=new CreateBucketType(){
{
      setAccessKeyID(accessKey);
      setBucket(bucketName);
    }
  }
.regardingUserRequest(ctx.getRequest());
  DeleteBucketType deleteBucket=new DeleteBucketType(){
{
      setAccessKeyID(accessKey);
      setBucket(bucketName);
    }
  }
.regardingUserRequest(ctx.getRequest());
  ServiceConfiguration walrusConfig=ServiceConfigurations.enabledServices(Walrus.class).iterator().next();
  if (walrusConfig != null) {
    try {
      AsyncRequests.sendSync(walrusConfig,createBucket);
      AsyncRequests.sendSync(walrusConfig,deleteBucket);
    }
 catch (    Exception ex) {
      Logs.extreme().error(ex);
    }
  }
 else {
    throw new RuntimeException("Failed to lookup active service configuration for walrus.");
  }
}
