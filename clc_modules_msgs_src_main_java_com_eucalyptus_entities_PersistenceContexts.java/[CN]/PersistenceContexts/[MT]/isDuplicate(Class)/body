{
  String ctxName=Ats.from(entity).get(PersistenceContext.class).name();
  if (sharedEntities.contains(entity)) {
    Class old=sharedEntities.get(sharedEntities.indexOf(entity));
    LOG.error("Duplicate entity definition detected: " + entity.getCanonicalName());
    LOG.error("=> OLD: " + old.getProtectionDomain().getCodeSource().getLocation());
    LOG.error("=> NEW: " + entity.getProtectionDomain().getCodeSource().getLocation());
    throw BootstrapException.throwFatal("Duplicate entity definition in shared entities: " + entity.getCanonicalName() + ". See error logs for details.");
  }
 else   if (entities.get(ctxName).contains(entity)) {
    List<Class> context=entities.get(ctxName);
    Class old=context.get(context.indexOf(entity));
    LOG.error("Duplicate entity definition detected: " + entity.getCanonicalName());
    LOG.error("=> OLD: " + old.getProtectionDomain().getCodeSource().getLocation());
    LOG.error("=> NEW: " + entity.getProtectionDomain().getCodeSource().getLocation());
    throw BootstrapException.throwFatal("Duplicate entity definition in '" + ctxName + "': "+ entity.getCanonicalName()+ ". See error logs for details.");
  }
 else {
    return false;
  }
}
