{
  if (Strings.isNullOrEmpty(authorization)) {
    return null;
  }
  HashMap<AuthorizationField,String> authMap=new HashMap<AuthorizationField,String>();
  String[] components=authorization.split(" ");
  if (components.length < 2) {
    throw new AccessDeniedException("Invalid authorization header");
  }
  if (AWS_AUTH_TYPE.equals(components[0]) && components.length == 2) {
    authMap.put(AuthorizationField.Type,AWS_AUTH_TYPE);
    String[] signatureElements=components[1].split(":");
    authMap.put(AuthorizationField.AccessKeyId,signatureElements[0]);
    authMap.put(AuthorizationField.Signature,signatureElements[1]);
  }
 else {
    throw new AccessDeniedException("Invalid authorization header");
  }
  return authMap;
}
