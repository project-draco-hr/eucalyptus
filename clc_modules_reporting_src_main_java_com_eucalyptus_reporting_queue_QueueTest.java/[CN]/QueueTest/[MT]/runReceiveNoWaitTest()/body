{
  int totalNum=0;
  QueueFactory queueFactory=QueueFactory.getInstance();
  queueFactory.startup();
  QueueReceiver receiver=queueFactory.getReceiver(QueueFactory.QueueIdentifier.INSTANCE);
  QueueSender sender=queueFactory.getSender(QueueFactory.QueueIdentifier.INSTANCE);
  for (int i=0; i < 100; i++) {
    sender.send(new TestEvent(i));
    System.out.println("Sent event:" + i);
  }
  try {
    Thread.sleep(1000);
  }
 catch (  InterruptedException e) {
    e.printStackTrace();
  }
  for (Event event=receiver.receiveEventNoWait(); event != null; event=receiver.receiveEventNoWait()) {
    TestEvent testEvent=(TestEvent)event;
    System.out.println("Received Event:" + testEvent.getNum());
    totalNum+=testEvent.getNum();
  }
  System.out.println("Total:" + totalNum);
}
