{
  Tag result;
  String originalValue=tag.getValue();
  try {
    tag.setValue(null);
    final Tag existing=lookup(tag);
    existing.setValue(originalValue);
    result=existing;
  }
 catch (  final NoSuchMetadataException e) {
    tag.setValue(originalValue);
    Entities.persist(tag);
    result=tag;
  }
 finally {
    tag.setValue(originalValue);
  }
  return result;
}
