{
  List<X509Cert> certs=(List<X509Cert>)object;
  Attribute[] attrs=new Attribute[2];
  attrs[0]=attrs[1]=null;
  for (  X509Cert cert : certs) {
    System.out.println("Processing " + cert.getAlias());
    if (cert != null) {
      Boolean revoked=cert.isRevoked();
      if (revoked != null && revoked.booleanValue()) {
        if (attrs[1] == null) {
          attrs[1]=new BasicAttribute(LdapConstants.EUCA_REVOKED_CERTIFICATE);
        }
        attrs[1].add(toLdapEucaCertString(cert));
        System.out.println("Adding revoked " + cert.getAlias());
      }
 else {
        if (attrs[0] == null) {
          attrs[0]=new BasicAttribute(LdapConstants.EUCA_CERTIFICATE);
        }
        attrs[0].add(toLdapEucaCertString(cert));
        System.out.println("Adding " + cert.getAlias());
      }
    }
  }
  return attrs;
}
