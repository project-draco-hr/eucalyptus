{
  return Suppliers.memoizeWithExpiration(new Supplier<AWSCredentials>(){
    @Override public AWSCredentials get(){
      try {
        final SecurityToken securityToken=SecurityTokenManager.issueSecurityToken(user,EXPIRATION_SECS);
        return new BasicSessionCredentials(securityToken.getAccessKeyId(),securityToken.getSecretKey(),securityToken.getToken());
      }
 catch (      final AuthException e) {
        throw Exceptions.toUndeclared(e);
      }
    }
  }
,EXPIRATION_SECS - PRE_EXPIRY,TimeUnit.SECONDS);
}
