{
  DescribeKeyPairsResponseType reply=request.getReply();
  Context ctx=Contexts.lookup();
  for (  SshKeyPair kp : KeyPairUtil.getUserKeyPairs(ctx.getUserFullName())) {
    if (request.getKeySet().isEmpty() || request.getKeySet().contains(kp.getDisplayName())) {
      if (Permissions.isAuthorized(PolicySpec.VENDOR_EC2,PolicySpec.EC2_RESOURCE_KEYPAIR,kp.getDisplayName(),ctx.getAccount(),PolicySpec.requestToAction(request),ctx.getUser())) {
        reply.getKeySet().add(new DescribeKeyPairsResponseItemType(kp.getDisplayName(),kp.getFingerPrint()));
      }
    }
  }
  return reply;
}
