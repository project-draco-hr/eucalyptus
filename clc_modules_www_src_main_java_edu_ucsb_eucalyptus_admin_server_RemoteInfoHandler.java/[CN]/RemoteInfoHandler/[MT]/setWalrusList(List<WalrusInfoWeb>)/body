{
  List<WalrusConfiguration> walrusConfig=Lists.newArrayList();
  for (  WalrusInfoWeb walrusControllerWeb : newWalrusList) {
    walrusConfig.add(new WalrusConfiguration(walrusControllerWeb.getName(),walrusControllerWeb.getHost(),walrusControllerWeb.getPort()));
  }
  updateWalrusConfigurations(walrusConfig);
  for (  WalrusInfoWeb walrusInfoWeb : newWalrusList) {
    UpdateWalrusConfigurationType updateWalrusConfiguration=new UpdateWalrusConfigurationType();
    updateWalrusConfiguration.setName(WalrusProperties.NAME);
    updateWalrusConfiguration.setBucketRootDirectory(walrusInfoWeb.getBucketsRootDirectory());
    updateWalrusConfiguration.setMaxBucketsPerUser(walrusInfoWeb.getMaxBucketsPerUser());
    updateWalrusConfiguration.setMaxBucketSize(walrusInfoWeb.getMaxBucketSizeInMB());
    updateWalrusConfiguration.setImageCacheSize(walrusInfoWeb.getMaxCacheSizeInMB());
    updateWalrusConfiguration.setTotalSnapshotSize(walrusInfoWeb.getSnapshotsTotalInGB());
    ServiceDispatcher scDispatch=ServiceDispatcher.lookupSingle(Component.walrus);
    scDispatch.send(updateWalrusConfiguration);
  }
}
