{
  ThreadMXBean bean=ManagementFactory.getThreadMXBean();
  long[] ids=bean.getAllThreadIds();
  for (  long id : ids) {
    final long c=bean.getThreadCpuTime(id);
    final long u=bean.getThreadUserTime(id);
    if (c == -1 || u == -1)     continue;
    timersLock.lock();
    try {
      SortedSet<Times> times=threadTimers.get(id);
      threadTimers.put(id,new Times(id,System.currentTimeMillis(),c,u));
      if (times.size() > 3) {
        times.remove(times.first());
      }
    }
  finally {
      timersLock.unlock();
    }
  }
}
