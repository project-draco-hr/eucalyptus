{
synchronized (lock) {
    if ((oldSpi != null) && (oldSpi != spi)) {
      return spi;
    }
    if (serviceIterator == null) {
      return null;
    }
    while (serviceIterator.hasNext()) {
      Service s=(Service)serviceIterator.next();
      if (JceSecurity.canUseProvider(s.getProvider()) == false) {
        continue;
      }
      try {
        Object obj=s.newInstance(null);
        if (obj instanceof SecretKeyFactorySpi == false) {
          continue;
        }
        SecretKeyFactorySpi spi=(SecretKeyFactorySpi)obj;
        provider=s.getProvider();
        this.spi=spi;
        return spi;
      }
 catch (      NoSuchAlgorithmException e) {
      }
    }
    serviceIterator=null;
    return null;
  }
}
