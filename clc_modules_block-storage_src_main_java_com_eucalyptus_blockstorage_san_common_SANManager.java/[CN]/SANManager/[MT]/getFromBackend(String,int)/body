{
  SANVolumeInfo snapInfo=new SANVolumeInfo(snapshotId);
  try (TransactionResource tran=Entities.transactionFor(SANVolumeInfo.class)){
    SANVolumeInfo foundSnapInfo=Entities.uniqueResult(snapInfo);
    if (foundSnapInfo == null || StringUtils.isBlank(foundSnapInfo.getSanVolumeId())) {
      throw new EucalyptusCloudException("Backend ID not found for " + snapshotId);
    }
    LOG.info("Checking for backend snapshot " + foundSnapInfo.getSanVolumeId() + " mapping to "+ snapshotId);
    if (connectionManager.snapshotExists(foundSnapInfo.getSanVolumeId())) {
      return true;
    }
 else {
      Entities.delete(foundSnapInfo);
    }
    tran.commit();
  }
 catch (  Exception ex) {
  }
  snapInfo.setScName(null);
  try (TransactionResource tran=Entities.transactionFor(SANVolumeInfo.class)){
    List<SANVolumeInfo> foundSnapInfos=Entities.query(snapInfo);
    for (    SANVolumeInfo foundSnapInfo : foundSnapInfos) {
      LOG.info("Checking for backend snapshot " + foundSnapInfo.getSanVolumeId() + " mapping to "+ snapshotId);
      if (connectionManager.snapshotExists(foundSnapInfo.getSanVolumeId())) {
        SANVolumeInfo newSnapInfo=new SANVolumeInfo(snapshotId,foundSnapInfo.getIqn(),foundSnapInfo.getSize()).withSanVolumeId(foundSnapInfo.getSanVolumeId()).withSnapshotOf(foundSnapInfo.getSnapshotOf());
        Entities.persist(newSnapInfo);
        tran.commit();
        return true;
      }
    }
  }
 catch (  Exception ex) {
  }
  return false;
}
