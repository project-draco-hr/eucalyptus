{
  try (TransactionResource tran=Entities.transactionFor(SANVolumeInfo.class)){
    SANVolumeInfo snapInfo=Entities.uniqueResult(new SANVolumeInfo(snapshotId));
    String iqn=snapInfo.getIqn();
    String sanVolumeId=snapInfo.getSanVolumeId();
    tran.commit();
    connectionManager.disconnectTarget(sanVolumeId,iqn);
  }
 catch (  NoSuchElementException e) {
    LOG.debug("Blockstorage backend record for " + snapshotId + " not found, skipping finish up");
  }
catch (  TransactionException ex) {
    LOG.error(ex);
    throw new EucalyptusCloudException("Unable to finalize snapshot: " + snapshotId);
  }
}
