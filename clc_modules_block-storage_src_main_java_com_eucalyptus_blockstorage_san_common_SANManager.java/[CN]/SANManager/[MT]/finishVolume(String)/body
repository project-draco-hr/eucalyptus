{
  EntityWrapper<SANVolumeInfo> db=StorageProperties.getEntityWrapper();
  try {
    SANVolumeInfo snapInfo=db.getUnique(new SANVolumeInfo(snapshotId));
    String iqn=snapInfo.getIqn();
    String sanVolumeId=snapInfo.getSanVolumeId();
    db.commit();
    connectionManager.disconnectTarget(sanVolumeId,iqn);
  }
 catch (  EucalyptusCloudException ex) {
    LOG.error(ex);
    db.rollback();
    throw new EucalyptusCloudException("Unable to finalize snapshot: " + snapshotId);
  }
}
