{
  EntityWrapper<WalrusInfo> db=WalrusControl.getEntityWrapper();
  WalrusInfo walrusInfo;
  try {
    walrusInfo=db.getUnique(new WalrusInfo());
    walrusInfo.setName(WalrusProperties.NAME);
    walrusInfo.setStorageDir(WalrusProperties.bucketRootDirectory);
    walrusInfo.setStorageMaxBucketsPerUser(WalrusProperties.MAX_BUCKETS_PER_USER);
    walrusInfo.setStorageMaxBucketSizeInMB((int)(WalrusProperties.MAX_BUCKET_SIZE / WalrusProperties.M));
    walrusInfo.setStorageMaxCacheSizeInMB((int)(WalrusProperties.IMAGE_CACHE_SIZE / WalrusProperties.M));
    walrusInfo.setStorageMaxTotalSnapshotSizeInGb(WalrusProperties.MAX_TOTAL_SNAPSHOT_SIZE);
  }
 catch (  EucalyptusCloudException ex) {
    walrusInfo=new WalrusInfo(WalrusProperties.NAME,WalrusProperties.bucketRootDirectory,WalrusProperties.MAX_BUCKETS_PER_USER,(int)(WalrusProperties.MAX_BUCKET_SIZE / WalrusProperties.M),(int)(WalrusProperties.IMAGE_CACHE_SIZE / WalrusProperties.M),WalrusProperties.MAX_TOTAL_SNAPSHOT_SIZE);
    db.add(walrusInfo);
  }
 finally {
    db.commit();
  }
}
