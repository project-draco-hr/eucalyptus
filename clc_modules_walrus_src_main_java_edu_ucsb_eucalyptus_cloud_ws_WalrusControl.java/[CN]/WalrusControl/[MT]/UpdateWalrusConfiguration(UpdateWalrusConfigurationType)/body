{
  UpdateWalrusConfigurationResponseType reply=(UpdateWalrusConfigurationResponseType)request.getReply();
  if (Component.eucalyptus.name().equals(request.getEffectiveUserId()))   throw new AccessDeniedException("Only admin can change walrus properties.");
  String name=request.getName();
  if (name != null)   WalrusProperties.NAME=name;
  String rootDir=request.getBucketRootDirectory();
  if (rootDir != null) {
    WalrusProperties.bucketRootDirectory=rootDir;
    storageManager.setRootDirectory(rootDir);
  }
  Integer maxBucketsPerUser=request.getMaxBucketsPerUser();
  if (maxBucketsPerUser != null)   WalrusProperties.MAX_BUCKETS_PER_USER=maxBucketsPerUser;
  Long maxBucketSize=request.getMaxBucketSize();
  if (maxBucketSize != null)   WalrusProperties.MAX_BUCKET_SIZE=maxBucketSize * WalrusProperties.M;
  Long imageCacheSize=request.getImageCacheSize();
  if (imageCacheSize != null)   WalrusProperties.IMAGE_CACHE_SIZE=imageCacheSize * WalrusProperties.M;
  Integer totalSnapshotSize=request.getTotalSnapshotSize();
  if (totalSnapshotSize != null)   WalrusProperties.MAX_TOTAL_SNAPSHOT_SIZE=totalSnapshotSize;
  walrusManager.check();
  updateConfig();
  return reply;
}
