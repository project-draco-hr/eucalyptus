{
  SnapshotInfo snapshotInfo=new SnapshotInfo();
  snapshotInfo.setStatus(StorageProperties.Status.failed.toString());
  List<SnapshotInfo> snapshotInfos;
  try {
    snapshotInfos=Transactions.findAll(snapshotInfo);
  }
 catch (  TransactionException e) {
    LOG.error("Error querying database for failed snapshots",e);
    snapshotInfos=null;
  }
  if (snapshotInfos == null || snapshotInfos.size() == 0) {
    LOG.info("No failed snapshots found to clean");
    return;
  }
  for (  SnapshotInfo snapInfo : snapshotInfos) {
    try {
      cleanSnapshot(snapInfo);
      Transactions.delete(snapInfo);
    }
 catch (    Throwable f) {
      LOG.warn("Failed cleaning failed snapshots",f);
    }
  }
}
