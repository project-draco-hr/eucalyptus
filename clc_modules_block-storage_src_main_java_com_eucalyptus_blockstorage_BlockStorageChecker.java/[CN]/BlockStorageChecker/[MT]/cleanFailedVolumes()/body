{
  VolumeInfo volumeInfo=new VolumeInfo();
  volumeInfo.setStatus(StorageProperties.Status.failed.toString());
  List<VolumeInfo> volumeInfos=null;
  try {
    volumeInfos=Transactions.findAll(volumeInfo);
  }
 catch (  Exception e) {
    LOG.warn("Error querying database for failed volumes",e);
  }
  if (volumeInfos == null || volumeInfos.size() == 0) {
    LOG.info("No failed volumes found to clean");
    return;
  }
  for (  VolumeInfo volInfo : volumeInfos) {
    try {
      LOG.info("Cleaning failed volume " + volInfo.getVolumeId());
      blockManager.cleanVolume(volInfo.getVolumeId());
      Transactions.delete(volInfo);
    }
 catch (    Exception e) {
      LOG.warn("Erorr cleaning failed volume " + volInfo.getVolumeId(),e);
    }
  }
}
