{
  EntityWrapper<SnapshotInfo> db=StorageProperties.getEntityWrapper();
  SnapshotInfo snapshotInfo=new SnapshotInfo(snapshotId);
  List<SnapshotInfo> snapshotInfos=db.query(snapshotInfo);
  if (snapshotInfos.size() > 0) {
    SnapshotInfo snapInfo=snapshotInfos.get(0);
    LOG.info("Cleaning failed snapshot " + snapshotId);
    blockManager.cleanSnapshot(snapshotId);
    db.delete(snapInfo);
  }
  db.commit();
}
