{
  String snapshotId=snapInfo.getSnapshotId();
  LOG.info("Checker task cleaning up snapshot " + snapshotId);
  try {
    LOG.debug("Disconnecting snapshot " + snapshotId + " from the Storage Controller");
    blockManager.finishVolume(snapshotId);
  }
 catch (  Exception e) {
    LOG.debug("Attempt to disconnect snapshot " + snapshotId + " from Storage Controller failed",e);
  }
  try {
    LOG.debug("Cleaning snapshot " + snapshotId + " on storage backend");
    blockManager.cleanSnapshot(snapshotId);
  }
 catch (  Exception e) {
    LOG.debug("Attempt to clean snapshot " + snapshotId + " on storage backend failed",e);
  }
  try {
    LOG.debug("Deleting snapshot " + snapshotId + " from OSG");
    String[] names=SnapshotInfo.getSnapshotBucketKeyNames(snapInfo.getSnapshotLocation());
    snapshotOps.cancelSnapshotUpload(snapshotId,names[0],names[1]);
  }
 catch (  Exception e) {
    LOG.debug("Attempt to clean uploaded snapshot " + snapshotId + " from OSG failed",e);
  }
}
