{
  String[] parts=path.split(":");
  try {
    MetadataRequest request=new MetadataRequest(parts[0],parts.length == 2 ? parts[1] : "/");
    if (metadataEndpoints.containsKey(request.getMetadataName()) && (request.isInstance() || request.isSystem())) {
      return metadataEndpoints.get(request.getMetadataName()).apply(request).getBytes();
    }
 else     if (publicMetadataEndpoints.containsKey(request.getMetadataName())) {
      return publicMetadataEndpoints.get(request.getMetadataName()).apply(request).getBytes();
    }
 else {
      return "".getBytes();
    }
  }
 catch (  Throwable ex) {
    LOG.error("Metadata request failed: " + path + " cause: "+ ex.getMessage(),ex);
    return Exceptions.string(ex).getBytes();
  }
}
