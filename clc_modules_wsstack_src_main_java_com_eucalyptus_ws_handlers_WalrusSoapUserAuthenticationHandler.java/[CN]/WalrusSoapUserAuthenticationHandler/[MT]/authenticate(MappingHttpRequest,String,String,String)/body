{
  signature=signature.replaceAll("=","");
  try {
    User user=Accounts.lookupUserByAccessKeyId(accessKeyID);
    String queryKey=user.getKey(accessKeyID).getSecretKey();
    String authSig=checkSignature(queryKey,data);
    if (!authSig.equals(signature))     throw new AuthenticationException("User authentication failed. Could not verify signature");
    Contexts.lookup(httpRequest.getCorrelationId()).setUser(user);
  }
 catch (  Exception ex) {
    throw new AuthenticationException("User authentication failed. Unable to obtain query key");
  }
}
