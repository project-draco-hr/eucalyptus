{
  if (event.getMessage() instanceof MappingHttpRequest) {
    MappingHttpRequest httpRequest=(MappingHttpRequest)event.getMessage();
    String content=httpRequest.getContent().toString("UTF-8");
    ByteArrayInputStream byteIn=new ByteArrayInputStream(content.getBytes());
    XMLStreamReader xmlStreamReader=XMLInputFactory.newInstance().createXMLStreamReader(byteIn);
    StAXSOAPModelBuilder soapBuilder=new StAXSOAPModelBuilder(xmlStreamReader,SOAP11Constants.SOAP_ENVELOPE_NAMESPACE_URI);
    SOAPEnvelope envelope=(SOAPEnvelope)soapBuilder.getDocumentElement();
    httpRequest.setMessageString(content);
    httpRequest.setSoapEnvelope(envelope);
    if (!envelope.hasFault())     httpRequest.setOmMessage(envelope.getBody().getFirstElement());
    SOAPBody body=envelope.getBody();
    final StAXOMBuilder doomBuilder=new StAXOMBuilder(DOOMAbstractFactory.getOMFactory(),body.getXMLStreamReader());
    final OMElement elem=doomBuilder.getDocumentElement();
    elem.build();
    final Document doc=((Element)elem).getOwnerDocument();
    handle(httpRequest,doc);
  }
}
