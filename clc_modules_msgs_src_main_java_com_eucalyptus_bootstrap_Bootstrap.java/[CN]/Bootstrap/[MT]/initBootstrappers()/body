{
  for (  Bootstrapper bootstrap : BootstrapperDiscovery.getBootstrappers()) {
    com.eucalyptus.bootstrap.Component comp, old=com.eucalyptus.bootstrap.Component.any;
    String bc=bootstrap.getClass().getCanonicalName();
    Bootstrap.Stage stage=Ats.from(bootstrap).get(RunDuring.class).value();
    Provides p=Ats.from(bootstrap).get(Provides.class);
    comp=(p.value() == null ? old : p.value());
    if (Components.delegate.any.equals(comp)) {
      EventRecord.here(Bootstrap.class,EventType.BOOTSTRAPPER_ADDED,currentStage.name(),bc,"Provides",comp.name(),"Component." + comp.name() + ".isEnabled","true").info();
      stage.addBootstrapper(bootstrap);
    }
 else     if (!comp.isCloudLocal() && !comp.isEnabled() && Components.contains(comp)) {
      EventRecord.here(Bootstrap.class,EventType.BOOTSTRAPPER_SKIPPED,currentStage.name(),bc,"Provides",comp.name(),"Component." + comp.name() + ".isEnabled",comp.isEnabled().toString()).info();
    }
 else     if (!bootstrap.checkLocal()) {
      EventRecord.here(Bootstrap.class,EventType.BOOTSTRAPPER_SKIPPED,currentStage.name(),bc,"DependsLocal",comp.name(),"Component." + comp.name() + ".isLocal",comp.isLocal().toString()).info();
    }
 else     if (!bootstrap.checkRemote()) {
      EventRecord.here(Bootstrap.class,EventType.BOOTSTRAPPER_SKIPPED,currentStage.name(),bc,"DependsRemote",comp.name(),"Component." + comp.name() + ".isLocal",comp.isLocal().toString()).info();
    }
 else     if (!Components.contains(comp)) {
      Exceptions.eat("Bootstrap class provides a component for which registration failed: " + bc + " provides "+ comp.name());
      try {
        Components.create(comp.name(),null);
      }
 catch (      ServiceRegistrationException ex) {
        LOG.error(ex,ex);
      }
    }
 else {
      EventRecord.here(Bootstrap.class,EventType.BOOTSTRAPPER_ADDED,currentStage.name(),bc,"Provides",comp.name(),"Component." + comp.name() + ".isEnabled",comp.isEnabled().toString()).info();
      Component realComponent=Components.lookup(comp);
      realComponent.getConfiguration().addBootstrapper(bootstrap);
      stage.addBootstrapper(bootstrap);
    }
  }
}
