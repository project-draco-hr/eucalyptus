{
  try {
    EucaSemaphore semaphore=EucaSemaphoreDirectory.getSolitarySemaphore(volumeId);
    try {
      semaphore.acquire();
    }
 catch (    InterruptedException ex) {
      throw new EucalyptusCloudException("semaphore could not be acquired");
    }
    blockManager.createSnapshot(volumeId,snapshotId);
    semaphore.release();
    List<String> returnValues=blockManager.prepareForTransfer(snapshotId);
    snapshotFileName=returnValues.get(0);
    transferSnapshot();
  }
 catch (  EucalyptusCloudException ex) {
    LOG.error(ex);
  }
}
