{
  try {
    EucaSemaphore semaphore=EucaSemaphoreDirectory.getSolitarySemaphore(volumeId);
    try {
      semaphore.acquire();
    }
 catch (    InterruptedException ex) {
      throw new EucalyptusCloudException("semaphore could not be acquired");
    }
    List<String> returnValues=blockManager.createSnapshot(volumeId,snapshotId);
    semaphore.release();
    if (returnValues.size() < 2) {
      throw new EucalyptusCloudException("Unable to transfer snapshot");
    }
    snapshotFileName=returnValues.get(0);
    transferSnapshot(returnValues.get(1));
    blockManager.finishSnapshot(snapshotId);
  }
 catch (  Exception ex) {
    LOG.error(ex);
  }
}
