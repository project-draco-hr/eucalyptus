{
  BlockStorageChecker.checkWalrusConnection();
  if (!StorageProperties.enableSnapshots) {
    LOG.error("Could not connect to Walrus. Snapshot functionality disabled. Please check the Walrus url");
    throw new EucalyptusCloudException("could not connect to Walrus.");
  }
  String snapshotLocation="snapshots" + "/" + snapshotId;
  String absoluteSnapshotPath=StorageProperties.storageRootDirectory + "/" + snapshotId;
  File file=new File(absoluteSnapshotPath);
  if (file.exists()) {
    file.delete();
  }
  HttpReader snapshotGetter=new HttpReader(snapshotLocation,null,file,"GetWalrusSnapshot","",true);
  snapshotGetter.run();
  int snapshotSize=(int)(file.length() / StorageProperties.GB);
  if (snapshotSize == 0) {
    throw new EucalyptusCloudException("could not get snapshot");
  }
  EntityWrapper<SnapshotInfo> db=new EntityWrapper<SnapshotInfo>();
  SnapshotInfo snapshotInfo=new SnapshotInfo(snapshotId);
  snapshotInfo.setProgress("100");
  snapshotInfo.setStartTime(new Date());
  snapshotInfo.setStatus(StorageProperties.Status.available.toString());
  return absoluteSnapshotPath;
}
