{
  if (networkToken != null) {
    StartNetworkType msg=new StartNetworkType(this.vmAllocInfo.getRequest(),networkToken.getVlan(),networkToken.getNetworkName());
    StartNetworkCallback callback=new StartNetworkCallback(this,networkToken);
    QueuedEvent<StartNetworkType> event=new QueuedEvent<StartNetworkType>(callback,msg);
    this.msgMap.put(State.CREATE_NETWORK,event);
  }
  try {
    Network network=Networks.getInstance().lookup(networkToken.getName());
    if (network.getRules().isEmpty())     return;
    ConfigureNetworkCallback callback=new ConfigureNetworkCallback();
    ConfigureNetworkType msg=new ConfigureNetworkType(this.vmAllocInfo.getRequest(),network.getRules());
    QueuedEvent event=new QueuedEvent<ConfigureNetworkType>(callback,msg);
    this.msgMap.put(State.CREATE_NETWORK_RULES,event);
  }
 catch (  NoSuchElementException e) {
  }
}
