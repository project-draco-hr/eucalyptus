{
  if (volumeGroup == null) {
    if (DASInfo.getStorageInfo().getDASDevice() != null) {
      try {
        String returnValue=getPhysicalVolume(DASInfo.getStorageInfo().getDASDevice());
        if (!returnValue.matches("(?s:.*)PV Name.*" + DASInfo.getStorageInfo().getDASDevice() + "(?s:.*)")) {
          returnValue=createPhysicalVolume(DASInfo.getStorageInfo().getDASDevice());
          if (returnValue.length() == 0) {
            throw new EucalyptusCloudException("Unable to create physical volume on device: " + DASInfo.getStorageInfo().getDASDevice());
          }
        }
        returnValue=getVolumeGroupsVerbose();
        if (!returnValue.matches("(?s:.*)PV Name.*" + DASInfo.getStorageInfo().getDASDevice() + "(?s:.*)")) {
          volumeGroup="vg-" + Hashes.getRandom(10);
          returnValue=createVolumeGroup(DASInfo.getStorageInfo().getDASDevice(),volumeGroup);
          if (returnValue.length() == 0) {
            throw new EucalyptusCloudException("Unable to create volume group: " + volumeGroup + " physical volume: "+ DASInfo.getStorageInfo().getDASDevice());
          }
        }
 else {
          Pattern volumeGroupPattern=Pattern.compile("(?s:.*VG Name)(.*)\n.*");
          Matcher m=volumeGroupPattern.matcher(returnValue);
          if (m.find())           volumeGroup=m.group(1).trim();
 else           throw new EucalyptusCloudException("Unable to get volume group for physical volume: " + DASInfo.getStorageInfo().getDASDevice());
        }
      }
 catch (      ExecutionException e) {
        LOG.error(e);
        throw new EucalyptusCloudException(e);
      }
    }
 else {
      throw new EucalyptusCloudException("DAS partition not yet configured. Please specify partition.");
    }
  }
}
