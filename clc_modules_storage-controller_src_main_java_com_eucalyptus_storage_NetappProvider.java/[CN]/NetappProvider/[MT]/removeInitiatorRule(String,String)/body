{
  volumeId=sanitizeVolumeId(volumeId);
  EntityWrapper<IgroupInfo> db=StorageProperties.getEntityWrapper();
  String groupName=null;
  try {
    IgroupInfo igroup=db.getUnique(new IgroupInfo(volumeId));
    groupName=igroup.getiGroupName();
    igroup.setIqn(null);
  }
 catch (  EucalyptusCloudException ex) {
    throw new EucalyptusCloudException("Unable to find initiator group for volume: " + volumeId);
  }
 finally {
    db.commit();
  }
  String lunPath="/vol/" + volumeId + "/lun1";
  if (onlyNode(nodeIqn)) {
    try {
      removeInitiatorAuth(nodeIqn);
    }
 catch (    EucalyptusCloudException ex) {
      LOG.error(ex);
    }
  }
  try {
    unmapLun(lunPath,groupName);
  }
 catch (  EucalyptusCloudException ex) {
    LOG.error(ex);
  }
  removeInitiator(groupName,nodeIqn);
}
