{
  final UserFullName ownerFullName=evt.getContext().getUserFullName();
  LoadBalancer lb=null;
  try {
    lb=LoadBalancers.getLoadbalancer(ownerFullName,evt.getLoadBalancer());
  }
 catch (  Exception ex) {
    throw new EventHandlerException("failed to find the loadbalancer",ex);
  }
  final Collection<String> zones=evt.getZones();
  String zoneToLaunch=null;
  if (zones.size() > 0) {
    zoneToLaunch=new ArrayList<String>(zones).get(0);
  }
  List<String> instanceIds=null;
  String instanceId=null;
  try {
    instanceIds=EucalyptusActivityTasks.getInstance().launchInstances(zoneToLaunch,LOADBALANCER_EMI,LOADBALANCER_INSTANCE_TYPE,1);
    LOG.info("new servo instance launched: " + instanceIds.get(0));
    instanceId=instanceIds.get(0);
  }
 catch (  Exception ex) {
    throw new EventHandlerException("failed to launch the servo instance",ex);
  }
  final EntityTransaction db=Entities.get(LoadBalancerServoInstance.class);
  try {
    Entities.uniqueResult(LoadBalancerServoInstance.named(instanceId));
  }
 catch (  NoSuchElementException ex) {
    final LoadBalancerServoInstance newInstance=LoadBalancerServoInstance.named(instanceId,zoneToLaunch);
    newInstance.setLoadbalancer(lb);
    Entities.persist(newInstance);
    db.commit();
  }
catch (  Exception ex) {
    LOG.error("failed to persist the servo instance " + instanceId,ex);
    db.rollback();
    throw new EventHandlerException("failed to persist the servo instance",ex);
  }
}
