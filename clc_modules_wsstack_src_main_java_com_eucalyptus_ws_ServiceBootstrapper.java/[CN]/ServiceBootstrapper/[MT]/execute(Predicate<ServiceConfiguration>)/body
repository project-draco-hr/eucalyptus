{
  for (  final ComponentId compId : ComponentIds.list()) {
    Component comp=Components.lookup(compId);
    if (compId.isRegisterable()) {
      ServiceBuilder<? extends ServiceConfiguration> builder=comp.getBuilder();
      try {
        for (        ServiceConfiguration config : Iterables.filter(builder.list(),ShouldLoad.INSTANCE)) {
          try {
            predicate.apply(config);
          }
 catch (          Throwable ex) {
            LOG.error(ex,ex);
          }
        }
      }
 catch (      ServiceRegistrationException ex) {
        LOG.error(ex,ex);
      }
    }
 else     if (comp.hasLocalService()) {
      final ServiceConfiguration config=comp.getLocalServiceConfiguration();
      if (config.isVmLocal() || (Bootstrap.isCloudController() && config.isHostLocal())) {
        predicate.apply(config);
      }
    }
  }
}
