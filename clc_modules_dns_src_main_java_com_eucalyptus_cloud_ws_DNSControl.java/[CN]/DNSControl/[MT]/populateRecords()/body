{
  DNSProperties.update();
  try (final TransactionResource db=Entities.transactionFor(ZoneInfo.class)){
    List<ZoneInfo> zoneInfos=Entities.query(new ZoneInfo());
    for (    ZoneInfo zoneInfo : zoneInfos) {
      String name=zoneInfo.getName();
      SOARecordInfo searchSOARecordInfo=new SOARecordInfo();
      searchSOARecordInfo.setName(name);
      SOARecordInfo soaRecordInfo=Entities.uniqueResult(searchSOARecordInfo);
      NSRecordInfo searchNSRecordInfo=new NSRecordInfo();
      searchNSRecordInfo.setName(name);
      NSRecordInfo nsRecordInfo=Entities.uniqueResult(searchNSRecordInfo);
      ZoneManager.addZone(zoneInfo,soaRecordInfo,nsRecordInfo);
    }
    ARecordInfo searchARecInfo=new ARecordInfo();
    List<ARecordInfo> aRecInfos=Entities.query(searchARecInfo);
    for (    ARecordInfo aRecInfo : aRecInfos) {
      ZoneManager.addRecord(aRecInfo,false);
    }
    db.commit();
  }
 catch (  NoSuchElementException|TransactionException ex) {
    LOG.error(ex);
  }
  final EntityTransaction db2=Entities.get(ARecordNameInfo.class);
  try {
    int count=0;
    List<ARecordNameInfo> multiARec=Entities.query(new ARecordNameInfo(),true);
    if (multiARec != null && multiARec.size() > 0) {
      for (      ARecordNameInfo nameRec : multiARec) {
        final Collection<ARecordAddressInfo> addresses=nameRec.getAddresses();
        if (addresses != null && addresses.size() > 0) {
          for (          final ARecordAddressInfo addrRec : addresses) {
            ARecord record=new ARecord(new Name(nameRec.getName()),DClass.IN,nameRec.getTtl(),Address.getByAddress(addrRec.getAddress()));
            ZoneManager.addRecord(nameRec.getZone(),record,true);
            count++;
          }
        }
      }
    }
    LOG.debug(String.format("%d DNS records populated from database",count));
    db2.commit();
  }
 catch (  Exception ex) {
    db2.rollback();
    LOG.error("Failed to populate the existing DNS records",ex);
  }
}
