{
  final CreateLoadBalancerResponseType reply=request.getReply();
  final Context ctx=Contexts.lookup();
  final UserFullName ownerFullName=ctx.getUserFullName();
  final String lbName=request.getLoadBalancerName();
  final LoadBalancer lb=LoadBalancers.addLoadbalancer(ownerFullName,lbName);
  if (lb == null)   throw new LoadBalancingException(String.format("Requested loadbalancer %s cannot be created",lbName));
  final CreateLoadBalancerResult result=new CreateLoadBalancerResult();
  if (lb != null && lb.getDnsAddress() == null) {
    LOG.error("No DNS name is assigned to a loadblancer");
  }
  result.setDnsName(lb != null ? lb.getDnsAddress() : null);
  reply.setCreateLoadBalancerResult(result);
  reply.set_return(true);
  return reply;
}
