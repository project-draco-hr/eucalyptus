{
  String[] attrNames=new String[]{idAttrName,memberAttrName};
  if (VERBOSE) {
    LOG.debug("Search users by: baseDn=" + lic.getUserBaseDn() + ", attributes="+ attrNames);
  }
  NamingEnumeration<SearchResult> results=ldap.search(baseDn,WILDCARD_FILTER,attrNames);
  try {
    Map<String,Set<String>> groupMap=Maps.newHashMap();
    while (results.hasMore()) {
      Attributes attrs=results.next().getAttributes();
      if (VERBOSE) {
        LOG.debug("Retrieved group: " + attrs);
      }
      groupMap.put(getId(idAttrName,attrs),getMembers(memberIdAttrName,memberAttrName,attrs));
    }
    return groupMap;
  }
 catch (  NamingException e) {
    LOG.error(e,e);
    throw new LdapException("Error reading groups",e);
  }
}
