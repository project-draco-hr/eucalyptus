{
  try {
    Set<String> oldAccountSet=getLocalAccountSet();
    if (!lic.hasAccountingGroups()) {
      accountingGroups=lic.getGroupsPartition();
    }
    for (    Map.Entry<String,Set<String>> entry : accountingGroups.entrySet()) {
      String accountName=entry.getKey();
      Set<String> accountMembers=entry.getValue();
      if (oldAccountSet.contains(accountName)) {
        oldAccountSet.remove(accountName);
        updateAccount(accountName,accountMembers,groups,users);
      }
 else {
        addNewAccount(accountName,accountMembers,groups,users);
      }
    }
    removeObsoleteAccounts(oldAccountSet);
  }
 catch (  AuthException e) {
    LOG.error(e,e);
    LOG.error("Error in rebuilding local auth database",e);
  }
}
