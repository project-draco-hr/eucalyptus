{
  LOG.debug("Updating group " + group + " in account "+ accountName);
  if (users == null) {
    LOG.error("Empty new user set of group " + group);
    return;
  }
  try {
    Set<String> localUserSet=Sets.newHashSet();
    Group g=Groups.lookupGroupByName(group,accountName);
    for (    User u : g.getUsers()) {
      localUserSet.add(u.getName());
    }
    for (    String user : users) {
      if (localUserSet.contains(user)) {
        localUserSet.remove(user);
      }
 else {
        LOG.debug("Adding " + user + " to "+ g.getName());
        g.addMember(new DummyPrincipal(user));
      }
    }
    for (    String user : localUserSet) {
      LOG.debug("Removing " + user + " from "+ g.getName());
      g.removeMember(new DummyPrincipal(user));
    }
  }
 catch (  AuthException e) {
    LOG.error(e,e);
    LOG.warn("Failed to update group " + group + " in "+ accountName,e);
  }
}
