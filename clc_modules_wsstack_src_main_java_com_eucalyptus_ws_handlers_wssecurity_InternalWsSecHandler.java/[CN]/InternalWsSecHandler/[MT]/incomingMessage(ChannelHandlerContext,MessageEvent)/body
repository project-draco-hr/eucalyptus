{
  final Object o=event.getMessage();
  if (o instanceof MappingHttpMessage) {
    final MappingHttpMessage httpRequest=(MappingHttpMessage)o;
    SOAPEnvelope envelope=httpRequest.getSoapEnvelope();
    X509Certificate cert=WSSecurity.getVerifiedCertificate(envelope);
    if (cert != null) {
      if (!cert.equals(SystemCredentialProvider.getCredentialProvider(Component.eucalyptus).getCertificate())) {
        throw new WSSecurityException(WSSecurityException.FAILED_AUTHENTICATION);
      }
    }
  }
}
