{
  if (userId == null || userId.length() <= 0)   throw new IllegalArgumentException("User ID is required");
  if (snapshotId == null || snapshotId.length() <= 0)   throw new IllegalArgumentException("Snapshot ID is required");
  if (imageName == null || imageName.length() <= 0)   throw new IllegalArgumentException("Image name is required");
  final EucalyptusRegisterEBSImageTask task=new EucalyptusRegisterEBSImageTask(snapshotId,imageName,description);
  final CheckedListenableFuture<Boolean> result=task.dispatch(new EucalyptusUserActivity(userId));
  try {
    if (result.get())     return task.getImageId();
 else     throw new EucalyptusActivityException("failed to register ebs image");
  }
 catch (  final Exception ex) {
    throw Exceptions.toUndeclared(ex);
  }
}
