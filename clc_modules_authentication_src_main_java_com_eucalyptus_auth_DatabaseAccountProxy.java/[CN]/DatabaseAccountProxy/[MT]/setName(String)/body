{
  try {
    (new DatabaseAuthProvider()).lookupAccountByName(name);
  }
 catch (  AuthException ae) {
    try {
      Transactions.one(AccountEntity.newInstanceWithAccountNumber(this.delegate.getAccountNumber()),new Tx<AccountEntity>(){
        public void fire(        AccountEntity t){
          t.setName(name);
        }
      }
);
    }
 catch (    Exception e) {
      Debugging.logError(LOG,e,"Failed to setName for " + this.delegate);
      throw new AuthException(e);
    }
    return;
  }
  throw new AuthException("Can not change to a name already in use: " + name);
}
