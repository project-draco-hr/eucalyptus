{
  AWSCredentials credentials;
  try {
    credentials=mapCredentials(requestUser);
  }
 catch (  Exception e) {
    LOG.error("Error mapping credentials for user " + (requestUser != null ? requestUser.getUserId() : "null") + " for walrus backend call.",e);
    InternalErrorException ex=new InternalErrorException("Cannot construct s3client due to inability to map credentials for user: " + (requestUser != null ? requestUser.getUserId() : "null"));
    ex.initCause(e);
    throw ex;
  }
  try {
    OsgInternalS3Client internalS3Client=getClientPool(credentials,this.getUpstreamEndpoint(),this.doUsePathStyle()).borrowObject();
    return internalS3Client;
  }
 catch (  Exception e) {
    LOG.error("exception thrown retrieving internal s3 client",e);
    return null;
  }
}
