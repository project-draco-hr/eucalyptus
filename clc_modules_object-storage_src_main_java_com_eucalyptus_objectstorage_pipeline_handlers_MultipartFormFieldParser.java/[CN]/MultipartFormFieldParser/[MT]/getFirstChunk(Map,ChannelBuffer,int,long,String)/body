{
  buffer.markReaderIndex();
  byte[] read=new byte[buffer.readableBytes()];
  buffer.readBytes(read);
  int index=getLastIndex(read,PART_HEADER_BOUNDARY.getBytes("UTF-8"));
  if (index > -1) {
    int firstIndex=index + 1;
    int lastIndex=read.length;
    boundary=PART_LINE_DELIMITER + boundary;
    index=getFirstIndex(read,firstIndex,CR.getBytes("UTF-8"));
    if (index > -1) {
      lastIndex=index;
    }
    ChannelBuffer firstBuffer=ChannelBuffers.copiedBuffer(read,firstIndex,(lastIndex - firstIndex));
    formFields.put(ObjectStorageProperties.FIRST_CHUNK_FIELD,firstBuffer);
    long fileContentLength=contentLength - startingOffset - firstIndex- boundary.getBytes("UTF-8").length- 4;
    if (lastIndex < read.length) {
      fileContentLength=lastIndex - firstIndex;
    }
    formFields.put(ObjectStorageProperties.UPLOAD_LENGTH_FIELD,fileContentLength);
  }
  buffer.resetReaderIndex();
}
