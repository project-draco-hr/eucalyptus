{
  refreshOsgURI();
  try {
    FileInputStreamWithCallback snapInputStream=new FileInputStreamWithCallback(snapshotFile,callback);
    ObjectMetadata metadata=new ObjectMetadata();
    metadata.setContentLength(snapInputStream.getFileSize());
    s3Client.getS3Client().putObject(bucket,key,snapInputStream,metadata);
  }
 catch (  Exception ex) {
    LOG.error("Failed to upload snapshot file with key " + key,ex);
    throw new EucalyptusCloudException(ex);
  }
}
