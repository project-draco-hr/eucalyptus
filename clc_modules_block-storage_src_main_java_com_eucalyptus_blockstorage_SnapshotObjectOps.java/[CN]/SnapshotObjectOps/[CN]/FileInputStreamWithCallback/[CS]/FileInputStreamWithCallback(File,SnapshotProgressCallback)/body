{
  super(file);
  totalRead=0;
  if (file.length() > 0) {
    fileSize=file.length();
  }
 else {
    try {
      CommandOutput result=SystemUtil.runWithRawOutput(new String[]{StorageProperties.EUCA_ROOT_WRAPPER,"blockdev","--getsize64",file.getAbsolutePath()});
      fileSize=Long.parseLong(StringUtils.trimToEmpty(result.output));
    }
 catch (    Exception ex) {
      throw new UnknownFileSizeException(file.getAbsolutePath(),ex);
    }
  }
  this.callback=callback;
}
