{
  VmTypeInfo vbr=null;
  try {
    vbr=VmTypes.asVmTypeInfo(allocInfo.getVmType(),allocInfo.getBootSet().getMachine());
  }
 catch (  MetadataException ex) {
    LOG.error(ex,ex);
  }
  VmInstance vmInst=new VmInstance(userFullName,VmInstances.getId(allocInfo.getReservationIndex(),index),token.getInstanceUuids().get(index),reservationId,index,token.getCluster(),allocInfo.getUserData(),vbr,allocInfo.getSshKeyPair(),allocInfo.getVmType(),allocInfo.getBootSet().getMachine().getPlatform().name(),allocInfo.getNetworkRulesGroups(),networkIndex.toString());
  return vmInst;
}
