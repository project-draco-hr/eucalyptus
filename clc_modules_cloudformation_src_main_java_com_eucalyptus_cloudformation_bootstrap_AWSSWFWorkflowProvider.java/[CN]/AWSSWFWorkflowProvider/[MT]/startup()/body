{
  System.setProperty("com.amazonaws.sdk.disableCertChecking","true");
  creds=new BasicAWSCredentials(AWS_ACCESS_KEY,AWS_SECRET_KEY);
  if (creds == null) {
    throw new Exception("Unable to get credentials for cloudformation user");
  }
  simpleWorkflowClient=new AmazonSimpleWorkflowClient(creds);
  simpleWorkflowClient.setRegion(Region.getRegion(Regions.US_EAST_1));
  try {
    RegisterDomainRequest registerDomainRequest=new RegisterDomainRequest();
    registerDomainRequest.setName(SWF_DOMAIN);
    registerDomainRequest.setWorkflowExecutionRetentionPeriodInDays("1");
    simpleWorkflowClient.registerDomain(registerDomainRequest);
  }
 catch (  DomainAlreadyExistsException ex) {
    LOG.debug("SWF domain " + SWF_DOMAIN + " already exists");
  }
  stackWorkflowWorker=new WorkflowWorker(simpleWorkflowClient,SWF_DOMAIN,SWF_TASKLIST);
  stackWorkflowWorker.addWorkflowImplementationType(CreateStackWorkflowImpl.class);
  stackWorkflowWorker.addWorkflowImplementationType(DeleteStackWorkflowImpl.class);
  stackWorkflowWorker.start();
  stackActivityWorker=new ActivityWorker(simpleWorkflowClient,SWF_DOMAIN,SWF_TASKLIST);
  stackActivityWorker.addActivitiesImplementation(new StackActivityImpl());
  stackActivityWorker.start();
}
