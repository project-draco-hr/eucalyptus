{
  EntityWrapper<ReportingS3ObjectUsageEvent> entityWrapper=EntityWrapper.get(ReportingS3ObjectUsageEvent.class);
  try {
    ReportingS3ObjectUsageEvent s3Object=new ReportingS3ObjectUsageEvent(s3BucketName,s3ObjectName,s3ObjectSize,timestampMs,userId);
    entityWrapper.add(s3Object);
    entityWrapper.commit();
    LOG.debug("Added event to db:" + s3Object);
  }
 catch (  Exception ex) {
    LOG.error(ex);
    entityWrapper.rollback();
    throw new RuntimeException(ex);
  }
}
