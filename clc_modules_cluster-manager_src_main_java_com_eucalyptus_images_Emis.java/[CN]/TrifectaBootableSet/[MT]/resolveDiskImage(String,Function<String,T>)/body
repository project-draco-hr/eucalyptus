{
  T img=resolver.apply(imageId);
  if (Contexts.exists()) {
    Predicate<T> filter=Predicates.and(Images.FilterPermissions.INSTANCE,RestrictedTypes.filterPrivilegedWithoutOwner());
    if (filter.apply(img)) {
      return img;
    }
 else {
      throw new IllegalMetadataAccessException(imageId + ": permission denied.");
    }
  }
 else {
    return img;
  }
}
