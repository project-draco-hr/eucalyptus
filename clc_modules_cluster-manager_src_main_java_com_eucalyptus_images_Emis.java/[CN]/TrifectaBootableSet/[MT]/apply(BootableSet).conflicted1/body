{
  if (ImageMetadata.Platform.windows.equals(input.getMachine().getPlatform())) {
    return input;
  }
 else {
    String kernelId="unknown";
    try {
      kernelId=determineKernelId(input);
      LOG.debug("Determined the appropriate kernelId to be " + kernelId + " for "+ input.toString());
      KernelImageInfo kernel=RestrictedTypes.doPrivilegedWithoutOwner(kernelId,LookupKernel.INSTANCE);
      return new NoRamdiskBootableSet(input.getMachine(),kernel);
    }
 catch (    Exception ex) {
      throw Exceptions.toUndeclared(new NoSuchMetadataException("Failed to lookup kernel image information " + kernelId + " because of: "+ ex.getMessage(),ex));
    }
  }
}
