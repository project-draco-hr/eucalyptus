{
  BootableSet bootSet=null;
  try {
    bootSet=new BootableSet(Types.doPrivileged(imageId,LookupMachine.INSTANCE));
  }
 catch (  Exception e) {
    try {
      bootSet=new BootableSet(Types.doPrivileged(imageId,LookupBlockStorage.INSTANCE));
    }
 catch (    IllegalContextAccessException ex) {
      throw new VerificationException(ex);
    }
catch (    NoSuchElementException ex) {
      throw new NoSuchMetadataException(ex);
    }
catch (    PersistenceException ex) {
      throw new InvalidMetadataException(ex);
    }
  }
  if (bootSet.isLinux()) {
    bootSet=Emis.bootsetWithKernel(bootSet);
    bootSet=Emis.bootsetWithRamdisk(bootSet);
  }
  Emis.checkStoredImage(bootSet);
  return bootSet;
}
