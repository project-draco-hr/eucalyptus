{
  VmTypeInfo vmTypeInfo=null;
  if (this.getMachine() instanceof StaticDiskImage) {
    if (Image.Platform.windows.equals(this.getMachine().getPlatform())) {
      vmTypeInfo=VmTypes.InstanceStoreWindowsVmTypeInfoMapper.INSTANCE.apply(vmType);
    }
 else {
      vmTypeInfo=VmTypes.InstanceStoreVmTypeInfoMapper.INSTANCE.apply(vmType);
    }
    vmTypeInfo.setRoot(this.getMachine().getDisplayName(),((StaticDiskImage)this.getMachine()).getManifestLocation(),imgSize);
  }
 else   if (this.getMachine() instanceof BlockStorageImageInfo) {
    vmTypeInfo=VmTypes.BlockStorageVmTypeInfoMapper.INSTANCE.apply(vmType);
    vmTypeInfo.setEbsRoot(this.getMachine().getDisplayName(),null,imgSize);
  }
 else {
    throw new EucalyptusCloudException("Failed to identify the root machine image type: " + this.getMachine());
  }
  return vmTypeInfo;
}
