{
  Long imgSize=this.getMachine().getImageSizeBytes();
  if (imgSize > 1024l * 1024l * 1024l* vmType.getDisk()) {
    throw new EucalyptusCloudException("image too large [size=" + imgSize / (1024l * 1024l) + "MB] for instance type " + vmType.getName() + " [disk=" + vmType.getDisk() * 1024l + "MB]");
  }
  if (this.getMachine() instanceof StaticDiskImage) {
    vmType.setRoot(this.getMachine().getDisplayName(),((StaticDiskImage)this.getMachine()).getManifestLocation(),imgSize);
  }
 else   if (this.getMachine() instanceof BlockStorageImageInfo) {
    vmType.setEbsRoot(this.getMachine().getDisplayName(),null,imgSize);
  }
  if (this.hasKernel()) {
    vmType.setKernel(this.getKernel().getDisplayName(),this.getKernel().getManifestLocation());
  }
  if (this.hasRamdisk()) {
    vmType.setRamdisk(this.getRamdisk().getDisplayName(),this.getRamdisk().getManifestLocation());
  }
}
