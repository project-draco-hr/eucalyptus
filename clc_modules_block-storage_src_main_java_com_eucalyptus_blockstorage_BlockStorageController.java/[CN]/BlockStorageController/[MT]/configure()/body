{
  StorageProperties.updateWalrusUrl();
  StorageProperties.updateName();
  StorageProperties.updateStorageHost();
  try {
    blockManager=StorageManagers.getInstance();
    if (blockManager != null) {
      blockManager.initialize();
    }
 else {
      throw new EucalyptusCloudException("Got null block manager. Cannot configure.");
    }
  }
 catch (  Exception e) {
    throw new EucalyptusCloudException(e);
  }
  checker=new BlockStorageChecker(blockManager);
  volumeService=new VolumeService();
  snapshotService=new SnapshotService();
  checkerService=new StorageCheckerService();
  try {
    Account account=Accounts.lookupAccountByName(Account.SYSTEM_ACCOUNT);
    account.lookupUserByName(StorageProperties.BLOCKSTORAGE_ACCOUNT);
  }
 catch (  Exception e) {
    LOG.info("Blockstorage admin does not exist. Adding it now.");
    try {
      Account system=Accounts.lookupAccountByName(Account.SYSTEM_ACCOUNT);
      User blockstorage=system.addUser(StorageProperties.BLOCKSTORAGE_ACCOUNT,"/blockstorage",true,true,null);
      blockstorage.createKey();
    }
 catch (    Exception ex) {
      LOG.error(ex,ex);
    }
  }
}
