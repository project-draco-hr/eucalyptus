{
  EntityTransaction db=Entities.get(SnapshotInfo.class);
  db.setRollbackOnly();
  try {
    SnapshotInfo snap=Entities.uniqueResult(new SnapshotInfo(snapshotId));
    if (snap != null && StorageProperties.Status.failed.toString().equals(snap.getStatus())) {
      return true;
    }
  }
 catch (  Exception e) {
    LOG.error("Error determining status of snapshot " + snapshotId);
  }
 finally {
    db.rollback();
  }
  return false;
}
