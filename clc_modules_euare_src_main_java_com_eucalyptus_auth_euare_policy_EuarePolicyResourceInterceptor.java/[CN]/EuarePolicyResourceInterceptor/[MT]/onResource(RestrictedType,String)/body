{
  EuarePolicyContext.clearContext();
  if (resource != null) {
    if (accepted.contains(resource.getClass()) || (!rejected.contains(resource.getClass()) && Account.class.isAssignableFrom(resource.getClass())))     try {
      EuarePolicyContext.setEuarePolicyContextResource(TypeMappers.transform(resource,EuarePolicyContextResource.class));
      accepted.add(resource.getClass());
    }
 catch (    IllegalArgumentException e) {
      rejected.add(resource.getClass());
      Logs.exhaust().info("Policy context not set for resource type: " + resource.getClass().getSimpleName());
    }
  }
}
