{
  Object response=null;
  LOG.debug("-> Waiting for response to event of type: " + this.getClass().getCanonicalName());
  do {
    try {
      response=this.responseQueue.poll(1,TimeUnit.SECONDS);
    }
 catch (    final InterruptedException e) {
    }
  }
 while ((response == null));
  if (response != null) {
    if (response instanceof EucalyptusMessage) {
      this.response=(EucalyptusMessage)response;
      return this.response;
    }
 else     if (response instanceof MappingHttpResponse) {
      MappingHttpResponse httpResponse=(MappingHttpResponse)response;
      if (httpResponse.getMessage() != null) {
        this.response=(EucalyptusMessage)httpResponse.getMessage();
      }
 else {
        this.exception=new EucalyptusClusterException(httpResponse.getMessageString());
      }
    }
 else     if (response instanceof Throwable) {
      this.exception=(Throwable)response;
      throw new EucalyptusClusterException("Exception in NIO request.",(Throwable)response);
    }
  }
  throw new EucalyptusClusterException("Failed to retrieve result of asynchronous operation." + LogUtil.dumpObject(response));
}
