{
  if (null != getRequestHeader("expect") && getStatusCode() != HttpStatus.SC_CONTINUE) {
    return false;
  }
  InputStream inputStream;
  if (outFile != null) {
    inputStream=new FileInputStream(outFile);
    GZIPOutputStream gzipOutStream=new GZIPOutputStream(conn.getRequestOutputStream());
    byte[] buffer=new byte[StorageProperties.TRANSFER_CHUNK_SIZE];
    int bytesRead;
    int numberProcessed=0;
    while ((bytesRead=inputStream.read(buffer)) > 0) {
      gzipOutStream.write(buffer,0,bytesRead);
      if (++numberProcessed >= callback.getUpdateThreshold()) {
        callback.run();
        numberProcessed=0;
      }
    }
    callback.finish();
    gzipOutStream.finish();
    inputStream.close();
  }
 else {
    return false;
  }
  return true;
}
