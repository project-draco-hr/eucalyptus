{
  EntityWrapper<VolumeInfo> db=new EntityWrapper<VolumeInfo>();
  VolumeInfo volumeInfo=new VolumeInfo();
  volumeInfo.setStatus(StorageProperties.Status.failed.toString());
  List<VolumeInfo> volumeInfos=db.query(volumeInfo);
  for (  VolumeInfo volInfo : volumeInfos) {
    String volumeId=volInfo.getVolumeId();
    LOG.warn("Cleaning failed volume " + volumeId);
    blockManager.cleanVolume(volumeId);
    try {
      volumeStorageManager.deleteObject("",volumeId);
    }
 catch (    Exception ex) {
      LOG.warn(ex);
    }
    db.delete(volInfo);
  }
  db.commit();
}
