{
  enableSnapshots=enableStorage=true;
  EntityWrapper<StorageMetaInfo> db=new EntityWrapper<StorageMetaInfo>();
  StorageMetaInfo metaInfo=new StorageMetaInfo();
  try {
    StorageMetaInfo storageMetaInfo=db.getUnique(metaInfo);
  }
 catch (  Exception ex) {
    metaInfo.setMaxTotalVolumeSize(0);
    metaInfo.setMaxTotalSnapshotSize(0);
    db.add(metaInfo);
  }
  db.commit();
  String walrusAddr=System.getProperty(StorageProperties.WALRUS_URL);
  if (walrusAddr == null) {
    LOG.warn("Walrus host addr not set");
  }
  blockManager=new LVM2Manager(StorageProperties.storageInterface);
  blockManager.initVolumeManager();
  try {
    blockManager.checkPreconditions();
  }
 catch (  Exception ex) {
    enableStorage=false;
    LOG.warn(ex);
    LOG.warn("Could not initialize block manager");
    return;
  }
  startup();
  checkWalrusConnection();
}
