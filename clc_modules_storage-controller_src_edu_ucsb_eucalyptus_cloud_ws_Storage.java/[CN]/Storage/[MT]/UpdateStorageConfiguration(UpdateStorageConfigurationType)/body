{
  UpdateStorageConfigurationResponseType reply=(UpdateStorageConfigurationResponseType)request.getReply();
  String storageRootDirectory=request.getStorageRootDirectory();
  String storageInterface=request.getStorageInterface();
  if (storageRootDirectory != null) {
    volumeStorageManager.setRootDirectory(storageRootDirectory);
    snapshotStorageManager.setRootDirectory(storageRootDirectory);
  }
  if (storageInterface != null) {
    blockManager.setStorageInterface(storageInterface);
  }
  if (!sharedMode)   checkWalrusConnection();
  try {
    blockManager.checkPreconditions();
    enableStorage=true;
  }
 catch (  Exception ex) {
    enableStorage=false;
    LOG.warn(ex);
  }
  return reply;
}
