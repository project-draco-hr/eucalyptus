{
  CreateVolumeResponseType reply=(CreateVolumeResponseType)request.getReply();
  String snapshotId=request.getSnapshotId();
  String userId=request.getUserId();
  String size=request.getSize();
  int sizeAsInt=0;
  if (size != null) {
    sizeAsInt=Integer.parseInt(size);
  }
  String volumeId="vol-" + Hashes.getRandom(8);
  edu.ucsb.eucalyptus.cloud.entities.VolumeInfo volumeInfo=new edu.ucsb.eucalyptus.cloud.entities.VolumeInfo(volumeId);
  volumeInfo.setUserName(userId);
  volumeInfo.setSize(sizeAsInt);
  volumeInfo.setStatus(StorageProperties.Status.creating.toString());
  volumeInfo.setAttachmentSet(new ArrayList<edu.ucsb.eucalyptus.cloud.entities.AttachedVolumeInfo>());
  volumeInfo.setCreateTime(new Date());
  volumeInfo.setTransferred(Boolean.FALSE);
  if (snapshotId != null)   volumeInfo.setSnapshotId(snapshotId);
  EntityWrapper<VolumeInfo> db=new EntityWrapper<VolumeInfo>();
  db.add(volumeInfo);
  db.commit();
  Volume volume=convertVolumeInfo(volumeInfo);
  VolumeCreator volumeCreator=new VolumeCreator(volumeId,snapshotId,sizeAsInt);
  volumeCreator.start();
  reply.setVolume(volume);
  return reply;
}
