{
  final LoginUserProfile user=clientFactory.getSessionData().getLoginUser();
  this.clientFactory.getBackendService().getUserToken(this.clientFactory.getLocalSession().getSession(),new AsyncCallback<String>(){
    @Override public void onFailure(    Throwable caught){
      clientFactory.getShellView().getFooterView().showStatus(StatusType.ERROR,"Failed to initiate credential download",FooterView.DEFAULT_STATUS_CLEAR_DELAY);
      clientFactory.getShellView().getLogView().log(LogType.ERROR,"Failed to initiate credential download: " + caught.getMessage());
    }
    @Override public void onSuccess(    final String code){
      if (Strings.isNullOrEmpty(code)) {
        clientFactory.getShellView().getFooterView().showStatus(StatusType.ERROR,"Failed to initiate credential download",FooterView.DEFAULT_STATUS_CLEAR_DELAY);
        clientFactory.getShellView().getLogView().log(LogType.ERROR,"Failed to initiate credential download: can't find user security code");
      }
 else {
        Window.open(GWT.getModuleBaseURL() + "getX509?" + "account="+ user.getAccountName()+ "&user="+ user.getUserName()+ "&code="+ code,"_self","");
      }
    }
  }
);
}
