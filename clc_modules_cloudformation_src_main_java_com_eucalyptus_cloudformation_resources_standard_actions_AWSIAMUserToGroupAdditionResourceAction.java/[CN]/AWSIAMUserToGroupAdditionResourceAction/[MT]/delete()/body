{
  if (info.getPhysicalResourceId() == null)   return;
  ServiceConfiguration configuration=Topology.lookup(Euare.class);
  boolean seenAllGroups=false;
  boolean foundGroup=false;
  String groupMarker=null;
  while (!seenAllGroups && !foundGroup) {
    ListGroupsType listGroupsType=new ListGroupsType();
    listGroupsType.setEffectiveUserId(info.getEffectiveUserId());
    if (groupMarker != null) {
      listGroupsType.setMarker(groupMarker);
    }
    ListGroupsResponseType listGroupsResponseType=AsyncRequests.<ListGroupsType,ListGroupsResponseType>sendSync(configuration,listGroupsType);
    if (listGroupsResponseType.getListGroupsResult().getIsTruncated() == Boolean.TRUE) {
      groupMarker=listGroupsResponseType.getListGroupsResult().getMarker();
    }
 else {
      seenAllGroups=true;
    }
    if (listGroupsResponseType.getListGroupsResult().getGroups() != null && listGroupsResponseType.getListGroupsResult().getGroups().getMemberList() != null) {
      for (      GroupType groupType : listGroupsResponseType.getListGroupsResult().getGroups().getMemberList()) {
        if (groupType.getGroupName().equals(info.getPhysicalResourceId())) {
          foundGroup=true;
          break;
        }
      }
    }
  }
  if (!foundGroup)   return;
  List<String> realUsersToRemoveFromGroup=Lists.newArrayList();
  Set<String> passedInUsers=properties.getUsers() == null ? new HashSet<String>() : Sets.newHashSet(properties.getUsers());
  boolean seenAllUsers=false;
  String userMarker=null;
  while (!seenAllUsers) {
    GetGroupType getGroupType=new GetGroupType();
    getGroupType.setGroupName(properties.getGroupName());
    getGroupType.setEffectiveUserId(info.getEffectiveUserId());
    if (userMarker != null) {
      getGroupType.setMarker(userMarker);
    }
    GetGroupResponseType getGroupResponseType=AsyncRequests.<GetGroupType,GetGroupResponseType>sendSync(configuration,getGroupType);
    if (getGroupResponseType.getGetGroupResult().getIsTruncated() == Boolean.TRUE) {
      userMarker=getGroupResponseType.getGetGroupResult().getMarker();
    }
 else {
      seenAllUsers=true;
    }
    if (getGroupResponseType.getGetGroupResult().getUsers() != null && getGroupResponseType.getGetGroupResult().getUsers().getMemberList() != null) {
      for (      UserType userType : getGroupResponseType.getGetGroupResult().getUsers().getMemberList()) {
        if (passedInUsers.contains(userType.getUserName())) {
          realUsersToRemoveFromGroup.add(userType.getUserName());
        }
      }
    }
  }
  for (  String user : realUsersToRemoveFromGroup) {
    RemoveUserFromGroupType removeUserFromGroupType=new RemoveUserFromGroupType();
    removeUserFromGroupType.setGroupName(properties.getGroupName());
    removeUserFromGroupType.setUserName(user);
    AsyncRequests.<RemoveUserFromGroupType,RemoveUserFromGroupResponseType>sendSync(configuration,removeUserFromGroupType);
  }
}
