{
  byte[] key;
  byte[] iv;
  PrivateKey pk=SystemCredentials.lookup(Eucalyptus.class).getPrivateKey();
  Cipher cipher=Ciphers.RSA_PKCS1.get();
  cipher.init(Cipher.DECRYPT_MODE,pk);
  String keyString=new String(cipher.doFinal(Hashes.hexToBytes(in.getKey())));
  key=Hashes.hexToBytes(keyString);
  String ivString=new String(cipher.doFinal(Hashes.hexToBytes(in.getIV())));
  iv=Hashes.hexToBytes(ivString);
  cipher.init(Cipher.ENCRYPT_MODE,keyToUse);
  keyString=Hashes.bytesToHex(cipher.doFinal(key));
  ivString=Hashes.bytesToHex(cipher.doFinal(iv));
  return new EncryptedKey(keyString,ivString);
}
