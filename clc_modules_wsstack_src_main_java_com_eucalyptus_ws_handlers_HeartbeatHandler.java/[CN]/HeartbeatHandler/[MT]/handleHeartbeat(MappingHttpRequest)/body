{
  HeartbeatType hb=(HeartbeatType)request.getMessage();
  List<String> registeredComponents=Lists.newArrayList();
  for (  HeartbeatComponentType component : hb.getComponents()) {
    if (!initializedComponents.contains(component.getComponent())) {
      System.exit(123);
    }
    registeredComponents.add(component.getComponent());
  }
  if (!registeredComponents.containsAll(initializedComponents)) {
    System.exit(123);
  }
  for (  ComponentType startedComponent : hb.getStarted()) {
    Component c=Component.valueOf(startedComponent.getComponent());
    try {
      if (Component.walrus.equals(c)) {
        ComponentConfiguration config=Configuration.getWalrusConfiguration(startedComponent.getName());
        Configuration.fireStartComponent(config);
      }
      if (Component.storage.equals(c)) {
        ComponentConfiguration config=Configuration.getStorageControllerConfiguration(startedComponent.getName());
        Configuration.fireStartComponent(config);
      }
    }
 catch (    Exception e1) {
      LOG.debug(e1,e1);
    }
  }
  for (  ComponentType stoppedComponent : hb.getStopped()) {
    URI uri=new URI(stoppedComponent.getUri());
    Component c=Component.valueOf(stoppedComponent.getComponent());
    try {
      if (Component.walrus.equals(c)) {
        Configuration.fireStopComponent(new RemoteConfiguration(c,uri));
      }
      if (Component.storage.equals(c)) {
        Configuration.fireStopComponent(new RemoteConfiguration(c,uri));
      }
    }
 catch (    Exception e1) {
      LOG.debug(e1,e1);
    }
  }
}
