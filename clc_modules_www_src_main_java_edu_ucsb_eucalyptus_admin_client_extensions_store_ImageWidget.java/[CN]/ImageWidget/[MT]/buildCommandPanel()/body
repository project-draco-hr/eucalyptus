{
  progressBar=new ProgressBarWidget(PROGRESS_BASE_URI,PROGRESS_DONE_URI,120,12);
  final Anchor howToRunAnchor=new Anchor("How to run?");
  final Anchor showErrorAnchor=new Anchor("Show error");
  final Anchor cancelAnchor=new Anchor("Cancel");
  Image upgradeIconImage=new Image(UPGRADE_ICON_URI);
  commandPanel.setCellSpacing(0);
  commandPanel.setCellPadding(0);
  spinnerImage.setVisible(false);
  commandPanel.setWidget(0,0,buttonPanel);
  commandPanel.setWidget(0,1,spinnerImage);
  commandPanel.setWidget(1,0,progressPanel);
  howToRunRowIndex=2;
  showErrorRowIndex=3;
  cancelRowIndex=4;
  upgradeIconRowIndex=5;
  commandPanel.setWidget(howToRunRowIndex,0,howToRunAnchor);
  commandPanel.setWidget(showErrorRowIndex,0,showErrorAnchor);
  commandPanel.setWidget(cancelRowIndex,0,cancelAnchor);
  commandPanel.setWidget(upgradeIconRowIndex,0,upgradeIconImage);
  progressPanel.add(progressBar);
  commandPanel.setStyleName("istore-command-panel");
  buttonPanel.setStyleName("istore-button-panel");
  spinnerImage.setStyleName("istore-spinner");
  progressPanel.setStyleName("istore-progress-panel");
  howToRunAnchor.setStyleName("istore-how-to-run-anchor");
  showErrorAnchor.setStyleName("istore-show-error-anchor");
  cancelAnchor.setStyleName("istore-cancel-anchor");
  upgradeIconImage.setStyleName("istore-upgrade-icon");
  commandPanel.getRowFormatter().setStyleName(howToRunRowIndex,"istore-how-to-run-panel");
  commandPanel.getRowFormatter().setStyleName(showErrorRowIndex,"istore-show-error-panel");
  commandPanel.getRowFormatter().setStyleName(cancelRowIndex,"istore-cancel-panel");
  commandPanel.getRowFormatter().setStyleName(upgradeIconRowIndex,"istore-upgrade-icon-panel");
  howToRunAnchor.addClickHandler(new ClickHandler(){
    public void onClick(    ClickEvent event){
      event.preventDefault();
      ImageInfo imageInfo=ImageWidget.this.imageInfo;
      ImageState imageState=ImageWidget.this.imageState;
      HowToRunDialog dialog=new HowToRunDialog(imageInfo,imageState);
      dialog.center();
    }
  }
);
  showErrorAnchor.addClickHandler(new ClickHandler(){
    public void onClick(    ClickEvent event){
      event.preventDefault();
      ImageInfo imageInfo=ImageWidget.this.imageInfo;
      ImageState imageState=ImageWidget.this.imageState;
      ImageErrorDialog dialog=new ImageErrorDialog(imageInfo,imageState);
      dialog.center();
      dialog.addClearErrorHandler(new ClearErrorHandler<ImageState>(){
        public void onClearError(        ClearErrorEvent<ImageState> event){
          ImageWidget.this.fireEvent(event);
        }
      }
);
    }
  }
);
  cancelAnchor.addClickHandler(new ClickHandler(){
    public void onClick(    ClickEvent event){
      setInProgress(true);
      ImageWidget.this.fireEvent(new CancelEvent<ImageWidget>(ImageWidget.this));
      event.preventDefault();
    }
  }
);
  return commandPanel;
}
