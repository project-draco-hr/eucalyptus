{
  AddUserResponseType reply=request.getReply();
  reply.set_return(false);
  String userName=request.getUserName();
  String email=request.getEmail();
  boolean admin=request.getAdmin();
  try {
    User u=null;
    if (email == null) {
      u=Users.addUser(userName,admin,true);
    }
 else {
      u=Users.addUser(userName,admin,false);
    }
  }
 catch (  UserExistsException e1) {
    throw new EucalyptusCloudException("User already exists: " + userName);
  }
  return reply;
}
