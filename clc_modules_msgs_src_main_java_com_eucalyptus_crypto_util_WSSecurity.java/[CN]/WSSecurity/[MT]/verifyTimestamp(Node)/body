{
  TimestampProcessor tsProc=new TimestampProcessor();
  LOG.debug("Timestamp: " + node);
  Vector retResults=new Vector();
  tsProc.handleToken((Element)node,null,null,null,null,retResults,WSSConfig.getDefaultWSConfig());
  Timestamp ts=(Timestamp)((WSSecurityEngineResult)retResults.get(0)).get(WSSecurityEngineResult.TAG_TIMESTAMP);
  LOG.debug("timestamp: " + ts);
  Date expires=ts.getExpires().getTime();
  if (!SecurityContext.validateTimestampPeriod(expires))   throw new WSSecurityException("Timestamp expiration is too far in the future");
}
