{
  TimestampProcessor tsProc=new TimestampProcessor();
  LOG.debug("Timestamp: " + node);
  Vector retResults=new Vector();
  tsProc.handleToken((Element)node,null,null,null,null,retResults,WSSConfig.getDefaultWSConfig());
  Timestamp ts=(Timestamp)((WSSecurityEngineResult)retResults.get(0)).get(WSSecurityEngineResult.TAG_TIMESTAMP);
  LOG.debug("timestamp: " + ts);
  Date expires=ts.getExpires().getTime();
  if (!SecurityContext.validateTimestampPeriod(expires)) {
    LOG.warn("[security] ]Timestamp expiration is further in the future than replay cache expiration");
  }
  Calendar now=Calendar.getInstance();
  now.add(Calendar.SECOND,20);
  if (now.before(ts.getCreated())) {
    throw new WSSecurityException("Timestamp was created in the future: make sure you clocks are synchronized");
  }
}
