{
  AssignAddressResponseType reply=null;
  try {
    VmInstance vm=VmInstances.getInstance().lookup(msg.getInstanceId());
    VmState vmState=vm.getState();
    if (VmState.RUNNING.equals(vmState) || VmState.PENDING.equals(vmState)) {
      reply=(AssignAddressResponseType)clusterClient.send(msg);
      LOG.debug("Assign [" + msg.getSource() + "]  => ["+ msg.getDestination()+ "]");
      this.parent.getNetworkConfig().setIgnoredPublicIp(msg.getSource());
    }
 else {
      LOG.warn("Ignoring assignment to a vm which is not running: " + msg);
    }
  }
 catch (  Exception e) {
    LOG.debug(e,e);
  }
}
