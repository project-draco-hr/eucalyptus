{
  StorageControllerConfiguration config=this.newInstance(partition,name,host,port);
  try {
    Partition part=Partitions.lookup(config);
    ServiceConfigurations.store(config);
    part.syncKeysToDisk();
  }
 catch (  ServiceRegistrationException ex) {
    Partitions.maybeRemove(config.getPartition());
    throw ex;
  }
catch (  Exception ex) {
    Partitions.maybeRemove(config.getPartition());
    LOG.error(ex,ex);
    throw new ServiceRegistrationException(String.format("Unexpected error caused cluster registration to fail for: partition=%s name=%s host=%s port=%d",partition,name,host,port),ex);
  }
  return config;
}
