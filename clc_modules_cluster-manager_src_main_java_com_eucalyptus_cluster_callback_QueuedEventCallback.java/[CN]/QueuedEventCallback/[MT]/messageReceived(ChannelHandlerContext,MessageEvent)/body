{
  if (e.getMessage() instanceof MappingHttpResponse) {
    MappingHttpResponse response=(MappingHttpResponse)e.getMessage();
    try {
      RTYPE msg=(RTYPE)response.getMessage();
      LOG.trace(msg.toSimpleString());
      try {
        if (!msg.get_return()) {
          Exception ex=new EucalyptusClusterException(LogUtil.dumpObject(msg));
          this.fail(ex);
          this.failCallback.failure(this,ex);
          this.queueResponse(ex);
        }
 else {
          this.verify(msg);
          this.successCallback.apply(msg);
          this.queueResponse(msg);
        }
      }
 catch (      Throwable e1) {
        LOG.error(e1,e1);
        throw e1;
      }
    }
 catch (    Throwable e1) {
      try {
        this.fail(e1);
      }
 catch (      Throwable e3) {
        LOG.error(e3,e3);
      }
 finally {
        try {
          this.failCallback.failure(this,e1);
        }
 catch (        Throwable e2) {
          LOG.debug(e2,e2);
        }
      }
      this.queueResponse(e1);
      e.getFuture().addListener(ChannelFutureListener.CLOSE);
      if (e1 instanceof EucalyptusClusterException) {
        throw (EucalyptusClusterException)e1;
      }
 else {
        throw new EucalyptusClusterException("Error in contacting the Cluster Controller: " + e1.getMessage(),e1);
      }
    }
  }
  ctx.getChannel().close();
}
