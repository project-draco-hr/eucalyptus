{
  EntityWrapper<ClusterCredentials> credDb=Credentials.getEntityWrapper();
  try {
    ClusterCredentials clusterCredentials=credDb.getUnique(new ClusterCredentials(clusterName));
    credDb.recast(X509Cert.class).delete(clusterCredentials.getClusterCertificate());
    credDb.recast(X509Cert.class).delete(clusterCredentials.getNodeCertificate());
    credDb.delete(clusterCredentials);
    credDb.commit();
  }
 catch (  Exception e) {
    Configuration.LOG.error(e,e);
    credDb.rollback();
  }
  try {
    String directory=SubDirectory.KEYS.toString() + File.separator + clusterName;
    File keyDir=new File(directory);
    for (    File f : keyDir.listFiles()) {
      if (!f.delete()) {
        Configuration.LOG.warn("Failed to delete key file: " + f.getAbsolutePath());
      }
    }
    if (!keyDir.delete()) {
      Configuration.LOG.warn("Failed to delete key directory: " + keyDir.getAbsolutePath());
    }
  }
 catch (  Exception e) {
  }
}
