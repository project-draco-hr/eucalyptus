{
  checkCipherState();
  if (input == null || inputOffset < 0 || inputLen > (input.length - inputOffset) || inputLen < 0 || outputOffset < 0) {
    throw new IllegalArgumentException("Bad arguments");
  }
  chooseFirstProvider();
  if (inputLen == 0) {
    return 0;
  }
  return spi.engineUpdate(input,inputOffset,inputLen,output,outputOffset);
}
