{
  checkCipherState();
  if (input == null || inputOffset < 0 || inputLen > (input.length - inputOffset) || inputLen < 0) {
    throw new IllegalArgumentException("Bad arguments");
  }
  chooseFirstProvider();
  if (inputLen == 0) {
    return null;
  }
  return spi.engineUpdate(input,inputOffset,inputLen);
}
