{
  try {
    Type reportType=Type.valueOf(Param.type.get());
    try {
      Boolean doFlush=this.doFlush();
      final JRExporter exporter=reportType.setup(req,res,Param.name.get());
      ReportCache reportCache=getReportManager(Param.name.get(req),doFlush);
      JasperPrint jasperPrint=reportCache.getJasperPrint();
      exporter.setParameter(JRExporterParameter.JASPER_PRINT,jasperPrint);
      exporter.exportReport();
    }
 catch (    Throwable ex) {
      LOG.error(ex,ex);
      res.setContentType("text/plain");
      LOG.error("Could not create the report stream " + ex.getMessage() + " "+ ex.getLocalizedMessage());
      ex.printStackTrace(res.getWriter());
    }
 finally {
      reportType.close(res);
    }
  }
 catch (  NoSuchFieldException e) {
    LOG.debug(e,e);
    this.hasError("Failed to generate report: " + e.getMessage(),res);
  }
catch (  IOException e) {
    LOG.debug(e,e);
    this.hasError("Failed to generate report: " + e.getMessage(),res);
  }
}
