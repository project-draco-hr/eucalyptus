{
  final TransitionAction<Component> loadTransition=new TransitionAction<Component>(){
    @Override public void leave(    Component parent,    Completion transitionCallback){
      ComponentState.this.details.clear();
      try {
        parent.getBootstrapper().load();
        transitionCallback.fire();
      }
 catch (      Throwable ex) {
        LOG.error("Transition failed on " + parent.getName() + " due to "+ ex.toString(),ex);
        ComponentState.this.details.add(ex.toString());
        transitionCallback.fireException(ex);
      }
    }
  }
;
  final TransitionAction<Component> startTransition=new TransitionAction<Component>(){
    @Override public void leave(    Component parent,    Completion transitionCallback){
      ComponentState.this.details.clear();
      try {
        parent.getBootstrapper().start();
        if (parent.getBuilder() != null && parent.getLocalService() != null) {
          parent.getBuilder().fireStart(parent.getLocalService().getServiceConfiguration());
        }
        transitionCallback.fire();
      }
 catch (      Throwable ex) {
        LOG.error("Transition failed on " + parent.getName() + " due to "+ ex.toString(),ex);
        ComponentState.this.details.add(ex.toString());
        transitionCallback.fireException(ex);
      }
    }
  }
;
  final TransitionAction<Component> enableTransition=new TransitionAction<Component>(){
    @Override public void leave(    Component parent,    Completion transitionCallback){
      if (!Bootstrap.isFinished()) {
        transitionCallback.fireException(new Exception("Bootstrap has not yet completed."));
      }
      ComponentState.this.details.clear();
      try {
        if (State.NOTREADY.equals(ComponentState.this.stateMachine.getState())) {
          parent.getBootstrapper().check();
          if (parent.getBuilder() != null && parent.getLocalService() != null) {
            parent.getBuilder().fireCheck(parent.getLocalService().getServiceConfiguration());
          }
        }
        parent.getBootstrapper().enable();
        if (parent.getBuilder() != null && parent.getLocalService() != null) {
          parent.getBuilder().fireEnable(parent.getLocalService().getServiceConfiguration());
        }
        transitionCallback.fire();
      }
 catch (      Throwable ex) {
        LOG.error("Transition failed on " + parent.getName() + " due to "+ ex.toString(),ex);
        ComponentState.this.details.add(ex.toString());
        transitionCallback.fireException(ex);
      }
    }
  }
;
  final TransitionAction<Component> disableTransition=new TransitionAction<Component>(){
    @Override public void leave(    Component parent,    Completion transitionCallback){
      ComponentState.this.details.clear();
      try {
        parent.getBootstrapper().disable();
        parent.getBuilder().fireDisable(parent.getLocalService().getServiceConfiguration());
        transitionCallback.fire();
      }
 catch (      Throwable ex) {
        LOG.error("Transition failed on " + parent.getName() + " due to "+ ex.toString(),ex);
        ComponentState.this.details.add(ex.toString());
        transitionCallback.fireException(ex);
      }
    }
  }
;
  final TransitionAction<Component> stopTransition=new TransitionAction<Component>(){
    @Override public void leave(    Component parent,    Completion transitionCallback){
      ComponentState.this.details.clear();
      try {
        parent.getBootstrapper().stop();
        if (parent.getBuilder() != null && parent.getLocalService() != null) {
          parent.getBuilder().fireStop(parent.getLocalService().getServiceConfiguration());
        }
        transitionCallback.fire();
      }
 catch (      Throwable ex) {
        LOG.error("Transition failed on " + parent.getName() + " due to "+ ex.toString(),ex);
        ComponentState.this.details.add(ex.toString());
        transitionCallback.fireException(ex);
      }
    }
  }
;
  final TransitionAction<Component> checkTransition=new TransitionAction<Component>(){
    @Override public void leave(    Component parent,    Completion transitionCallback){
      ComponentState.this.details.clear();
      try {
        if (State.LOADED.ordinal() < ComponentState.this.stateMachine.getState().ordinal()) {
          parent.getBootstrapper().check();
          if (parent.getBuilder() != null && parent.getLocalService() != null) {
            parent.getBuilder().fireCheck(parent.getLocalService().getServiceConfiguration());
          }
        }
        transitionCallback.fire();
      }
 catch (      Throwable ex) {
        LOG.error("Transition failed on " + parent.getName() + " due to "+ ex.toString(),ex);
        ComponentState.this.details.add(ex.toString());
        if (State.ENABLED.equals(ComponentState.this.stateMachine.getState())) {
          try {
            parent.getBootstrapper().disable();
            if (parent.getBuilder() != null && parent.getLocalService() != null) {
              parent.getBuilder().fireDisable(parent.getLocalService().getServiceConfiguration());
            }
          }
 catch (          ServiceRegistrationException ex1) {
            LOG.error(ex1,ex1);
          }
        }
        transitionCallback.fireException(ex);
      }
    }
  }
;
  final TransitionAction<Component> destroyTransition=new TransitionAction<Component>(){
    @Override public void leave(    Component parent,    Completion transitionCallback){
      ComponentState.this.details.clear();
      try {
        parent.getBootstrapper().destroy();
        transitionCallback.fire();
      }
 catch (      Throwable ex) {
        LOG.error("Transition failed on " + parent.getName() + " due to "+ ex.toString(),ex);
        ComponentState.this.details.add(ex.toString());
        transitionCallback.fireException(ex);
      }
    }
  }
;
  final TransitionListener<Component> addPipelines=Transitions.createListener(new Predicate<Component>(){
    @Override public boolean apply(    Component arg0){
      PipelineRegistry.getInstance().enable(arg0.getIdentity());
      return true;
    }
  }
);
  final TransitionListener<Component> removePipelines=Transitions.createListener(new Predicate<Component>(){
    @Override public boolean apply(    Component arg0){
      PipelineRegistry.getInstance().disable(arg0.getIdentity());
      return true;
    }
  }
);
  return new StateMachineBuilder<Component,State,Transition>(this.parent,State.PRIMORDIAL){
{
      on(Transition.INITIALIZING).from(State.PRIMORDIAL).to(State.INITIALIZED).error(State.BROKEN).noop();
      on(Transition.LOADING).from(State.INITIALIZED).to(State.LOADED).error(State.BROKEN).run(loadTransition);
      on(Transition.STARTING).from(State.LOADED).to(State.NOTREADY).error(State.BROKEN).run(startTransition);
      on(Transition.ENABLING).from(State.DISABLED).to(State.ENABLED).error(State.NOTREADY).add(addPipelines).run(enableTransition);
      on(Transition.DISABLING).from(State.ENABLED).to(State.DISABLED).error(State.NOTREADY).add(removePipelines).run(disableTransition);
      on(Transition.STOPPING).from(State.DISABLED).to(State.STOPPED).error(State.NOTREADY).run(stopTransition);
      on(Transition.DESTROYING).from(State.STOPPED).to(State.LOADED).error(State.BROKEN).run(destroyTransition);
      on(Transition.READY_CHECK).from(State.NOTREADY).to(State.DISABLED).error(State.NOTREADY).run(checkTransition);
      on(Transition.DISABLED_CHECK).from(State.DISABLED).to(State.DISABLED).error(State.NOTREADY).run(checkTransition);
      on(Transition.ENABLED_CHECK).from(State.ENABLED).to(State.ENABLED).error(State.NOTREADY).run(checkTransition);
    }
  }
.newAtomicState();
}
