{
  PostObjectResponseType reply=(PostObjectResponseType)request.getReply();
  String bucketName=request.getBucket();
  String key=request.getKey();
  PutObjectType putObject=new PutObjectType();
  putObject.setUserId(request.getUserId());
  putObject.setBucket(bucketName);
  putObject.setKey(key);
  putObject.setRandomKey(request.getRandomKey());
  putObject.setAccessControlList(request.getAccessControlList());
  putObject.setContentType(request.getContentType());
  putObject.setContentLength(request.getContentLength());
  putObject.setAccessKeyID(request.getAccessKeyID());
  putObject.setEffectiveUserId(request.getEffectiveUserId());
  putObject.setCredential(request.getCredential());
  putObject.setIsCompressed(request.getIsCompressed());
  putObject.setMetaData(request.getMetaData());
  putObject.setStorageClass(request.getStorageClass());
  PutObjectResponseType putObjectResponse=putObject(putObject);
  String etag=putObjectResponse.getEtag();
  reply.setEtag(etag);
  reply.setLastModified(putObjectResponse.getLastModified());
  reply.set_return(putObjectResponse.get_return());
  reply.setMetaData(putObjectResponse.getMetaData());
  reply.setErrorCode(putObjectResponse.getErrorCode());
  reply.setStatusMessage(putObjectResponse.getStatusMessage());
  reply.setLogData(putObjectResponse.getLogData());
  String successActionRedirect=request.getSuccessActionRedirect();
  if (successActionRedirect != null) {
    try {
      java.net.URI addrUri=new URL(successActionRedirect).toURI();
      InetAddress.getByName(addrUri.getHost());
    }
 catch (    Exception ex) {
      LOG.warn(ex);
    }
    String paramString="bucket=" + bucketName + "&key="+ key+ "&etag=quot;"+ etag+ "quot;";
    reply.setRedirectUrl(successActionRedirect + "?" + paramString);
  }
 else {
    Integer successActionStatus=request.getSuccessActionStatus();
    if (successActionStatus != null) {
      if ((successActionStatus == 200) || (successActionStatus == 201)) {
        reply.setSuccessCode(successActionStatus);
        if (successActionStatus == 200) {
          return reply;
        }
 else {
          reply.setBucket(bucketName);
          reply.setKey(key);
          reply.setLocation(SystemConfiguration.getWalrusUrl() + "/" + bucketName+ "/"+ key);
        }
      }
 else {
        reply.setSuccessCode(204);
        return reply;
      }
    }
  }
  return reply;
}
