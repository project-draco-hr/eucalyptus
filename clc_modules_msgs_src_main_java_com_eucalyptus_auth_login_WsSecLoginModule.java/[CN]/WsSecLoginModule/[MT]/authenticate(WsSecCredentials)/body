{
  HoldMe.canHas.lock();
  try {
    final Element secNode=WSSecurity.getSecurityElement(wrappedCredentials.getLoginData());
    final XMLSignature sig=WSSecurity.getXMLSignature(secNode);
    SecurityContext.enqueueSignature(sig.getTextFromTextChild());
    final X509Certificate cert=WSSecurity.verifySignature(secNode,sig);
    final User user=Users.lookupCertificate(cert);
    super.setCredential(cert);
    super.setPrincipal(user);
    super.getGroups().addAll(Groups.lookupGroups(super.getPrincipal()));
  }
  finally {
    HoldMe.canHas.unlock();
  }
  return true;
}
