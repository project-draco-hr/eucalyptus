{
  final Function<Void,R> workFunction=new Function<Void,R>(){
    @Override public R apply(    final Void nothing){
      try {
        return work.doWork();
      }
 catch (      AutoScalingMetadataException e) {
        throw Exceptions.toUndeclared(e);
      }
    }
  }
;
  try {
    return Entities.asTransaction(entityType,workFunction).apply(null);
  }
 catch (  Exception e) {
    final AutoScalingMetadataException cause=Exceptions.findCause(e,AutoScalingMetadataException.class);
    if (cause != null) {
      throw cause;
    }
    throw new AutoScalingMetadataException("Transaction failed",e);
  }
}
