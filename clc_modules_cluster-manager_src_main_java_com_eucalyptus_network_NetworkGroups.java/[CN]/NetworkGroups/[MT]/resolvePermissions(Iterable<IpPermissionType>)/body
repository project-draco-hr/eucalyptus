{
  for (  final IpPermissionType ipPermission : permissions) {
    if (ipPermission.getGroups() != null)     for (    final UserIdGroupPairType groupInfo : ipPermission.getGroups()) {
      if (!Strings.isNullOrEmpty(groupInfo.getSourceGroupId())) {
        final NetworkGroup networkGroup=NetworkGroups.lookupByGroupId(groupInfo.getSourceGroupId());
        groupInfo.setSourceUserId(networkGroup.getOwnerAccountNumber());
        groupInfo.setSourceGroupName(networkGroup.getDisplayName());
      }
 else       if (Strings.isNullOrEmpty(groupInfo.getSourceUserId()) || Strings.isNullOrEmpty(groupInfo.getSourceGroupName())) {
        throw new MetadataException("Group ID or User ID/Group Name required.");
      }
 else {
        final NetworkGroup networkGroup=NetworkGroups.lookup(AccountFullName.getInstance(groupInfo.getSourceUserId()),groupInfo.getSourceGroupName());
        groupInfo.setSourceGroupId(networkGroup.getGroupId());
      }
    }
  }
}
