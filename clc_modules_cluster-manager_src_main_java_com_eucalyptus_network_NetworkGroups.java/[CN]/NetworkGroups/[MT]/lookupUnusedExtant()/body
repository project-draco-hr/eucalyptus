{
  try (final TransactionResource db=Entities.transactionFor(NetworkGroup.class)){
    return Entities.query(NetworkGroup.withOwner(null),true,Restrictions.and(Restrictions.lt("extantNetwork.lastUpdateTimestamp",new Date(System.currentTimeMillis() - TimeUnit.MINUTES.toMillis(1))),Restrictions.isNotNull("extantNetwork.tag"),Restrictions.isEmpty("extantNetwork.indexes")),ImmutableMap.of("extantNetwork","extantNetwork"));
  }
 catch (  final Exception ex) {
    Logs.exhaust().error(ex,ex);
    throw new NoSuchMetadataException("Error looking up extant groups",ex);
  }
}
