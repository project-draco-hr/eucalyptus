{
  checkCipherState();
  if ((output == null) || (outputOffset < 0)) {
    throw new IllegalArgumentException("Bad arguments");
  }
  chooseFirstProvider();
  return spi.engineDoFinal(null,0,0,output,outputOffset);
}
