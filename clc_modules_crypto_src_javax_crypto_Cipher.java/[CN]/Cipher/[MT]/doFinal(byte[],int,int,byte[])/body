{
  checkCipherState();
  if (input == null || inputOffset < 0 || inputLen > (input.length - inputOffset) || inputLen < 0) {
    throw new IllegalArgumentException("Bad arguments");
  }
  chooseFirstProvider();
  return spi.engineDoFinal(input,inputOffset,inputLen,output,0);
}
