{
  checkCipherState();
  if (input == null) {
    throw new IllegalArgumentException("Null input buffer");
  }
  chooseFirstProvider();
  return spi.engineDoFinal(input,0,input.length);
}
