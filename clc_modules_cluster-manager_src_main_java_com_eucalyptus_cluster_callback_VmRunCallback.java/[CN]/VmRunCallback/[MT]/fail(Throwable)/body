{
  LOG.debug(LogUtil.header("Failing run instances because of: " + e.getMessage()),e);
  LOG.debug(LogUtil.subheader(this.getRequest().toString()));
  for (  String addr : this.token.getAddresses()) {
    try {
      LOG.debug("-> Release addresses from failed vm run allocation: " + addr);
      Addresses.getInstance().lookup(addr).release();
    }
 catch (    NoSuchElementException e1) {
      LOG.debug("-> Failed to release addresses from failed vm run allocation: " + addr);
    }
  }
  LOG.debug("-> Release network index allocation.");
  if (this.token.getPrimaryNetwork() != null) {
    try {
      NetworkToken net=this.token.getPrimaryNetwork();
      Network network=Networks.getInstance().lookup(net.getName());
      for (      Integer index : this.token.getPrimaryNetwork().getIndexes()) {
        network.returnNetworkIndex(index);
      }
    }
 catch (    Throwable e2) {
      LOG.debug(e2,e2);
    }
  }
  LOG.debug("-> Release resource tokens for unused resources.");
  try {
    Clusters.getInstance().lookup(token.getCluster()).getNodeState().releaseToken(token);
  }
 catch (  Throwable e2) {
    LOG.debug(e2,e2);
  }
}
