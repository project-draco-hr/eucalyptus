{
  Preconditions.checkNotNull(runnable,"Runnable was null.");
  Preconditions.checkNotNull(executor,"Executor was null.");
  boolean executeImmediate=false;
synchronized (runnables) {
    if (!executed) {
      EventRecord.here(runnable.getClass(),EventType.FUTURE,"add(" + runnable.toString() + ")").debug();
      runnables.add(new RunnableExecutorPair(runnable,executor));
    }
 else {
      executeImmediate=true;
    }
  }
  if (executeImmediate) {
    executor.execute(runnable);
  }
}
