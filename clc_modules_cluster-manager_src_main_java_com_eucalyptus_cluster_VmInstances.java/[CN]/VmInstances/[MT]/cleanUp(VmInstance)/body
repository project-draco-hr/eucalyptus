{
  try {
    String networkFqName=!vm.getNetworks().isEmpty() ? vm.getOwnerId() + "-" + vm.getNetworkNames().get(0) : null;
    Cluster cluster=Clusters.getInstance().lookup(vm.getPlacement());
    int networkIndex=vm.getNetworkIndex();
    Address address=null;
    QueuedEventCallback cb=new TerminateCallback(vm.getInstanceId());
    if (Clusters.getInstance().hasNetworking()) {
      try {
        address=Addresses.getInstance().lookup(vm.getPublicAddress());
      }
 catch (      NoSuchElementException e) {
      }
catch (      Throwable e1) {
        LOG.debug(e1,e1);
      }
    }
    cb.then(VmInstances.getCleanUpCallback(address,vm,networkIndex,networkFqName,cluster));
    cb.dispatch(cluster);
  }
 catch (  Throwable e) {
    LOG.error(e,e);
  }
}
