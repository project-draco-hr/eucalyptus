{
  EntityWrapper<InstanceAttributes> entityWrapper=EntityWrapper.get(InstanceAttributes.class);
  try {
    @SuppressWarnings("rawtypes") Iterator iter=entityWrapper.createQuery("from S3UsageSnapshot as sus" + " where sus.key.timestampMs > ?" + " and sus.key.timestampMs < ?"+ " order by sus.key.timestampMs").setLong(0,period.getBeginningMs()).setLong(1,period.getEndingMs()).iterate();
    return new S3UsageSnapshotIterator(iter);
  }
 catch (  Exception ex) {
    log.error(ex);
    throw new RuntimeException(ex);
  }
}
