{
  if (event.getMessage() instanceof MappingHttpResponse) {
    MappingHttpResponse httpResponse=(MappingHttpResponse)event.getMessage();
    if (httpResponse.getMessage() instanceof WalrusResponseType) {
      WalrusResponseType response=(WalrusResponseType)httpResponse.getMessage();
      BucketLogData logData=response.getLogData();
      if (logData != null) {
        logData.setBytesSent(httpResponse.getContent().readableBytes());
        long startTime=logData.getTotalTime();
        logData.setTotalTime(System.currentTimeMillis() - startTime);
        HttpResponseStatus status=httpResponse.getStatus();
        if (status != null)         logData.setStatus(Integer.toString(status.getCode()));
        WalrusBucketLogger.getInstance().addLogEntry(logData);
        response.setLogData(null);
      }
    }
  }
}
