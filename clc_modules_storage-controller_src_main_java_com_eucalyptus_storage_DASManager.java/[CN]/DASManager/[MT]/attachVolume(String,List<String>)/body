{
  LVMVolumeInfo lvmVolumeInfo=null;
{
    final VolumeEntityWrapperManager volumeManager=new VolumeEntityWrapperManager();
    try {
      lvmVolumeInfo=volumeManager.getVolumeInfo(volumeId);
    }
  finally {
      volumeManager.finish();
    }
  }
  if (lvmVolumeInfo != null) {
    VolumeOpMonitor monitor=getMonitor(volumeId);
synchronized (monitor) {
      final VolumeEntityWrapperManager volumeManager=new VolumeEntityWrapperManager();
      try {
        lvmVolumeInfo=volumeManager.getVolumeInfo(volumeId);
        String lvName=lvmVolumeInfo.getLvName();
        String absoluteLVName=lvmRootDirectory + PATH_SEPARATOR + volumeGroup+ PATH_SEPARATOR+ lvName;
        enableLogicalVolume(absoluteLVName);
        try {
          volumeManager.exportVolume(lvmVolumeInfo,volumeGroup,lvName);
          lvmVolumeInfo.setCleanup(false);
        }
 catch (        EucalyptusCloudException ex) {
          LOG.error("Unable to export volume " + volumeId,ex);
          throw ex;
        }
      }
 catch (      Exception ex) {
        LOG.error("Failed to attach volume " + volumeId,ex);
        throw new EucalyptusCloudException("Failed to attach volume " + volumeId,ex);
      }
 finally {
        try {
          volumeManager.finish();
        }
 catch (        Exception e) {
          LOG.error("Unable to commit the database transaction after an attempt to attach volume " + volumeId,e);
        }
      }
    }
  }
  return getVolumeProperty(volumeId);
}
