{
  try (TransactionResource db=Entities.transactionFor(StackUpdateRollbackInfoEntity.class)){
    Criteria criteria=Entities.createCriteria(StackUpdateRollbackInfoEntity.class).add(Restrictions.eq("accountId",accountId)).add(Restrictions.eq("stackId",stackId));
    List<StackUpdateRollbackInfoEntity> results=criteria.list();
    if (results != null) {
      for (      StackUpdateRollbackInfoEntity entity : results) {
        Entities.delete(entity);
      }
    }
    Criteria criteria2=Entities.createCriteria(StackUpdateRollbackInfoEntity.Resource.class).add(Restrictions.eq("accountId",accountId)).add(Restrictions.eq("stackId",stackId));
    List<StackUpdateRollbackInfoEntity.Resource> results2=criteria2.list();
    if (results != null) {
      for (      StackUpdateRollbackInfoEntity.Resource resource : results2) {
        Entities.delete(resource);
      }
    }
    db.commit();
  }
 }
