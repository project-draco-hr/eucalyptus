{
  String[] parsed=new String[2];
  Matcher matcher=PolicySpec.ARN_PATTERN.matcher(resource);
  if (!matcher.matches()) {
    throw new JSONException("'" + resource + "' is not a valid ARN");
  }
  if (matcher.group(PolicySpec.ARN_PATTERNGROUP_IAM) != null) {
    parsed[0]=matcher.group(PolicySpec.ARN_PATTERNGROUP_IAM) + ":" + matcher.group(PolicySpec.ARN_PATTERNGROUP_IAM_USERGROUP).toLowerCase();
    parsed[1]=matcher.group(PolicySpec.ARN_PATTERNGROUP_IAM_ID);
  }
 else   if (matcher.group(PolicySpec.ARN_PATTERNGROUP_EC2) != null) {
    String type=matcher.group(PolicySpec.ARN_PATTERNGROUP_EC2_TYPE).toLowerCase();
    parsed[0]=matcher.group(PolicySpec.ARN_PATTERNGROUP_EC2) + ":" + type;
    if (!PolicySpec.EC2_RESOURCES.contains(type)) {
      throw new JSONException("EC2 type '" + type + "' is not supported");
    }
    parsed[1]=matcher.group(PolicySpec.ARN_PATTERNGROUP_EC2_ID).toLowerCase();
  }
 else   if (matcher.group(PolicySpec.ARN_PATTERNGROUP_S3) != null) {
    parsed[0]=matcher.group(PolicySpec.ARN_PATTERNGROUP_S3) + ":";
    if (matcher.group(PolicySpec.ARN_PATTERNGROUP_S3_OBJECT) != null) {
      parsed[0]+=PolicySpec.S3_RESOURCE_OBJECT;
      parsed[1]=matcher.group(PolicySpec.ARN_PATTERNGROUP_S3_BUCKET) + matcher.group(PolicySpec.ARN_PATTERNGROUP_S3_OBJECT);
    }
 else {
      parsed[0]+=PolicySpec.S3_RESOURCE_BUCKET;
      parsed[1]=matcher.group(PolicySpec.ARN_PATTERNGROUP_S3_BUCKET);
    }
  }
 else {
    parsed[0]=PolicySpec.ALL_RESOURCE;
    parsed[1]=PolicySpec.ALL_RESOURCE;
  }
  return parsed;
}
