{
  Matcher matcher=PolicySpec.ACTION_PATTERN.matcher(action);
  if (!matcher.matches()) {
    throw new JSONException("'" + action + "' is not a valid action");
  }
  if (PolicySpec.ALL_ACTION.equals(action)) {
    return PolicySpec.ALL_ACTION;
  }
  String prefix=matcher.group(1);
  String pattern=matcher.group(2);
  for (  String defined : PolicySpec.VENDOR_ACTIONS.get(prefix)) {
    if (Pattern.matches(PatternUtils.toJavaPattern(pattern),defined)) {
      return prefix;
    }
  }
  throw new JSONException("'" + pattern + "' does not match any defined action");
}
