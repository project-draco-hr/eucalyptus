{
  if (key == null) {
    throw new JSONException("Empty key name");
  }
  Class<? extends Key> keyClass=Keys.KEY_MAP.get(key);
  if (keyClass == null) {
    throw new JSONException("Condition key '" + key + "' is not supported");
  }
  if (isQuota && !QuotaKey.class.isAssignableFrom(keyClass)) {
    throw new JSONException("Quota statement can only use quota keys.'" + key + "' is invalid.");
  }
  Key keyObj=Keys.getKeyInstance(keyClass);
  keyObj.validateConditionType(typeClass);
  if (values.size() < 1) {
    throw new JSONException("No value for key '" + key + "'");
  }
  for (  String v : values) {
    keyObj.validateValueType(v);
  }
}
