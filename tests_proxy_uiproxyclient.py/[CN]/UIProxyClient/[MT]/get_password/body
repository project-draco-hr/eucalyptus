def get_password(self, instanceid, keypair_file):
    register_openers()
    (datagen, headers) = multipart_encode({'Action': 'GetPassword', 'InstanceId': instanceid, '_xsrf': self.xsrf, 'priv_key': open(keypair_file), })
    url = ('http://%s:%s/ec2?' % (self.host, self.port))
    req = urllib2.Request(url, datagen, headers)
    self.__check_logged_in__(req)
    response = urllib2.urlopen(req)
    return json.loads(response.read())
