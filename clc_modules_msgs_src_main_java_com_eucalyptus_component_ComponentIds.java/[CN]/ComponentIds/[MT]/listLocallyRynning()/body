{
  List<ComponentId> components=Lists.newArrayList();
  for (  Component comp : Components.list()) {
    if (Components.lookup(Eucalyptus.class).isAvailableLocally() && comp.getIdentity().isCloudLocal()) {
      components.add(comp.getIdentity());
    }
 else     if (comp.getIdentity().isAlwaysLocal()) {
      components.add(comp.getIdentity());
    }
 else     if (comp.isRunningLocally()) {
      components.add(comp.getIdentity());
    }
  }
  return components;
}
