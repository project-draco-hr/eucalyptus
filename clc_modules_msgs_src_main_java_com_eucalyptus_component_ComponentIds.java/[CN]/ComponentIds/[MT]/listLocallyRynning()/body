{
  List<ComponentId> components=Lists.newArrayList();
  for (  Component comp : Components.list()) {
    if (Components.lookup(Eucalyptus.class).isAvailableLocally() && comp.getComponentId().isCloudLocal()) {
      components.add(comp.getComponentId());
    }
 else     if (comp.getComponentId().isAlwaysLocal()) {
      components.add(comp.getComponentId());
    }
 else     if (comp.isRunningLocally()) {
      components.add(comp.getComponentId());
    }
  }
  return components;
}
