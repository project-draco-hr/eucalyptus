{
  List<ComponentId> components=Lists.newArrayList();
  if (Components.lookup(Eucalyptus.class).isAvailableLocally()) {
    for (    Component comp : Components.list()) {
      if (comp.getIdentity().isCloudLocal()) {
        components.add(comp.getIdentity());
      }
    }
  }
  for (  Component comp : Components.list()) {
    if (comp.isRunningLocally() || comp.getIdentity().isAlwaysLocal()) {
      if (!comp.getIdentity().isCloudLocal()) {
        components.add(comp.getIdentity());
      }
    }
  }
  return components;
}
