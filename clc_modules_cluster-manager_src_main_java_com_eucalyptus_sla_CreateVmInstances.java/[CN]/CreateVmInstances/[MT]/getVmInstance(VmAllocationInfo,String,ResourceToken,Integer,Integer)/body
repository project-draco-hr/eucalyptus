{
  VmInstance vmInst=new VmInstance(reservationId,index - 1,VmInstances.getId(vmAllocInfo.getReservationIndex(),index),vmAllocInfo.getRequest().getUserId(),token.getCluster(),vmAllocInfo.getUserData(),vmAllocInfo.getImageInfo(),vmAllocInfo.getKeyInfo(),vmAllocInfo.getVmTypeInfo(),vmAllocInfo.getNetworks(),networkIndex.toString());
  String dnsDomain="dns-disabled";
  try {
    dnsDomain=edu.ucsb.eucalyptus.cloud.entities.SystemConfiguration.getSystemConfiguration().getDnsDomain();
  }
 catch (  Exception e) {
  }
  vmInst.getNetworkConfig().updateDns(dnsDomain);
  return vmInst;
}
