{
  DescribeImagesResponseType reply=request.getReply();
  final Context ctx=Contexts.lookup();
  final String requestAccountId=ctx.getUserFullName().getAccountNumber();
  final List<String> ownersSet=request.getOwnersSet();
  if (ownersSet.remove(Images.SELF)) {
    ownersSet.add(requestAccountId);
  }
  Predicate<ImageInfo> rangeFilter=Predicates.and(CloudMetadatas.filterById(request.getImagesSet()),CloudMetadatas.filterByOwningAccount(request.getOwnersSet()),Images.filterExecutableBy(ownersSet));
  Predicate<ImageInfo> privilegesFilter=Predicates.and(Images.FilterPermissions.INSTANCE,RestrictedTypes.filterPrivileged(true));
  Predicate<ImageInfo> filter=Predicates.and(privilegesFilter,rangeFilter);
  List<ImageDetails> imageDetailsList=Transactions.filteredTransform(new ImageInfo(),filter,Images.TO_IMAGE_DETAILS);
  reply.getImagesSet().addAll(imageDetailsList);
  ImageUtil.cleanDeregistered();
  return reply;
}
