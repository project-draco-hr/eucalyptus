{
  final Set<String> validUserIds=Sets.newHashSet();
  for (  String userId : userIds) {
    try {
      validUserIds.add(Accounts.lookupAccountById(userId).getAccountNumber());
    }
 catch (    final Exception e) {
      try {
        validUserIds.add(Accounts.lookupUserById(userId).getAccount().getAccountNumber());
      }
 catch (      AuthException ex) {
        try {
          validUserIds.add(Accounts.lookupUserByAccessKeyId(userId).getAccount().getAccountNumber());
        }
 catch (        AuthException ex1) {
          throw new EucalyptusCloudException("Not a valid userId : " + userId);
        }
      }
    }
  }
  return Lists.newArrayList(validUserIds);
}
