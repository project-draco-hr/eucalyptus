{
  LOG.info("[exception " + exceptionEvent + "]");
  HttpResponse response;
  String responseString;
  if (exceptionEvent.getCause() instanceof AuthenticationException) {
    response=new DefaultHttpResponse(HttpVersion.HTTP_1_1,HttpResponseStatus.FORBIDDEN);
    responseString="Authentication Failed: " + response.getStatus() + "\r\n";
  }
 else {
    response=new DefaultHttpResponse(HttpVersion.HTTP_1_1,HttpResponseStatus.INTERNAL_SERVER_ERROR);
    responseString="Failure: " + response.getStatus() + "\r\n";
  }
  response.setContent(ChannelBuffers.copiedBuffer(responseString,"UTF-8"));
  DownstreamMessageEvent newEvent=new DownstreamMessageEvent(ctx.getChannel(),ctx.getChannel().getCloseFuture(),response,null);
  ctx.sendDownstream(newEvent);
  newEvent.getFuture().addListener(ChannelFutureListener.CLOSE);
}
