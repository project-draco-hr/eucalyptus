{
  Vector permVector=new Vector(1);
  Enumeration enum_=pc.elements();
  while (enum_.hasMoreElements()) {
    CryptoPermission cp=(CryptoPermission)enum_.nextElement();
    if (cp.getMaxKeySize() <= maxKeySize) {
      permVector.addElement(cp);
    }
 else {
      if (cp.getCheckParam()) {
        permVector.addElement(new CryptoPermission(cp.getAlgorithm(),maxKeySize,cp.getAlgorithmParameterSpec(),cp.getExemptionMechanism()));
      }
 else {
        permVector.addElement(new CryptoPermission(cp.getAlgorithm(),maxKeySize,cp.getExemptionMechanism()));
      }
    }
  }
  CryptoPermission[] ret=new CryptoPermission[permVector.size()];
  permVector.copyInto(ret);
  return ret;
}
