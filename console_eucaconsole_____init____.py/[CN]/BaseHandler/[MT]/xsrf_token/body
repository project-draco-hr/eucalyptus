@property
def xsrf_token(self):
    if (not hasattr(self, '_xsrf_token')):
        token = self.get_cookie('_xsrf')
        if (not token):
            token = binascii.b2a_hex(uuid.uuid4().bytes)
            expires_days = (30 if self.current_user else None)
            if using_ssl:
                self.set_cookie('_xsrf', token, expires_days=expires_days, secure='yes')
            else:
                self.set_cookie('_xsrf', token, expires_days=expires_days)
        self._xsrf_token = token
    return self._xsrf_token
