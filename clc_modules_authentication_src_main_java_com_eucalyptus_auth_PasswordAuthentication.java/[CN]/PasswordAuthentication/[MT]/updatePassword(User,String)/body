{
  if (Strings.isNullOrEmpty(newPassword) || user.getName().equals(newPassword)) {
    throw new AuthException(AuthException.INVALID_PASSWORD);
  }
  String newEncrypted=Crypto.generateEncryptedPassword(newPassword);
  user.setPassword(newEncrypted);
  user.setPasswordExpires(System.currentTimeMillis() + User.PASSWORD_LIFETIME);
}
