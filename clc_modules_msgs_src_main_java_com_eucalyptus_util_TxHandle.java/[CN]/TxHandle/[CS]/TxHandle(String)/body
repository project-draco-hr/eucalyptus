{
  this.ctx=ctx;
  this.owner=DebugUtil.getMyStackTraceElement();
  this.startTime=Calendar.getInstance();
  this.stopWatch=new StopWatch();
  this.stopWatch.start();
  EntityManagerFactory anemf=(EntityManagerFactoryImpl)DatabaseUtil.getEntityManagerFactory(ctx);
  try {
    this.em=anemf.createEntityManager();
    this.session=(Session)em.getDelegate();
    this.dbUrl=this.session.connection().getMetaData().getURL();
    this.delegate=em.getTransaction();
    this.delegate.begin();
  }
 catch (  Throwable e) {
    LOG.error(e,e);
    throw new RuntimeException(e);
  }
  outstanding.put(ctx,this);
}
