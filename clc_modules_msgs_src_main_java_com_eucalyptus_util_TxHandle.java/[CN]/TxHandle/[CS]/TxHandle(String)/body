{
  this.txUuid=String.format("%s:%s:%s",ctx,EntityWrapper.getMyStackTraceElement(),UUID.randomUUID().toString());
  this.startTime=Calendar.getInstance();
  this.stopWatch=new StopWatch();
  this.stopWatch.start();
  EntityManagerFactory anemf=(EntityManagerFactoryImpl)DatabaseUtil.getEntityManagerFactory(ctx);
  try {
    this.em=anemf.createEntityManager();
    this.delegate=em.getTransaction();
    this.delegate.begin();
    this.session=(Session)em.getDelegate();
    outstanding.put(txUuid,this);
  }
 catch (  Throwable e) {
    this.rollback();
    LOG.error(e,e);
    throw new RuntimeException(e);
  }
}
