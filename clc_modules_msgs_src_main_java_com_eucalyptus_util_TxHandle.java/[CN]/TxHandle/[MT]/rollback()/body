{
  if (this.em.isOpen()) {
    try {
      if (this.delegate.isActive()) {
        this.delegate.rollback();
      }
      this.em.close();
    }
 catch (    Throwable e) {
      this.em.close();
      LOG.error(e,e);
      throw new RuntimeException(e);
    }
  }
 else {
  }
}
