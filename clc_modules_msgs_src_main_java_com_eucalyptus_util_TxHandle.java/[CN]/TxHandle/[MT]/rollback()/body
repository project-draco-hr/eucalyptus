{
  if (this.delegate != null && this.delegate.isActive()) {
    try {
      this.delegate.rollback();
    }
 catch (    Throwable e) {
      LOG.debug(e,e);
    }
  }
  if (this.em != null && this.em.isOpen()) {
    try {
      this.em.close();
    }
 catch (    Throwable e) {
      LOG.error(e,e);
      throw new RuntimeException(e);
    }
  }
 else {
    Exception e=new Exception();
    e.fillInStackTrace();
    LOG.trace(e,e);
  }
}
