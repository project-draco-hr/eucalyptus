{
  try {
    if (EventRecord.isDebugEnabled(ClusterAllocator.class)) {
      EventRecord.here(ClusterAllocator.class,EventType.VM_PREPARE,LogUtil.dumpObject(allocInfo)).debug();
    }
    final ServiceConfiguration config=Topology.lookup(ClusterController.class,allocInfo.getPartition());
    final Callable<Boolean> runnable=new Callable<Boolean>(){
      @Override public Boolean call(){
        try {
          new ClusterAllocator(allocInfo).run();
        }
 catch (        final Exception ex) {
          LOG.warn("Failed to prepare allocator for: " + allocInfo.getAllocationTokens());
          LOG.error("Failed to prepare allocator for: " + allocInfo.getAllocationTokens(),ex);
        }
        return Boolean.TRUE;
      }
    }
;
    Threads.enqueue(config,32,runnable);
    return true;
  }
 catch (  final Exception ex) {
    throw Exceptions.toUndeclared(ex);
  }
}
