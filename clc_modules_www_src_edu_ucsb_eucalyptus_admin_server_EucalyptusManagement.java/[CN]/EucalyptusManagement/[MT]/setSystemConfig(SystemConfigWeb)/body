{
  EntityWrapper<SystemConfiguration> db=new EntityWrapper<SystemConfiguration>();
  try {
    SystemConfiguration sysConf=db.getUnique(new SystemConfiguration());
    sysConf.setStorageUrl(systemConfig.getStorageUrl());
    sysConf.setStorageDir(systemConfig.getStoragePath());
    sysConf.setDefaultKernel(systemConfig.getDefaultKernelId());
    sysConf.setDefaultRamdisk(systemConfig.getDefaultRamdiskId());
    sysConf.setStorageMaxBucketsPerUser(systemConfig.getStorageMaxBucketsPerUser());
    sysConf.setStorageMaxBucketSizeInMB(systemConfig.getStorageMaxBucketSizeInMB());
    sysConf.setStorageMaxCacheSizeInMB(systemConfig.getStorageMaxCacheSizeInMB());
    db.commit();
    WalrusProperties.update();
    StorageProperties.update();
  }
 catch (  EucalyptusCloudException e) {
    db.add(new SystemConfiguration(systemConfig.getStorageUrl(),systemConfig.getDefaultKernelId(),systemConfig.getDefaultRamdiskId(),systemConfig.getStoragePath(),systemConfig.getStorageMaxBucketsPerUser(),systemConfig.getStorageMaxBucketSizeInMB(),systemConfig.getStorageMaxCacheSizeInMB()));
    db.commit();
    WalrusProperties.update();
    StorageProperties.update();
  }
}
