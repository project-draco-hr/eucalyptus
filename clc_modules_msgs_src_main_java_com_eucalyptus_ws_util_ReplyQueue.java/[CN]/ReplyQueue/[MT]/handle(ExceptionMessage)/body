{
  Throwable cause=exMsg.getException();
  if (cause instanceof MessagingException) {
    MessagingException messagingEx=((MessagingException)cause);
    cause=messagingEx.getCause();
    MuleMessage muleMsg=messagingEx.getUmoMessage();
    Object payload=muleMsg.getPayload();
    BaseMessage msg=convert(payload);
    if (msg != null) {
      if (cause instanceof EucalyptusWebServiceException) {
        final QueryBindingInfo info=Ats.inClassHierarchy(cause.getClass()).get(QueryBindingInfo.class);
        final HttpResponseStatus status=info == null ? HttpResponseStatus.INTERNAL_SERVER_ERROR : new HttpResponseStatus(info.statusCode(),"");
        Contexts.response(new ExceptionResponseType(msg,((EucalyptusWebServiceException)cause).getCode(),cause.getMessage(),status,cause));
      }
 else {
        Contexts.response(new ExceptionResponseType(msg,cause.getMessage(),HttpResponseStatus.NOT_ACCEPTABLE,cause));
      }
    }
 else {
      LOG.error("Failed to identify request context for received error: " + exMsg.toString());
      cause=new WebServicesException("Failed to identify request context for received error: " + exMsg.toString() + " while handling error: "+ cause.getMessage(),cause,HttpResponseStatus.NOT_ACCEPTABLE);
      Contexts.responseError(cause);
    }
  }
 else   if (cause instanceof MuleException) {
    LOG.error("Error service request: " + cause.getMessage(),cause);
    cause=new WebServicesException(cause.getMessage(),cause,HttpResponseStatus.NOT_FOUND);
    Contexts.responseError(cause);
  }
 else {
    Contexts.responseError(cause);
  }
}
