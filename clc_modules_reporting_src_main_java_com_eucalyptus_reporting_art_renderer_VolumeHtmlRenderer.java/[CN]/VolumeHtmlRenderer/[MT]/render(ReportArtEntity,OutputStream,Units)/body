{
  Writer writer=new OutputStreamWriter(os);
  writer.write("<html><body>\n");
  writer.write("<h1>Volume Report</h1>\n");
  writer.write("<h4>Begin:" + ms2Date(report.getBeginMs()) + "</h4>\n");
  writer.write("<h4>End:" + ms2Date(report.getEndMs()) + "</h4>\n");
  writer.write("<table border=0>\n");
  writer.write((new Row(VALUE_WIDTH)).addEmptyCols(6,LABEL_WIDTH).addCol("Instance Id").addCol("Volume Id").addCol("# Vol").addCol("Size (" + units.toString() + ")").addCol("Vol Duration").toString());
  for (  String zoneName : report.getZones().keySet()) {
    AvailabilityZoneArtEntity zone=report.getZones().get(zoneName);
    writer.write((new VolRow()).addCol("Zone: " + zoneName,LABEL_WIDTH,3,"left").addEmptyCols(3,LABEL_WIDTH).addCol("cumul.").addCol("cumul.").addUsageCols(zone.getUsageTotals().getVolumeTotals(),units).toString());
    for (    String accountName : zone.getAccounts().keySet()) {
      AccountArtEntity account=zone.getAccounts().get(accountName);
      writer.write((new VolRow()).addEmptyCols(2,LABEL_WIDTH).addCol("Account: " + accountName,LABEL_WIDTH,3,"left").addEmptyCols(1,LABEL_WIDTH).addCol("cumul.").addCol("cumul.").addUsageCols(account.getUsageTotals().getVolumeTotals(),units).toString());
      for (      String userName : account.getUsers().keySet()) {
        UserArtEntity user=account.getUsers().get(userName);
        writer.write((new VolRow()).addEmptyCols(3,LABEL_WIDTH).addCol("User: " + userName,LABEL_WIDTH,3,"left").addCol("cumul.").addCol("cumul.").addUsageCols(user.getUsageTotals().getVolumeTotals(),units).toString());
        for (        String volumeUuid : user.getVolumes().keySet()) {
          VolumeArtEntity volume=user.getVolumes().get(volumeUuid);
          writer.write((new VolRow()).addEmptyCols(6,LABEL_WIDTH).addCol(volume.getVolumeId()).addCol("cumul,").addUsageCols(volume.getUsage(),units).toString());
          for (          String instanceId : volume.getInstanceAttachments().keySet()) {
            VolumeUsageArtEntity usage=volume.getInstanceAttachments().get(instanceId);
            writer.write((new VolRow()).addEmptyCols(6,LABEL_WIDTH).addCol(volume.getVolumeId()).addCol(instanceId).addUsageCols(usage,units).toString());
          }
        }
      }
    }
  }
  writer.write("</table>\n");
  writer.write("</body></html>\n");
  writer.flush();
}
