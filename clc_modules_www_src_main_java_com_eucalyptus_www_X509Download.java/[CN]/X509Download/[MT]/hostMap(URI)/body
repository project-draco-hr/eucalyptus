{
  final Optional<Cidr> hostMatcher=InetAddresses.isInetAddress(uri.getHost()) ? Cidr.parse().apply(AuthenticationProperties.CREDENTIAL_DOWNLOAD_HOST_MATCH) : Optional.<Cidr>absent();
  if (hostMatcher.isPresent()) {
    final Host host=Hosts.lookup(InetAddresses.forString(uri.getHost()));
    if (host != null) {
      final Optional<InetAddress> mappedHost=Iterables.tryFind(host.getHostAddresses(),hostMatcher.get());
      if (mappedHost.isPresent()) {
        return URI.create(uri.toString().replaceFirst(uri.getHost(),mappedHost.get().getHostAddress()));
      }
    }
  }
  return uri;
}
