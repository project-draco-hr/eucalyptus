{
  for (  final LoadBalancerPolicyDescriptionCoreView current : lb.getPolicies()) {
    if (policyName.equals(current.getPolicyName()))     throw new DuplicatePolicyNameException();
  }
  boolean typeFound=false;
  for (  final LoadBalancerPolicyTypeDescription type : getLoadBalancerPolicyTypeDescriptions()) {
    if (policyTypeName.equals(type.getPolicyTypeName())) {
      typeFound=true;
      break;
    }
  }
  if (!typeFound)   throw new PolicyTypeNotFoundException();
  final LoadBalancerPolicyDescription policyDesc=new LoadBalancerPolicyDescription(lb,policyName,policyTypeName);
  for (  final PolicyAttribute attr : attributes) {
    policyDesc.addPolicyAttributeDescription(attr.getAttributeName(),attr.getAttributeValue());
  }
  try (final TransactionResource db=Entities.transactionFor(LoadBalancerPolicyDescription.class)){
    Entities.persist(policyDesc);
    db.commit();
  }
 }
