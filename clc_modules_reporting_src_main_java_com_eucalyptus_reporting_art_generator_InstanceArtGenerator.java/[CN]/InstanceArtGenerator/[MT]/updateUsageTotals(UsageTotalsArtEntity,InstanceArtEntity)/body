{
  InstanceUsageArtEntity totalEntity=totals.getInstanceTotals();
  InstanceUsageArtEntity newEntity=instance.getUsage();
  if (totalEntity.getCpuPercentAvg() == null && newEntity.getCpuPercentAvg() != null) {
    totalEntity.setCpuPercentAvg(newEntity.getCpuPercentAvg());
    totalEntity.addDurationMs(newEntity.getDurationMs());
  }
 else   if (newEntity.getCpuPercentAvg() != null && totalEntity.getCpuPercentAvg() != null) {
    double newWeightedAverage=(totalEntity.getCpuPercentAvg() * (double)totalEntity.getDurationMs() + (double)newEntity.getCpuPercentAvg() * (double)newEntity.getDurationMs()) / ((double)totalEntity.getDurationMs() + (double)newEntity.getDurationMs());
    totalEntity.setCpuPercentAvg(newWeightedAverage);
    totalEntity.addDurationMs(newEntity.getDurationMs());
  }
  totalEntity.setDiskIoMegs(plus(totalEntity.getDiskIoMegs(),newEntity.getDiskIoMegs()));
  totalEntity.setNetIoBetweenZoneInMegs(plus(totalEntity.getNetIoBetweenZoneInMegs(),newEntity.getNetIoBetweenZoneInMegs()));
  totalEntity.setNetIoWithinZoneInMegs(plus(totalEntity.getNetIoWithinZoneInMegs(),newEntity.getNetIoWithinZoneInMegs()));
  totalEntity.setNetIoPublicIpInMegs(plus(totalEntity.getNetIoPublicIpInMegs(),newEntity.getNetIoPublicIpInMegs()));
  totalEntity.setNetIoBetweenZoneOutMegs(plus(totalEntity.getNetIoBetweenZoneOutMegs(),newEntity.getNetIoBetweenZoneOutMegs()));
  totalEntity.setNetIoWithinZoneOutMegs(plus(totalEntity.getNetIoWithinZoneOutMegs(),newEntity.getNetIoWithinZoneOutMegs()));
  totalEntity.setNetIoPublicIpOutMegs(plus(totalEntity.getNetIoPublicIpOutMegs(),newEntity.getNetIoPublicIpOutMegs()));
}
