{
  InstanceUsageArtEntity totalEntity=totals.getInstanceTotals();
  InstanceUsageArtEntity newEntity=instance.getUsage();
  if (totalEntity.getCpuPercentAvg() == null && newEntity.getCpuPercentAvg() != null) {
    totalEntity.setCpuPercentAvg(newEntity.getCpuPercentAvg());
    totalEntity.addDurationMs(newEntity.getDurationMs());
  }
 else   if (newEntity.getCpuPercentAvg() != null && totalEntity.getCpuPercentAvg() != null) {
    double newWeightedAverage=(totalEntity.getCpuPercentAvg() * (double)totalEntity.getDurationMs() + (double)newEntity.getCpuPercentAvg() * (double)newEntity.getDurationMs()) / ((double)totalEntity.getDurationMs() + (double)newEntity.getDurationMs());
    totalEntity.setCpuPercentAvg(newWeightedAverage);
    totalEntity.addDurationMs(newEntity.getDurationMs());
  }
  totalEntity.setDiskIoMegSecs(plus(totalEntity.getDiskIoMegSecs(),newEntity.getDiskIoMegSecs()));
  totalEntity.setNetIoBetweenZoneInMegSecs(plus(totalEntity.getNetIoBetweenZoneInMegSecs(),newEntity.getNetIoBetweenZoneInMegSecs()));
  totalEntity.setNetIoWithinZoneInMegSecs(plus(totalEntity.getNetIoWithinZoneInMegSecs(),newEntity.getNetIoWithinZoneInMegSecs()));
  totalEntity.setNetIoPublicIpInMegSecs(plus(totalEntity.getNetIoPublicIpInMegSecs(),newEntity.getNetIoPublicIpInMegSecs()));
  totalEntity.setNetIoBetweenZoneOutMegSecs(plus(totalEntity.getNetIoBetweenZoneOutMegSecs(),newEntity.getNetIoBetweenZoneOutMegSecs()));
  totalEntity.setNetIoWithinZoneOutMegSecs(plus(totalEntity.getNetIoWithinZoneOutMegSecs(),newEntity.getNetIoWithinZoneOutMegSecs()));
  totalEntity.setNetIoPublicIpOutMegSecs(plus(totalEntity.getNetIoPublicIpOutMegSecs(),newEntity.getNetIoPublicIpOutMegSecs()));
}
