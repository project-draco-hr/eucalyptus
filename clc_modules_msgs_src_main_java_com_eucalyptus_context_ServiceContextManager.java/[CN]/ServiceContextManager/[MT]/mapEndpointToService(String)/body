{
  String dest=endpoint;
  if ((endpoint.startsWith("vm://") && !endpointToService.containsKey(endpoint)) || endpoint == null) {
    throw new ServiceDispatchException("Failed to find destination: " + endpoint,new IllegalArgumentException("No such endpoint: " + endpoint + " in endpoints="+ endpointToService.entrySet()));
  }
  if (endpoint.startsWith("vm://")) {
    dest=endpointToService.get(endpoint);
  }
  return dest;
}
