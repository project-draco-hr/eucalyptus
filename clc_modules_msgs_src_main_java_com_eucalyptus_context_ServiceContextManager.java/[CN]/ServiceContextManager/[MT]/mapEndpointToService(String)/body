{
  String dest=endpoint;
  if ((endpoint.startsWith("vm://") && !singleton.endpointToService.containsKey(endpoint)) || (endpoint == null)) {
    throw new ServiceDispatchException("No such endpoint: " + endpoint + " in endpoints="+ singleton.endpointToService.entrySet());
  }
  if (endpoint.startsWith("vm://")) {
    dest=singleton.endpointToService.get(endpoint);
  }
  return dest;
}
