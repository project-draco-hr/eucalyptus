{
  final TaskWithBackOff onSuccess=onSuccess();
  if (onSuccess != null) {
    if (!tasksInProgress.replace(getUniqueKey(),taskInfo,onSuccess.info(new TaskInfo(onSuccess,System.currentTimeMillis(),0)))) {
      logger.info("Unable to create activity: " + onSuccess.getBackoffGroup() + " for "+ onSuccess.getUniqueKey());
    }
 else {
      future.set(true);
      onSuccess.runTask();
    }
  }
  if (!future.isDone()) {
    future.set(true);
  }
}
