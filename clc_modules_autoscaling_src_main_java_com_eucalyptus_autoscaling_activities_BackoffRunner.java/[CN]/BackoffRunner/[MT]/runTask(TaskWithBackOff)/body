{
  if (!scalingEnabled() && task.isScalingTask())   return false;
  final long timestamp=timestamp();
  boolean run=false;
  final TaskInfo previous=tasksInProgress.putIfAbsent(task.getUniqueKey(),new TaskInfo(task,timestamp,0));
  if (previous == null) {
    run=true;
  }
 else   if (previous.canFollow(timestamp,task.getBackoffGroup()) && tasksInProgress.remove(task.getUniqueKey(),previous) && tasksInProgress.putIfAbsent(task.getUniqueKey(),new TaskInfo(task,timestamp,previous.getNextFailureCount(task.getBackoffGroup()))) == null) {
    run=true;
  }
  if (run) {
    task.runTask();
  }
 else {
    logger.info("Not running task " + task);
  }
  return run;
}
