{
  return Suppliers.memoize(new Supplier<Set<String>>(){
    @Override public Set<String> get(){
      final EntityTransaction db=Entities.get(VmInstance.class);
      try {
        Collection<VmInstance> clusterInstances=Collections2.filter(VmInstances.list(),filter);
        Collection<String> instanceNames=Collections2.transform(clusterInstances,CloudMetadatas.toDisplayName());
        return Sets.newHashSet(instanceNames);
      }
 catch (      Exception ex) {
        Logs.extreme().error(ex,ex);
        return Sets.newHashSet();
      }
 finally {
        db.rollback();
      }
    }
  }
);
}
