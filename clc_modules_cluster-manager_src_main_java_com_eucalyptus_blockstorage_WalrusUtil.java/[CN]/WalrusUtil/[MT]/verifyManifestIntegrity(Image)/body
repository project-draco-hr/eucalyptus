{
  String[] imagePathParts=imgInfo.getImageLocation().split("/");
  GetObjectResponseType reply=null;
  GetObjectType msg=new GetObjectType(imagePathParts[0],imagePathParts[1],true,false,true);
  msg.setUser(User.SYSTEM);
  try {
    reply=(GetObjectResponseType)ServiceDispatcher.lookupSingle(Components.lookup("walrus")).send(msg);
    if (reply == null || reply.getBase64Data() == null) {
      throw new EucalyptusCloudException("No data: " + imgInfo.getImageLocation());
    }
 else {
      if (LogLevels.DEBUG) {
        LOG.debug("Got the manifest to verify: ");
        LOG.debug(Hashes.base64decode(reply.getBase64Data()));
      }
      if (checkManifest(imgInfo,reply.getBase64Data())) {
        return;
      }
 else {
        throw new EucalyptusCloudException("Failed to verify signature.");
      }
    }
  }
 catch (  EucalyptusCloudException e) {
    LOG.error(e,e);
    LOG.debug(e);
    throw new EucalyptusCloudException("Invalid manifest reference: " + imgInfo.getImageLocation() + " because of "+ e.getMessage(),e);
  }
}
