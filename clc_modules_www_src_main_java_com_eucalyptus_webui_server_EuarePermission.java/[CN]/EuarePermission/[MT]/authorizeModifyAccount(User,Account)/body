{
  if (Account.SYSTEM_ACCOUNT.equals(account.getName())) {
    throw new EucalyptusServiceException("Can not change system account name");
  }
  boolean allowed=false;
  try {
    allowed=requestUser.isSystemAdmin() || (requestUser.getAccount().getAccountNumber().equals(account.getAccountNumber()) && (requestUser.isAccountAdmin() || Permissions.isAuthorized(PolicySpec.VENDOR_IAM,PolicySpec.ALL_RESOURCE,PolicySpec.ALL_RESOURCE,account,PolicySpec.IAM_CREATEACCOUNTALIAS,requestUser)));
  }
 catch (  Exception e) {
    LOG.error(e,e);
  }
  if (!allowed) {
    throw new EucalyptusServiceException("Operation is not authorized");
  }
}
