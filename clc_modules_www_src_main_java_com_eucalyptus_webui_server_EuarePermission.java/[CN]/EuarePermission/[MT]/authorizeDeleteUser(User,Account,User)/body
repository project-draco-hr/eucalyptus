{
  boolean allowed=requestUser.isSystemAdmin() || (requestUser.getAccount().getAccountNumber().equals(account.getAccountNumber()) && (requestUser.isAccountAdmin() || Permissions.isAuthorized(PolicySpec.VENDOR_IAM,PolicySpec.IAM_RESOURCE_USER,Accounts.getUserFullName(user),account,PolicySpec.IAM_DELETEUSER,requestUser)));
  if (!allowed) {
    throw new AuthException("Failed to authorize user deletion");
  }
}
