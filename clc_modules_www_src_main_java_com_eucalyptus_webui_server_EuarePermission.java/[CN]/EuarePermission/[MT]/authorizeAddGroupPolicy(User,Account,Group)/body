{
  boolean allowed=false;
  try {
    allowed=requestUser.isSystemAdmin() || (requestUser.getAccount().getAccountNumber().equals(account.getAccountNumber()) && (requestUser.isAccountAdmin() || Permissions.isAuthorized(PolicySpec.VENDOR_IAM,PolicySpec.IAM_RESOURCE_GROUP,Accounts.getGroupFullName(group),account,PolicySpec.IAM_PUTGROUPPOLICY,requestUser)));
  }
 catch (  Exception e) {
    LOG.error(e,e);
  }
  if (!allowed) {
    throw new EucalyptusServiceException("Operation is not authorized");
  }
}
