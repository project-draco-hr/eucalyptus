{
  boolean allowed=requestUser.isSystemAdmin() || (requestUser.getAccount().getAccountNumber().equals(account.getAccountNumber()) && (requestUser.isAccountAdmin() || (Permissions.isAuthorized(PolicySpec.VENDOR_IAM,PolicySpec.IAM_RESOURCE_GROUP,"",account,PolicySpec.IAM_CREATEGROUP,requestUser) && Permissions.canAllocate(PolicySpec.VENDOR_IAM,PolicySpec.IAM_RESOURCE_GROUP,"",PolicySpec.IAM_CREATEGROUP,requestUser,1L))));
  if (!allowed) {
    throw new AuthException("Failed to authorize group creation");
  }
}
