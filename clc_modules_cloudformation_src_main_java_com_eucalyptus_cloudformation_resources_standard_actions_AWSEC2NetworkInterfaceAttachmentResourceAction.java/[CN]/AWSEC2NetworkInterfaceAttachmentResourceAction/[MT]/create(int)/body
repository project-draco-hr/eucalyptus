{
switch (stepNum) {
case 0:
    ServiceConfiguration configuration=Topology.lookup(Compute.class);
  AttachNetworkInterfaceType attachNetworkInterfaceType=new AttachNetworkInterfaceType();
attachNetworkInterfaceType.setEffectiveUserId(info.getEffectiveUserId());
if (properties.getInstanceId() != null) {
DescribeInstancesType describeInstancesType=new DescribeInstancesType();
describeInstancesType.setInstancesSet(Lists.newArrayList(properties.getInstanceId()));
describeInstancesType.setEffectiveUserId(info.getEffectiveUserId());
DescribeInstancesResponseType describeInstancesResponseType=AsyncRequests.<DescribeInstancesType,DescribeInstancesResponseType>sendSync(configuration,describeInstancesType);
if (describeInstancesResponseType.getReservationSet() == null || describeInstancesResponseType.getReservationSet().isEmpty()) {
  throw new ValidationErrorException("No such instance " + properties.getInstanceId());
}
attachNetworkInterfaceType.setInstanceId(properties.getInstanceId());
}
if (properties.getNetworkInterfaceId() != null) {
DescribeNetworkInterfacesType describeNetworkInterfacesType=new DescribeNetworkInterfacesType();
describeNetworkInterfacesType.setEffectiveUserId(info.getEffectiveUserId());
describeNetworkInterfacesType.setNetworkInterfaceIdSet(convertNetworkInterfaceIdSet(properties.getNetworkInterfaceId()));
DescribeNetworkInterfacesResponseType describeNetworkInterfacesResponseType=AsyncRequests.<DescribeNetworkInterfacesType,DescribeNetworkInterfacesResponseType>sendSync(configuration,describeNetworkInterfacesType);
if (describeNetworkInterfacesResponseType.getNetworkInterfaceSet() == null || describeNetworkInterfacesResponseType.getNetworkInterfaceSet().getItem() == null || describeNetworkInterfacesResponseType.getNetworkInterfaceSet().getItem().isEmpty()) {
throw new ValidationErrorException("No such network interface " + properties.getNetworkInterfaceId());
}
attachNetworkInterfaceType.setNetworkInterfaceId(properties.getNetworkInterfaceId());
}
attachNetworkInterfaceType.setDeviceIndex(properties.getDeviceIndex());
AttachNetworkInterfaceResponseType attachNetworkInterfaceResponseType=AsyncRequests.<AttachNetworkInterfaceType,AttachNetworkInterfaceResponseType>sendSync(configuration,attachNetworkInterfaceType);
info.setPhysicalResourceId(attachNetworkInterfaceResponseType.getAttachmentId());
info.setReferenceValueJson(JsonHelper.getStringFromJsonNode(new TextNode(info.getPhysicalResourceId())));
break;
default :
throw new IllegalStateException("Invalid step " + stepNum);
}
}
