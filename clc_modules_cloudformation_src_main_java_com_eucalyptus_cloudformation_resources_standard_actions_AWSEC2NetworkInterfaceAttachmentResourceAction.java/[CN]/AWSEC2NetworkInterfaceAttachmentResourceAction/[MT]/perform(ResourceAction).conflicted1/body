{
  AWSEC2NetworkInterfaceAttachmentResourceAction action=(AWSEC2NetworkInterfaceAttachmentResourceAction)resourceAction;
  ServiceConfiguration configuration=Topology.lookup(Compute.class);
  if (action.info.getPhysicalResourceId() == null)   return action;
  DescribeNetworkInterfacesType describeNetworkInterfacesType=MessageHelper.createMessage(DescribeNetworkInterfacesType.class,action.info.getEffectiveUserId());
  describeNetworkInterfacesType.setNetworkInterfaceIdSet(action.convertNetworkInterfaceIdSet(action.properties.getNetworkInterfaceId()));
  DescribeNetworkInterfacesResponseType describeNetworkInterfacesResponseType=AsyncRequests.<DescribeNetworkInterfacesType,DescribeNetworkInterfacesResponseType>sendSync(configuration,describeNetworkInterfacesType);
  if (describeNetworkInterfacesResponseType.getNetworkInterfaceSet() == null || describeNetworkInterfacesResponseType.getNetworkInterfaceSet().getItem() == null || describeNetworkInterfacesResponseType.getNetworkInterfaceSet().getItem().isEmpty()) {
    return action;
  }
  boolean foundAttachment=false;
  for (  NetworkInterfaceType networkInterfaceType : describeNetworkInterfacesResponseType.getNetworkInterfaceSet().getItem()) {
    if (networkInterfaceType.getAttachment() != null && networkInterfaceType.getAttachment().getAttachmentId() != null && networkInterfaceType.getAttachment().getAttachmentId().equals(action.info.getPhysicalResourceId())) {
      foundAttachment=true;
      break;
    }
  }
  if (!foundAttachment)   return action;
  DetachNetworkInterfaceType detachNetworkInterfaceType=MessageHelper.createMessage(DetachNetworkInterfaceType.class,action.info.getEffectiveUserId());
  detachNetworkInterfaceType.setAttachmentId(action.info.getPhysicalResourceId());
  AsyncRequests.<DetachNetworkInterfaceType,DetachNetworkInterfaceResponseType>sendSync(configuration,detachNetworkInterfaceType);
  return action;
}
