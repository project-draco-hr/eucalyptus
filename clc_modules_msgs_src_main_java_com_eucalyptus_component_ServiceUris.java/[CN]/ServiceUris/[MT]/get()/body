{
  assertThat(this.address,notNullValue());
  assertThat(this.path,notNullValue());
  if (this.scheme == null)   this.scheme=Transport.HTTP;
  if (this.port == null)   this.port=this.componentId.getPort();
  if (this.internal)   this.path=this.componentId.getInternalServicePath(this.path);
  String schemeString=StackConfiguration.DEFAULT_HTTPS_ENABLED ? this.scheme.getSecureScheme() : this.scheme.getScheme();
  try {
    URI u=new URI(schemeString,null,this.address.getCanonicalHostName(),this.port,this.path,Lexemes.QUERY.format(this.query),this.fragment);
    u.parseServerAuthority();
    return u;
  }
 catch (  URISyntaxException e) {
    throw new RuntimeException("Failed to construct URI: " + this.toString() + " because of: "+ e,e);
  }
}
