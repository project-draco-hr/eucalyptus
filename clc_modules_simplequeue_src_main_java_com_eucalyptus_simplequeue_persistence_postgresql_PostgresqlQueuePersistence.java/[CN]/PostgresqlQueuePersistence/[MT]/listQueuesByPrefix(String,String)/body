{
  try (TransactionResource db=Entities.transactionFor(QueueEntity.class)){
    Criteria criteria=Entities.createCriteria(QueueEntity.class).add(Restrictions.eq("accountId",accountId));
    if (queueNamePrefix != null) {
      criteria=criteria.add(Restrictions.like("queueName",queueNamePrefix + "%"));
    }
    List<QueueEntity> queueEntities=(List<QueueEntity>)criteria.list();
    List<Queue> queues=Lists.newArrayList();
    if (queueEntities != null) {
      for (      QueueEntity queueEntity : queueEntities) {
        queues.add(queueFromQueueEntity(queueEntity));
      }
    }
    return queues;
  }
 }
