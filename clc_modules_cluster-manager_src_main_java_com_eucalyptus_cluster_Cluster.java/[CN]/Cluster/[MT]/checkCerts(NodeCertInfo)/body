{
  if (certs == null || certs.getCcCert() == null || certs.getNcCert() == null) {
    return false;
  }
  X509Certificate clusterx509=PEMFiles.getCert(B64.dec(certs.getCcCert()));
  X509Certificate nodex509=PEMFiles.getCert(B64.dec(certs.getNcCert()));
  if ("self".equals(certs.getServiceTag()) || certs.getServiceTag() == null) {
    return (this.hasClusterCert=checkCerts(this.getClusterCertificate(),clusterx509)) && (this.hasNodeCert=checkCerts(this.getNodeCertificate(),nodex509));
  }
 else   if (this.nodeMap.containsKey(certs.getServiceTag())) {
    NodeInfo nodeInfo=this.nodeMap.get(certs.getServiceTag());
    nodeInfo.setHasClusterCert(checkCerts(this.getClusterCertificate(),clusterx509));
    nodeInfo.setHasNodeCert(checkCerts(this.getNodeCertificate(),nodex509));
    return nodeInfo.getHasClusterCert() && nodeInfo.getHasNodeCert();
  }
 else {
    LOG.error("Cluster " + this.getName() + " failed to find cluster/node info for service tag: "+ certs.getServiceTag());
    return false;
  }
}
