{
  try {
    queueFactory=QueueFactory.getInstance();
    queueFactory.startup();
    QueueReceiver snapshotReceiver=queueFactory.getReceiver(QueueIdentifier.SNAPSHOT);
    if (snapshotListener == null) {
      snapshotListener=new SnapShotUsageEventListener();
      log.info("New snapshot listener instantiated");
    }
 else {
      log.info("Used existing snapshot listener");
    }
    snapshotReceiver.addEventListener(snapshotListener);
    log.info("Snapshot queue poller started");
    QueueReceiver volumeReceiver=queueFactory.getReceiver(QueueIdentifier.VOLUME);
    if (volumeListener == null) {
      volumeListener=new VolumeUsageEventListener();
      log.info("New volume listener instantiated");
    }
 else {
      log.info("Used existing volume listener");
    }
    volumeReceiver.addEventListener(volumeListener);
    log.info("Volume queue poller started");
    QueueReceiver s3Receiver=queueFactory.getReceiver(QueueIdentifier.S3);
    if (s3Listener == null) {
      s3Listener=new S3EventListener();
      log.info("New s3 listener instantiated");
    }
 else {
      log.info("Used existing s3 listener");
    }
    log.info("S3 queue poller started");
    s3Receiver.addEventListener(s3Listener);
    ListenerRegistry.getInstance().register(InstanceEvent.class,new EventListener(){
      @Override public void fireEvent(      Event event){
        if (event instanceof InstanceEvent) {
          QueueSender sender=QueueFactory.getInstance().getSender(QueueIdentifier.INSTANCE);
          sender.send((com.eucalyptus.event.Event)event);
        }
      }
    }
);
    ListenerRegistry.getInstance().register(SnapShotEvent.class,new EventListener(){
      @Override public void fireEvent(      Event event){
        if (event instanceof SnapShotEvent) {
          QueueSender sender=QueueFactory.getInstance().getSender(QueueIdentifier.SNAPSHOT);
          sender.send((com.eucalyptus.event.Event)event);
        }
      }
    }
);
    ListenerRegistry.getInstance().register(VolumeEvent.class,new EventListener(){
      @Override public void fireEvent(      Event event){
        if (event instanceof VolumeEvent) {
          QueueSender sender=QueueFactory.getInstance().getSender(QueueIdentifier.VOLUME);
          sender.send((com.eucalyptus.event.Event)event);
        }
      }
    }
);
    log.info("ReportingBootstrapper started");
    return true;
  }
 catch (  Exception ex) {
    ex.printStackTrace();
    log.error("ReportingBootstrapper failed to start",ex);
    return false;
  }
}
