{
  EntityTransaction db=Entities.get(VolumeToken.class);
  try {
    VolumeToken token=new VolumeToken();
    token.setToken(Crypto.generateSessionToken());
    token.setVolumeId(volumeId);
    token.setIsValid(true);
    Entities.persist(token);
    db.commit();
    return token;
  }
 catch (  Exception e) {
    LOG.error("Error creating new volume token for " + volumeId);
  }
 finally {
    if (db.isActive()) {
      db.rollback();
    }
  }
  return null;
}
