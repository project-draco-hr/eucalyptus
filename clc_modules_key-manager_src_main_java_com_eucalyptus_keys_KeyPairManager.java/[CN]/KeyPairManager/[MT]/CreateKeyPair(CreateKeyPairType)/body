{
  CreateKeyPairResponseType reply=(CreateKeyPairResponseType)request.getReply();
  PrivateKey pk=KeyPairUtil.createUserKeyPair(request.getUserId(),request.getKeyName());
  reply.setKeyFingerprint(Hashes.getFingerPrint(pk));
  ByteArrayOutputStream byteOut=new ByteArrayOutputStream();
  PEMWriter privOut=new PEMWriter(new OutputStreamWriter(byteOut));
  try {
    privOut.writeObject(pk);
    privOut.close();
  }
 catch (  IOException e) {
    LOG.error(e);
    throw new EucalyptusCloudException(e);
  }
  reply.setKeyMaterial(byteOut.toString());
  return reply;
}
