{
  List<MemoryPoolMXBean> beans=ManagementFactory.getMemoryPoolMXBeans();
  boolean noPermGenBeans=true;
  if (null != beans) {
    boolean alreadyFaulted=false;
    for (    MemoryPoolMXBean bean : beans) {
      String name=bean.getName();
      if (!name.contains("Perm Gen"))       continue;
      if (bean.getType() != MemoryType.NON_HEAP)       continue;
      noPermGenBeans=false;
      double actualRatio=((double)bean.getUsage().getUsed()) / ((double)bean.getUsage().getMax());
      LOG.debug("Perm-gen memory usage ratio = " + actualRatio);
      if (actualRatio > ratio) {
        if (!alreadyFaulted) {
          Faults.forComponent(Eucalyptus.class).havingId(OUT_OF_PERM_GEN_MEMORY_FAULT_ID).withVar("component",Eucalyptus.INSTANCE.getFaultLogPrefix()).log();
          alreadyFaulted=true;
        }
      }
    }
  }
 else {
  }
  if (noPermGenBeans) {
    LOG.warn("Unable to find any mxbeans for Perm-Gen usage");
  }
}
