{
  try {
    final String imageId=this.getImageId();
    if (imageId == null)     throw new EucalyptusCloudException("Image Id should be available before full registration");
    final EucalyptusRegisterImageTask task=new EucalyptusRegisterImageTask();
    final CheckedListenableFuture<Boolean> result=task.dispatch();
    if (result.get()) {
      if (!imageId.equals(task.getImageId()))       throw new EucalyptusCloudException("Wrong image registered");
    }
 else     throw new EucalyptusCloudException(String.format("Failed to register the image %s",imageId));
  }
 catch (  final Exception ex) {
    throw Exceptions.toUndeclared(ex);
  }
}
