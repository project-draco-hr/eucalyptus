{
  EntityWrapper<LVMVolumeInfo> db=StorageController.getEntityWrapper();
  assert(snapshotSet.size() == snapshotFileNames.size());
  int i=0;
  for (  String snapshotFileName : snapshotFileNames) {
    try {
      String loDevName=createLoopback(snapshotFileName);
      LVMVolumeInfo lvmVolumeInfo=new LVMVolumeInfo(snapshotSet.get(i++));
      lvmVolumeInfo.setLoDevName(loDevName);
      lvmVolumeInfo.setMajorNumber(-1);
      lvmVolumeInfo.setMinorNumber(-1);
      lvmVolumeInfo.setStatus(StorageProperties.Status.available.toString());
      db.add(lvmVolumeInfo);
    }
 catch (    ExecutionException ex) {
      db.rollback();
      String error="Unable to run command: " + ex.getMessage();
      LOG.error(error);
      throw new EucalyptusCloudException(error);
    }
  }
  db.commit();
}
