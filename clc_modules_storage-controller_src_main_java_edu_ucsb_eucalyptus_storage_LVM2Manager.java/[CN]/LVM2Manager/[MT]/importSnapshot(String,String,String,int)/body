{
  VolumeEntityWrapperManager volumeManager=new VolumeEntityWrapperManager();
  LVMVolumeInfo snapInfo=volumeManager.getVolumeInfo(snapshotId);
  if (snapInfo != null) {
    volumeManager.finish();
    throw new EucalyptusCloudException("Snapshot " + snapshotId + " already exists. Import failed.");
  }
  volumeManager.finish();
  String snapFileName=storageRootDirectory + File.separator + snapshotId;
  try {
    SystemUtil.run(new String[]{eucaHome + StorageProperties.EUCA_ROOT_WRAPPER,"dd","if=" + snapPath,"of=" + snapFileName,"bs=" + StorageProperties.blockSize});
  }
 catch (  ExecutionException e) {
    LOG.error(e);
    throw new EucalyptusCloudException(e);
  }
  volumeManager=new VolumeEntityWrapperManager();
  LVMVolumeInfo snapshotInfo=volumeManager.getVolumeInfo();
  snapshotInfo.setVolumeId(snapshotId);
  snapshotInfo.setLoFileName(snapFileName);
  snapshotInfo.setSize(size);
  snapshotInfo.setSnapshotOf(volumeId);
  volumeManager.add(snapshotInfo);
  volumeManager.finish();
}
