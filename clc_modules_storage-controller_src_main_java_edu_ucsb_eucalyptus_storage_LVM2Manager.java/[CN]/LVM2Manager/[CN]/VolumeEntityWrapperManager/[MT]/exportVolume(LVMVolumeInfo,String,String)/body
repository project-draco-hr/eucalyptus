{
  if (exportManager instanceof AOEManager) {
    AOEVolumeInfo aoeVolumeInfo=(AOEVolumeInfo)lvmVolumeInfo;
    exportManager.allocateTarget(aoeVolumeInfo);
    int majorNumber=aoeVolumeInfo.getMajorNumber();
    int minorNumber=aoeVolumeInfo.getMinorNumber();
    String absoluteLVName=lvmRootDirectory + PATH_SEPARATOR + vgName+ PATH_SEPARATOR+ lvName;
    int pid=exportManager.exportVolume(DirectStorageInfo.getStorageInfo().getStorageInterface(),absoluteLVName,majorNumber,minorNumber);
    boolean success=false;
    String returnValue="";
    int timeout=300;
    if (pid > 0) {
      for (int i=0; i < 3; ++i) {
        returnValue=aoeStatus(pid);
        if (returnValue.length() == 0) {
          success=false;
        }
 else {
          success=true;
        }
        try {
          Thread.sleep(timeout);
        }
 catch (        InterruptedException ie) {
          LOG.error(ie);
        }
      }
    }
    if (!success) {
      throw new EucalyptusCloudException("Could not export AoE device " + absoluteLVName + " StorageInfo.getStorageInfo().getStorageInterface(): "+ DirectStorageInfo.getStorageInfo().getStorageInterface()+ " pid: "+ pid+ " returnValue: "+ returnValue);
    }
    File vbladePidFile=new File(eucaHome + EUCA_VAR_RUN_PATH + "/vblade-"+ majorNumber+ minorNumber+ ".pid");
    FileOutputStream fileOutStream=null;
    try {
      fileOutStream=new FileOutputStream(vbladePidFile);
      String pidString=String.valueOf(pid);
      fileOutStream.write(pidString.getBytes());
    }
 catch (    Exception ex) {
      LOG.error("Could not write pid file vblade-" + majorNumber + minorNumber+ ".pid");
    }
 finally {
      if (fileOutStream != null)       try {
        fileOutStream.close();
      }
 catch (      IOException e) {
        LOG.error(e);
      }
    }
    if (pid < 0)     throw new EucalyptusCloudException("invalid vblade pid: " + pid);
    aoeVolumeInfo.setVbladePid(pid);
    return pid;
  }
 else   if (exportManager instanceof ISCSIManager) {
    ISCSIVolumeInfo iscsiVolumeInfo=(ISCSIVolumeInfo)lvmVolumeInfo;
    exportManager.allocateTarget(iscsiVolumeInfo);
    String absoluteLVName=lvmRootDirectory + PATH_SEPARATOR + vgName+ PATH_SEPARATOR+ lvName;
    ((ISCSIManager)exportManager).exportTarget(iscsiVolumeInfo.getTid(),iscsiVolumeInfo.getStoreName(),iscsiVolumeInfo.getLun(),absoluteLVName,iscsiVolumeInfo.getStoreUser());
  }
  return 0;
}
