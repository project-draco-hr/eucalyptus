{
  if (EucalyptusProperties.disableNetworking) {
    return;
  }
 else   if (addresses.size() < runningVms.size()) {
    LOG.error("Number of running VMs is greater than number of assigned addresses!");
  }
 else {
    AddressManager.updateAddressingMode();
    for (    VmInfo vm : runningVms) {
      String addr=addresses.remove(0);
      try {
        vm.getNetParams().setIgnoredPublicIp(addr);
        AssociateAddressType msg=new AssociateAddressType(addr,vm.getInstanceId());
        msg.setUserId(vm.getOwnerId());
        msg.setEffectiveUserId(EucalyptusProperties.NAME);
        new AddressManager().AssociateAddress(msg);
      }
 catch (      Exception e) {
        LOG.error(e);
      }
    }
  }
  for (  String addr : addresses) {
    try {
      new AddressManager().ReleaseAddress(Admin.makeMsg(ReleaseAddressType.class,addr));
      LOG.warn("Released unused public address: " + addr);
    }
 catch (    EucalyptusCloudException e) {
    }
  }
}
