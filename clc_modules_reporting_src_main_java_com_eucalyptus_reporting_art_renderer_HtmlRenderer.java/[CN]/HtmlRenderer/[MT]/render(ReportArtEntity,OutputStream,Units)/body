{
  Writer writer=new OutputStreamWriter(os);
  writer.write("<html><body>\n");
  writer.write("<h1>Instance Report</h1>\n");
  writer.write("<h4>Begin:" + ms2Date(report.getBeginMs()) + "</h4>\n");
  writer.write("<h4>End:" + ms2Date(report.getEndMs()) + "</h4>\n");
  writer.write("<table border=0>\n");
  writer.write((new Row()).addEmptyCols(6,50).addEmptyCols(3,35).addCol("Net In GB-Days",35,3,"center").addCol("Net Out GB-Days",35,3,"center").toString());
  writer.write((new Row()).addEmptyCols(6,50).addCol("InstanceId").addCol("Type").addCol("CpuUsage%").addCol("Between").addCol("Within").addCol("Public").addCol("Between").addCol("Within").addCol("Public").toString());
  for (  String zoneName : report.getZones().keySet()) {
    AvailabilityZoneArtEntity zone=report.getZones().get(zoneName);
    writer.write((new InsRow()).addCol("Zone:" + zoneName,50,3,"left").addEmptyCols(3,50).addCol("cumul.").addCol("cumul.").addUsageCols(zone.getUsageTotals().getInstanceTotals(),units).toString());
    for (    String clusterName : zone.getClusters().keySet()) {
      ClusterArtEntity cluster=zone.getClusters().get(clusterName);
      writer.write((new InsRow()).addEmptyCols(1,50).addCol("Cluster: " + clusterName,50,3,"left").addEmptyCols(2,50).addCol("cumul.").addCol("cumul.").addUsageCols(zone.getUsageTotals().getInstanceTotals(),units).toString());
      for (      String accountName : cluster.getAccounts().keySet()) {
        AccountArtEntity account=cluster.getAccounts().get(accountName);
        writer.write((new InsRow()).addEmptyCols(2,50).addCol("Account: " + accountName,50,3,"left").addEmptyCols(1,50).addCol("cumul.").addCol("cumul.").addUsageCols(zone.getUsageTotals().getInstanceTotals(),units).toString());
        for (        String userName : account.getUsers().keySet()) {
          UserArtEntity user=account.getUsers().get(userName);
          writer.write((new InsRow()).addEmptyCols(3,50).addCol("User: " + userName,50,3,"left").addCol("cumul.").addCol("cumul.").addUsageCols(zone.getUsageTotals().getInstanceTotals(),units).toString());
          for (          String instanceUuid : user.getInstances().keySet()) {
            InstanceArtEntity instance=user.getInstances().get(instanceUuid);
            writer.write((new InsRow()).addEmptyCols(6,50).addCol(instance.getInstanceId()).addCol(instance.getInstanceType()).addUsageCols(zone.getUsageTotals().getInstanceTotals(),units).toString());
          }
        }
      }
    }
  }
  writer.write("</table>\n");
  writer.write("</body></html>\n");
  writer.flush();
}
