{
  EntityTransaction osgdb=Entities.get(ObjectEntity.class);
  try {
    List<ObjectEntity> osgObjects=Entities.query(new ObjectEntity());
    if (osgObjects != null && osgObjects.isEmpty()) {
      EntityTransaction walrusdb=Entities.get(ObjectInfo.class);
      try {
        List<ObjectInfo> walrusObjects=Entities.query(new ObjectInfo(),Boolean.TRUE);
        if (walrusObjects != null && !walrusObjects.isEmpty()) {
          for (          ObjectEntity osgObject : Lists.transform(walrusObjects,objectTransformationFunction())) {
            if (osgObject != null) {
              try {
                Entities.persist(osgObject);
              }
 catch (              Exception e) {
                LOG.warn("Failed to persist object " + osgObject.getObjectKey() + " to osg",e);
              }
            }
 else {
              throw new Exception("Failed to convert Walrus object to OSG object");
            }
          }
        }
 else {
        }
        walrusdb.commit();
      }
 catch (      Exception e) {
        walrusdb.rollback();
        throw e;
      }
 finally {
        if (walrusdb.isActive()) {
          walrusdb.commit();
        }
      }
    }
 else {
    }
    osgdb.commit();
  }
 catch (  Exception e) {
    osgdb.rollback();
    throw e;
  }
 finally {
    if (osgdb.isActive()) {
      osgdb.commit();
    }
  }
}
