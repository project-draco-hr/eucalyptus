{
  EntityTransaction tran=Entities.get(WalrusSnapshotInfo.class);
  try {
    List<WalrusSnapshotInfo> walrusSnapshots=Entities.query(new WalrusSnapshotInfo(),Boolean.TRUE);
    for (    WalrusSnapshotInfo walrusSnapshot : walrusSnapshots) {
      walrusSnapshotBuckets.add(walrusSnapshot.getSnapshotBucket());
      walrusSnapshotObjects.add(walrusSnapshot.getSnapshotId());
    }
    tran.commit();
  }
 catch (  Exception e) {
    LOG.error("Failed to lookup snapshots stored in Walrus",e);
    tran.rollback();
    throw e;
  }
 finally {
    if (tran.isActive()) {
      tran.commit();
    }
  }
}
