{
  InputStream in=SystemState.class.getResourceAsStream(ruleFile);
  Reader source=new InputStreamReader(in);
  PackageBuilderConfiguration pkgBuilderCfg=new PackageBuilderConfiguration();
  JavaDialectConfiguration javaConf=(JavaDialectConfiguration)pkgBuilderCfg.getDialectConfiguration("java");
  javaConf.setCompiler(JavaDialectConfiguration.JANINO);
  PackageBuilder builder=new PackageBuilder(pkgBuilderCfg);
  builder.addPackageFromDrl(source);
  org.drools.rule.Package pkg=builder.getPackage();
  if (pkg != null) {
    RuleBase ruleBase=RuleBaseFactory.newRuleBase();
    ruleBase.addPackage(pkg);
    StatefulSession workingMemory=ruleBase.newStatefulSession();
    for (    VmInstance v : VmInstances.getInstance().listValues())     workingMemory.insert(v);
    return workingMemory;
  }
  return null;
}
