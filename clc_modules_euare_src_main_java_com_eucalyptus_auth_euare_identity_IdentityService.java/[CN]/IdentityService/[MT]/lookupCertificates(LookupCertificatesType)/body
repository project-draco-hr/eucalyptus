{
  final LookupCertificatesResponseType response=request.getReply();
  final LookupCertificatesResult result=new LookupCertificatesResult();
  final ArrayList<String> pemCertificates=Lists.newArrayList();
  try {
    for (    final User user : com.eucalyptus.auth.euare.Accounts.lookupAccountById(request.getAccountNumber()).getUsers()) {
      Iterables.addAll(pemCertificates,Iterables.transform(Iterables.filter(user.getCertificates(),CollectionUtils.propertyPredicate(false,revoked())),new Function<Certificate,String>(){
        @Nullable @Override public String apply(        final Certificate certificate){
          return B64.url.decString(certificate.getPem());
        }
      }
));
    }
  }
 catch (  AuthException e) {
    throw handleException(e);
  }
  result.setPem(pemCertificates);
  response.setLookupCertificatesResult(result);
  return response;
}
