{
  if (!SystemBootstrapper.getDatabaseBootstrapper().isRunning()) {
    LOG.fatal(LogUtil.header("Database is not running.  Attempting to recover by reloading."));
    System.exit(123);
  }
 else {
    if (MAX_FAIL > failCount) {
      LOG.warn(LogUtil.subheader("Error using or obtaining a database connection, will try till " + (MAX_FAIL - failCount++) + ">"+ MAX_FAIL+ " more times before reloading."));
    }
 else     if (MAX_XTREME_FAIL > failCount++) {
      for (      PooledDataSource ds : (Set<PooledDataSource>)C3P0Registry.getPooledDataSources()) {
        try {
          LOG.warn("-> Resetting hard: " + ds.getDataSourceName());
          ds.hardReset();
        }
 catch (        Throwable e1) {
        }
      }
    }
 else {
      LOG.warn("-> Database performance severely degraded. Restarting.");
      failCount=0;
      System.exit(123);
    }
  }
}
