{
  SystemState.returnNetworkIndex(vm);
  final Address address=Addresses.getInstance().lookup(vm.getNetworkConfig().getIgnoredPublicIp());
  new TerminateCallback(vm.getInstanceId()).onSuccess(new SuccessCallback(){
    public void apply(    Object t){
      if (address.isSystemOwned()) {
        LOG.debug(EventRecord.caller(SystemState.class,EventType.VM_TERMINATING,"SYSTEM_ADDRESS",address.toString()));
        Addresses.release(address);
      }
 else {
        LOG.debug(EventRecord.caller(SystemState.class,EventType.VM_TERMINATING,"USER_ADDRESS",address.toString()));
        Addresses.unassign(address);
      }
    }
  }
).dispatch(vm.getPlacement());
}
