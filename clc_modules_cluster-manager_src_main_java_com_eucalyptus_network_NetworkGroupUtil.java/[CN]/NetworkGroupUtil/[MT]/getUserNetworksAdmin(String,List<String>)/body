{
  List<SecurityGroupItemType> groupInfoList=Lists.newArrayList();
  if (groupNames.isEmpty()) {
    try {
      for (      User u : Users.listAllUsers()) {
        groupInfoList.addAll(NetworkGroupUtil.getUserNetworks(u.getUserId(),groupNames));
      }
    }
 catch (    AuthException e) {
      throw new EucalyptusCloudException("Fail to get all users",e);
    }
  }
 else {
    for (    String groupName : groupNames) {
      if (!NetworkGroupUtil.isUserGroupRef(groupName)) {
        groupInfoList.addAll(NetworkGroupUtil.getUserNetworks(userId,Lists.newArrayList(groupName)));
      }
 else {
        groupInfoList.addAll(NetworkGroupUtil.getUserNetworksAdmin(groupName));
      }
    }
  }
  return groupInfoList;
}
