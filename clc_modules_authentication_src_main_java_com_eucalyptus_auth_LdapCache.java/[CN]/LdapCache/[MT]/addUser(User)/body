{
  LOG.debug("Adding user " + user);
  if (userCache.size() >= MAX_CACHE_SIZE) {
    LOG.debug("Cache size exceeded.");
    return;
  }
  userCache.put(user.getName(),user);
  userQueryIdMap.put(user.getQueryId(),user.getName());
  for (  X509Cert cert : ((LdapWrappedUser)user).getCertificates()) {
    if (cert.isRevoked()) {
      userRevokedCertMap.put(cert.getPemCertificate(),user.getName());
    }
 else {
      userCertMap.put(cert.getPemCertificate(),user.getName());
    }
  }
}
