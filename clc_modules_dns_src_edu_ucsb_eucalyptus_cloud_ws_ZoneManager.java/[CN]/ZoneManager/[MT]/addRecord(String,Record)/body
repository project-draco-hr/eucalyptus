{
  Zone zone=getZone(nameString);
  if (zone == null) {
    try {
      Record[] records=new Record[1];
      records[0]=record;
      Name name=Name.fromString(nameString);
      long soaTTL=604800;
      long serial=1;
      long refresh=604800;
      long retry=86400;
      long expires=2419200;
      long minimum=604800;
      Record soarec=new SOARecord(name,DClass.IN,soaTTL,Name.root,Name.root,serial,refresh,retry,expires,minimum);
      long nsTTL=0;
      Record nsrec=new NSRecord(name,DClass.IN,nsTTL,Name.root);
      zone=zones.putIfAbsent(name,new Zone(name,new Record[]{soarec,nsrec,record}));
      if (zone == null) {
        zone=zones.get(name);
        EntityWrapper<ZoneInfo> db=new EntityWrapper<ZoneInfo>();
        ZoneInfo zoneInfo=new ZoneInfo(nameString);
        db.add(zoneInfo);
        EntityWrapper<SOARecordInfo> dbSOA=db.recast(SOARecordInfo.class);
        SOARecordInfo soaRecordInfo=new SOARecordInfo();
        soaRecordInfo.setName(nameString);
        soaRecordInfo.setRecordclass(DClass.IN);
        soaRecordInfo.setNameserver(Name.root.toString());
        soaRecordInfo.setAdmin(Name.root.toString());
        soaRecordInfo.setZone(nameString);
        soaRecordInfo.setSerialNumber(serial);
        soaRecordInfo.setTtl(soaTTL);
        soaRecordInfo.setExpires(expires);
        soaRecordInfo.setMinimum(minimum);
        soaRecordInfo.setRefresh(refresh);
        soaRecordInfo.setRetry(retry);
        dbSOA.add(soaRecordInfo);
        EntityWrapper<NSRecordInfo> dbNS=db.recast(NSRecordInfo.class);
        NSRecordInfo nsRecordInfo=new NSRecordInfo();
        nsRecordInfo.setName(nameString);
        nsRecordInfo.setZone(nameString);
        nsRecordInfo.setRecordClass(DClass.IN);
        nsRecordInfo.setTarget(Name.root.toString());
        nsRecordInfo.setTtl(nsTTL);
        dbNS.add(nsRecordInfo);
        db.commit();
      }
    }
 catch (    Exception ex) {
      LOG.error(ex);
    }
  }
 else {
    zone.addRecord(record);
  }
}
