{
  MuleEvent context=RequestContext.getEvent();
  try {
    return this.getNioClient().send(msg);
  }
 catch (  Exception e) {
    LOG.error(e,e);
    Throwable rootCause=e;
    while (rootCause.getCause() != null || !(rootCause instanceof EucalyptusRemoteFault)) {
      rootCause=rootCause.getCause();
    }
    if (rootCause instanceof EucalyptusRemoteFault) {
      EucalyptusRemoteFault remoteFault=(EucalyptusRemoteFault)rootCause;
      throw new EucalyptusCloudException(" " + remoteFault.getFaultString());
    }
 else {
      throw new EucalyptusCloudException(msg.getClass().getSimpleName() + ": " + rootCause.getMessage(),rootCause);
    }
  }
 finally {
    RequestContext.setEvent(context);
  }
}
