{
  Service service=null;
  if (this.serviceRegistry.hasService(configuration)) {
    service=this.serviceRegistry.lookup(configuration);
  }
 else {
    try {
      service=this.serviceRegistry.register(configuration);
    }
 catch (    ServiceRegistrationException ex) {
      LOG.error(ex,ex);
      throw ex;
    }
  }
  return ServiceTransitions.pathTo(configuration,State.NOTREADY);
}
