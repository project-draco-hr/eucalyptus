{
  Service service=Services.newServiceInstance(config);
  if (config.isVmLocal() || config.isHostLocal()) {
    this.localService.set(service);
  }
  Service ret=this.services.putIfAbsent(config,service);
  ret=(ret != null) ? ret : service;
  EventRecord.caller(Component.class,EventType.COMPONENT_SERVICE_REGISTERED,Component.this.getName(),(config.isVmLocal() || config.isHostLocal()) ? "local" : "remote",config.getName(),config.getUri()).info();
  Logs.exhaust().debug("Registered service " + ret + " for configuration: "+ config);
  return ret;
}
