{
  ComplexService ret=this.services.remove(fullName);
  if (ret == null) {
    throw new NoSuchElementException("Failed to lookup service corresponding to full-name: " + fullName);
  }
 else   if (ret.getServiceConfiguration().isLocal()) {
    this.localService.compareAndSet(ret,null);
  }
  return ret;
}
