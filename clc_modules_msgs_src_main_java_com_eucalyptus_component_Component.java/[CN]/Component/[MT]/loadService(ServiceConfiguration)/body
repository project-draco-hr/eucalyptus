{
  Service service=new Service(this,config);
  this.setupService(service);
  if (service.isLocal() && State.INITIALIZED.equals(this.getState())) {
    try {
      return this.stateMachine.transition(Transition.LOADING);
    }
 catch (    Throwable ex) {
      throw new ServiceRegistrationException("Failed to load service: " + config + " because of: "+ ex.getMessage(),ex);
    }
  }
 else {
    throw Exceptions.trace(new ServiceRegistrationException("Failed to load remote service: " + config));
  }
}
