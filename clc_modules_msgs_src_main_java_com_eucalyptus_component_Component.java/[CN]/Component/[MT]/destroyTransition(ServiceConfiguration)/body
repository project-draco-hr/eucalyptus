{
  try {
    Service service=null;
    if (this.serviceRegistry.hasService(configuration)) {
      service=this.serviceRegistry.lookup(configuration);
      this.serviceRegistry.deregister(configuration);
    }
    try {
      ServiceTransitions.stopTransitionChain(configuration).get();
    }
 catch (    ExecutionException ex1) {
      configuration.error(ex1);
    }
catch (    InterruptedException ex1) {
      configuration.error(ex1);
    }
    try {
      EventRecord.caller(Component.class,EventType.COMPONENT_SERVICE_DESTROY,this.getName(),configuration.getFullName(),configuration.getUri().toString()).info();
      return configuration.lookupStateMachine().transitionByName(Transition.DESTROYING);
    }
 catch (    Throwable ex) {
      throw new ServiceRegistrationException("Failed to destroy service: " + configuration + " because of: "+ ex.getMessage(),ex);
    }
  }
 catch (  NoSuchElementException ex) {
    throw new ServiceRegistrationException("Failed to find service corresponding to: " + configuration,ex);
  }
}
