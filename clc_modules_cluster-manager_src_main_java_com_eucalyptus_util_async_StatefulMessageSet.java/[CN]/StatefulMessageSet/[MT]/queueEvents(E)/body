{
  for (  final Request event : this.messages.get(state)) {
    if (event.getCallback() instanceof BroadcastCallback) {
      final BroadcastCallback callback=(BroadcastCallback)event.getCallback();
      this.pendingEvents.addAll(Lists.transform(Clusters.getInstance().listValues(),new Function<Cluster,CheckedListenableFuture>(){
        @Override public CheckedListenableFuture apply(        final Cluster c){
          EventRecord.caller(StatefulMessageSet.class,EventType.VM_STARTING,state.name(),c.getName(),event.getClass().getSimpleName(),event.getRequest().toSimpleString()).info();
          EventRecord.caller(StatefulMessageSet.class,EventType.VM_STARTING,state.name(),c.getName(),event.getClass().getSimpleName(),event.getRequest()).debug();
          final Request request=AsyncRequests.newRequest(callback.newInstance());
          request.getRequest().regardingUserRequest(callback.getRequest());
          return request.dispatch(c.getConfiguration());
        }
      }
));
    }
 else {
      EventRecord.caller(StatefulMessageSet.class,EventType.VM_STARTING,state.name(),this.cluster.getName(),event.getClass().getSimpleName(),event.getRequest().toSimpleString()).info();
      EventRecord.caller(StatefulMessageSet.class,EventType.VM_STARTING,state.name(),this.cluster.getName(),event.getClass().getSimpleName(),event.getRequest()).debug();
      this.pendingEvents.add(event.dispatch(this.cluster.getConfiguration()));
    }
  }
}
