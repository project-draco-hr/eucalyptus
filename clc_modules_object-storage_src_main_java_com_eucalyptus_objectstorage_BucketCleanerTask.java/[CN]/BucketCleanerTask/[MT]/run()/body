{
  startTime=System.currentTimeMillis();
  try {
    LOG.trace("Initiating bucket cleanup task");
    final List<Bucket> buckets=BucketManagers.getInstance().list(null,true,null);
    if (buckets == null || buckets.size() <= 0) {
      LOG.trace("No buckets found to clean. Cleanup task complete");
      return;
    }
    Random rand=new Random(System.currentTimeMillis());
    Bucket b=null;
    int idx=0;
    while (buckets.size() > 0 && !isTimedOut()) {
      idx=rand.nextInt(buckets.size());
      b=buckets.get(idx);
      cleanObjectHistoriesInBucket(b);
      buckets.remove(idx);
    }
  }
 catch (  final Throwable f) {
    LOG.error("Error during bucket cleanup execution. Will retry later",f);
  }
 finally {
    try {
      long endTime=System.currentTimeMillis();
      LOG.trace("Bucket cleanup execution task took " + Long.toString(endTime - startTime) + "ms to complete");
    }
 catch (    final Throwable f) {
    }
  }
}
