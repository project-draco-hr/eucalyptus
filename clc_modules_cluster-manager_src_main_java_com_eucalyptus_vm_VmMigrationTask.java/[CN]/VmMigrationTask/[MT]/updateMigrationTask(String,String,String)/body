{
  MigrationState migrationState=MigrationState.defaultValueOf(state);
  boolean timerExpired=(System.currentTimeMillis() - this.getRefreshTimer().getTime()) > TimeUnit.SECONDS.toMillis(VmInstances.MIGRATION_REFRESH_TIME);
  if (!timerExpired && MigrationState.pending.equals(this.getState()) && migrationState.ordinal() < MigrationState.preparing.ordinal()) {
    return false;
  }
 else {
    boolean updated=!this.getState().equals(migrationState) || !this.getSourceHost().equals(sourceHost) || !this.getDestinationHost().equals(destinationHost);
    this.setState(migrationState);
    this.setSourceHost(sourceHost);
    this.setDestinationHost(destinationHost);
    if (MigrationState.none.equals(this.getState())) {
      this.setRefreshTimer(null);
      return updated || timerExpired;
    }
 else     if (timerExpired) {
      this.updateRefreshTimer();
      return true;
    }
 else {
      return updated;
    }
  }
}
