{
  AWSIAMRoleResourceAction action=(AWSIAMRoleResourceAction)resourceAction;
  ServiceConfiguration configuration=Topology.lookup(Euare.class);
  if (action.info.getPhysicalResourceId() == null)   return action;
  boolean seenAllRoles=false;
  boolean foundRole=false;
  String RoleMarker=null;
  while (!seenAllRoles && !foundRole) {
    ListRolesType listRolesType=MessageHelper.createMessage(ListRolesType.class,action.info.getEffectiveUserId());
    if (RoleMarker != null) {
      listRolesType.setMarker(RoleMarker);
    }
    ListRolesResponseType listRolesResponseType=AsyncRequests.<ListRolesType,ListRolesResponseType>sendSync(configuration,listRolesType);
    if (listRolesResponseType.getListRolesResult().getIsTruncated() == Boolean.TRUE) {
      RoleMarker=listRolesResponseType.getListRolesResult().getMarker();
    }
 else {
      seenAllRoles=true;
    }
    if (listRolesResponseType.getListRolesResult().getRoles() != null && listRolesResponseType.getListRolesResult().getRoles().getMember() != null) {
      for (      RoleType roleType : listRolesResponseType.getListRolesResult().getRoles().getMember()) {
        if (roleType.getRoleName().equals(action.info.getPhysicalResourceId())) {
          foundRole=true;
          break;
        }
      }
    }
  }
  if (!foundRole)   return action;
  if (action.properties.getPolicies() != null) {
    for (    EmbeddedIAMPolicy policy : action.properties.getPolicies()) {
      DeleteRolePolicyType deleteRolePolicyType=MessageHelper.createMessage(DeleteRolePolicyType.class,action.info.getEffectiveUserId());
      deleteRolePolicyType.setRoleName(action.info.getPhysicalResourceId());
      deleteRolePolicyType.setPolicyName(policy.getPolicyName());
      AsyncRequests.<DeleteRolePolicyType,DeleteRolePolicyResponseType>sendSync(configuration,deleteRolePolicyType);
    }
  }
  DeleteRoleType deleteRoleType=MessageHelper.createMessage(DeleteRoleType.class,action.info.getEffectiveUserId());
  deleteRoleType.setRoleName(action.info.getPhysicalResourceId());
  AsyncRequests.<DeleteRoleType,DeleteRoleResponseType>sendSync(configuration,deleteRoleType);
  return action;
}
