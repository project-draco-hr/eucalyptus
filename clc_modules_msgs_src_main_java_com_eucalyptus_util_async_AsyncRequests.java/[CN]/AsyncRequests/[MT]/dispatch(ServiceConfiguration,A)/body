{
  if (config.isVmLocal()) {
    final CheckedListenableFuture<B> future=Futures.newGenericeFuture();
    Threads.enqueue(Empyrean.class,AsyncRequests.class,new Callable<B>(){
      public B call(){
        try {
          B ret=ServiceContext.send(config.getComponentId(),msg);
          future.set(ret);
        }
 catch (        Exception ex) {
          future.setException(ex);
        }
        return null;
      }
    }
);
    return future;
  }
 else {
    Request<A,B> req=newRequest(new MessageCallback<A,B>(){
{
        this.setRequest(msg);
      }
      @Override public void fire(      B msg){
        Logs.extreme().debug(msg.toSimpleString());
      }
    }
);
    return req.dispatch(config);
  }
}
