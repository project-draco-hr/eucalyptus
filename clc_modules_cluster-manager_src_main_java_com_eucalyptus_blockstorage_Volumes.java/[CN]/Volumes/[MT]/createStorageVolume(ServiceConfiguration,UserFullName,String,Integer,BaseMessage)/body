{
  final String newId=Crypto.generateId(owner.getUniqueId(),ID_PREFIX);
  final Volume newVol=Transactions.save(Volume.create(sc,owner,snapId,newSize,newId),new Callback<Volume>(){
    @Override public void fire(    final Volume t){
      t.setState(State.GENERATING);
      try {
        ListenerRegistry.getInstance().fireEvent(new StorageEvent(StorageEvent.EventType.EbsVolume,true,t.getSize(),t.getOwnerUserId(),t.getOwnerUserName(),t.getOwnerAccountNumber(),t.getOwnerAccountName(),t.getScName(),t.getPartition()));
        final CreateStorageVolumeType req=new CreateStorageVolumeType(t.getDisplayName(),t.getSize(),snapId,null).regardingUserRequest(request);
        AsyncRequests.sendSync(sc,req);
      }
 catch (      final Exception ex) {
        LOG.error("Failed to create volume: " + t.toString(),ex);
        throw Exceptions.toUndeclared(ex);
      }
    }
  }
);
  return newVol;
}
