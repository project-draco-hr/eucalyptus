{
  final String newId=Crypto.generateId(owner.getAccountNumber(),ID_PREFIX);
  final Volume newVol=Transactions.save(new Volume(owner,newId,newSize,sc.getName(),sc.getPartition(),snapId),new Callback<Volume>(){
    @Override public void fire(    final Volume t){
      t.setState(State.GENERATING);
      try {
        ListenerRegistry.getInstance().fireEvent(new StorageEvent(StorageEvent.EventType.EbsVolume,true,t.getSize(),t.getOwnerUserId(),t.getOwnerUserName(),t.getOwnerAccountNumber(),t.getOwnerAccountName(),t.getScName(),t.getPartition()));
        final CreateStorageVolumeType req=new CreateStorageVolumeType(t.getDisplayName(),t.getSize(),snapId,null).regardingUserRequest(request);
        ServiceDispatcher.lookup(sc).send(req);
      }
 catch (      final Exception ex) {
        LOG.error("Failed to create volume: " + t.toString(),ex);
        throw new UndeclaredThrowableException(ex);
      }
    }
  }
);
  return newVol;
}
