{
  String clusterName=c.getName();
  if (Clusters.getInstance().contains(clusterName)) {
    return Clusters.getInstance().lookup(clusterName);
  }
 else {
    ClusterCredentials credentials=null;
    EntityWrapper<ClusterCredentials> credDb=Authentication.getEntityWrapper();
    try {
      credentials=credDb.getUnique(new ClusterCredentials(c.getName()));
      credDb.rollback();
    }
 catch (    EucalyptusCloudException e) {
      LOG.error("Failed to load credentials for cluster: " + c.getName());
      credDb.rollback();
      throw e;
    }
    Cluster newCluster=new Cluster(c,credentials);
    Clusters.getInstance().register(newCluster);
    try {
      registerClusterStateHandler(newCluster);
      ListenerRegistry.getInstance().fireEvent(new NewClusterEvent().setMessage(newCluster));
    }
 catch (    EventVetoedException ex) {
      LOG.error(ex,ex);
    }
    return newCluster;
  }
}
