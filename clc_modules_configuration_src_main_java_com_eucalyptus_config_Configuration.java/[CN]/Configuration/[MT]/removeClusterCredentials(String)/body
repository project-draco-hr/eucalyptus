{
  EntityWrapper<ClusterCredentials> credDb=Credentials.getEntityWrapper();
  try {
    ClusterCredentials clusterCredentials=new ClusterCredentials(clusterName);
    String directory=SubDirectory.KEYS.toString() + File.separator + clusterName;
    credDb.delete(clusterCredentials);
    File keyDir=new File(directory);
    for (    File f : keyDir.listFiles()) {
      if (!f.delete()) {
        LOG.warn("Failed to delete key file: " + f.getAbsolutePath());
      }
    }
    if (!keyDir.delete()) {
      LOG.warn("Failed to delete key directory: " + keyDir.getAbsolutePath());
    }
  }
 catch (  Exception e) {
    credDb.rollback();
  }
  credDb.commit();
}
