{
  RegisterComponentResponseType reply=(RegisterComponentResponseType)request.getReply();
  reply.set_return(false);
  String name=request.getName();
  String hostName=request.getHost();
  Integer port=request.getPort();
  ServiceBuilder builder=builders.get(request.getClass());
  LOG.info("Using builder: " + builder.getClass().getSimpleName() + " for: "+ name+ "@"+ hostName+ ":"+ port);
  if (!builder.checkAdd(name,hostName,port)) {
    LOG.info(builder.getClass().getSimpleName() + ": checkAdd failed.");
    return reply;
  }
  try {
    ServiceConfiguration newComponent=builder.add(name,hostName,port);
    builder.getComponent().buildService(newComponent);
    builder.getComponent().startService(newComponent);
    reply.set_return(true);
  }
 catch (  EucalyptusCloudException e) {
    LOG.info(builder.getClass().getSimpleName() + ": add failed.");
    LOG.info(e.getMessage());
    LOG.error(e,e);
    throw e;
  }
catch (  Throwable e) {
    LOG.info(builder.getClass().getSimpleName() + ": add failed.");
    LOG.info(e.getMessage());
    LOG.error(e,e);
    throw new ServiceRegistrationException(e);
  }
  return reply;
}
