{
  RegisterComponentResponseType reply=(RegisterComponentResponseType)request.getReply();
  reply.set_return(true);
  if (this.checkComponentExists(request)) {
    return reply;
  }
  EntityWrapper<ComponentConfiguration> db=Configuration.getEntityWrapper();
  ComponentConfiguration newComponent;
  try {
    newComponent=Configuration.getConfigurationInstance(request,request.getName(),request.getHost(),request.getPort());
    db.add(newComponent);
    db.commit();
  }
 catch (  Exception e) {
    db.rollback();
    LOG.error(e,e);
    throw new EucalyptusCloudException(e);
  }
  if (request instanceof RegisterClusterType) {
    Configuration.setupClusterCredentials(newComponent);
  }
  return reply;
}
