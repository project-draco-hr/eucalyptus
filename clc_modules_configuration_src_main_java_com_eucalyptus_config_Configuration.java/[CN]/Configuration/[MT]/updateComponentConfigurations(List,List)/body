{
  try {
    ArrayList<ComponentConfiguration> addComponents=Lists.newArrayList(newComponentConfigs);
    List<ComponentConfiguration> removeComponents=new ArrayList<ComponentConfiguration>(componentConfigs);
    addComponents.removeAll(componentConfigs);
    removeComponents.removeAll(newComponentConfigs);
    LOG.info("Planning to updating configs with: ");
    LOG.info("-> add: " + addComponents);
    LOG.info("-> remove: " + removeComponents);
    for (    ComponentConfiguration config : removeComponents) {
      DeregisterComponentType regComponent=null;
      if (config instanceof StorageControllerConfiguration) {
        regComponent=new DeregisterStorageControllerType();
      }
 else       if (config instanceof WalrusConfiguration) {
        regComponent=new DeregisterWalrusType();
      }
 else       if (config instanceof ClusterConfiguration) {
        regComponent=new DeregisterClusterType();
      }
 else {
        regComponent=new DeregisterComponentType();
      }
      regComponent.setName(config.getName());
      new Configuration().deregisterComponent(regComponent);
    }
    for (    ComponentConfiguration config : addComponents) {
      RegisterComponentType regComponent=null;
      if (config instanceof StorageControllerConfiguration) {
        regComponent=new RegisterStorageControllerType();
      }
 else       if (config instanceof WalrusConfiguration) {
        regComponent=new RegisterWalrusType();
      }
 else       if (config instanceof ClusterConfiguration) {
        regComponent=new RegisterClusterType();
      }
 else {
        regComponent=new RegisterComponentType();
      }
      regComponent.setName(config.getName());
      regComponent.setHost(config.getHostName());
      regComponent.setPort(config.getPort());
      new Configuration().registerComponent(regComponent);
    }
  }
 catch (  Exception e) {
    throw new EucalyptusCloudException("Changing component configurations failed: " + e.getMessage(),e);
  }
}
