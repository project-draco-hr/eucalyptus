{
  String sessionId=null;
  UserInfoWeb user;
  if (userId == null) {
    throw new SerializableException("Invalid RPC arguments: user ID is missing");
  }
  if (password == null) {
    throw new SerializableException("Invalid RPC arguments: password is missing");
  }
  String account=null;
  int slash=userId.indexOf('/');
  if (slash > 0) {
    account=userId.substring(0,slash);
  }
  userId=userId.substring(slash + 1);
  if (account == null || "".equals(account)) {
    account=Account.SYSTEM_ACCOUNT;
  }
  user=verifyUser(null,userId,account,false);
  if (!user.getPassword().equals(Crypto.generateHashedPassword(password))) {
    throw new SerializableException("Incorrect password");
  }
  sessionId=ServletUtils.genGUID();
  SessionInfo session=new SessionInfo(sessionId,userId,account,System.currentTimeMillis());
  session.setStartedOn(session.getLastAccessed());
  sessions.put(session.getSessionId(),session);
  return session.getSessionId();
}
