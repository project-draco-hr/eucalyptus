{
  UserInfoWeb user;
  if (userName == null) {
    throw new SerializableException("Invalid RPC arguments: userIname is missing");
  }
  try {
    user=EucalyptusManagement.getWebUser(userName);
  }
 catch (  Exception e) {
    if (session != null) {
      sessions.remove(session.getSessionId());
    }
    throw new SerializableException("Username '" + userName + "' not found");
  }
  if (!user.isApproved()) {
    throw new SerializableException("User not approved yet");
  }
  if (!user.isEnabled()) {
    throw new SerializableException("Disabled user account");
  }
  if (!user.isConfirmed()) {
    throw new SerializableException("Unconfirmed account (click on the link in confirmation email)");
  }
  if (verifyPasswordAge) {
    if (isPasswordExpired(user) && !(user.isAdministrator() && user.getEmail().equalsIgnoreCase(UserInfo.BOGUS_ENTRY))) {
      throw new SerializableException("Password expired");
    }
  }
  return user;
}
