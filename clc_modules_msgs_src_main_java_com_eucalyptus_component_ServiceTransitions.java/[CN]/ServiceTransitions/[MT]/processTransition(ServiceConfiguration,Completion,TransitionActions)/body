{
  ServiceTransitionCallback trans=null;
  try {
    if (Hosts.isServiceLocal(parent)) {
      trans=ServiceLocalTransitionCallbacks.valueOf(transitionAction.name());
    }
 else     if (Hosts.isCoordinator()) {
      trans=CloudRemoteTransitionCallbacks.valueOf(transitionAction.name());
    }
 else {
      trans=ServiceRemoteTransitionNotification.valueOf(transitionAction.name());
    }
    if (trans != null) {
      Logs.exhaust().debug("Executing transition: " + trans.getClass() + "."+ transitionAction.name()+ " for "+ parent);
      trans.fire(parent);
    }
    transitionCallback.fire();
  }
 catch (  Exception ex) {
    LOG.error(ex);
    if (Faults.filter(parent,ex)) {
      transitionCallback.fireException(ex);
      throw Exceptions.toUndeclared(ex);
    }
 else {
      transitionCallback.fire();
    }
  }
}
