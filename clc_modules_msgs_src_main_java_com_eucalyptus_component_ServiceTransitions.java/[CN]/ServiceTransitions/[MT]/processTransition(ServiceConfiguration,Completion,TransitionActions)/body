{
  ServiceTransitionCallback trans=null;
  try {
    if (parent.isVmLocal() || (parent.isHostLocal() && Bootstrap.isCloudController())) {
      try {
        trans=LocalTransitionCallbacks.valueOf(transitionAction.name());
      }
 catch (      Exception ex) {
        LOG.error(ex,ex);
        throw ex;
      }
    }
 else     if (Bootstrap.isCloudController()) {
      try {
        trans=RemoteTransitionCallbacks.valueOf(transitionAction.name());
      }
 catch (      Exception ex) {
        LOG.error(ex,ex);
        throw ex;
      }
      LOG.debug("Executing transition: " + trans.getClass().getCanonicalName() + "."+ transitionAction.name()+ " for "+ parent);
      trans.fire(parent);
    }
 else {
      LOG.debug("Silentlty accepting remotely inferred state transition for " + parent);
    }
    transitionCallback.fire();
  }
 catch (  Throwable ex) {
    if (ServiceTransitions.filterExceptions(parent,ex,errorFilterCheckTransition(parent))) {
      transitionCallback.fireException(ex);
    }
 else {
      transitionCallback.fire();
    }
  }
}
