{
  ServiceConfiguration config=ServiceConfigurations.createEphemeral(Empyrean.INSTANCE,parent.getInetAddress());
  LOG.debug("Sending request " + msg.getClass().getSimpleName() + " to "+ parent.getFullName());
  for (int i=0; i < BOOTSTRAP_REMOTE_RETRIES; i++) {
    try {
      T reply=(T)AsyncRequests.sendSync(config,msg);
      return reply;
    }
 catch (    RetryableConnectionException ex) {
      try {
        TimeUnit.SECONDS.sleep(BOOTSTRAP_REMOTE_RETRY_INTERVAL);
      }
 catch (      InterruptedException ex1) {
        Thread.currentThread().interrupt();
      }
      continue;
    }
catch (    ExecutionException ex) {
      LOG.error(ex,ex);
      if (ex.getCause() instanceof RetryableConnectionException) {
        try {
          TimeUnit.SECONDS.sleep(BOOTSTRAP_REMOTE_RETRY_INTERVAL);
        }
 catch (        InterruptedException ex1) {
          Thread.currentThread().interrupt();
        }
        continue;
      }
 else {
        throw ex;
      }
    }
catch (    Exception ex) {
      LOG.error(ex,ex);
      throw ex;
    }
  }
  throw new ServiceRegistrationException("Failed to contact host after " + BOOTSTRAP_REMOTE_RETRIES + " retries: "+ config.getUri()+ " when sending message: "+ msg);
}
