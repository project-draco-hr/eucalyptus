{
  Callable<CheckedListenableFuture<ServiceConfiguration>> transition=null;
switch (config.lookupStateMachine().getState()) {
case NOTREADY:
case DISABLED:
case ENABLED:
    break;
case LOADED:
case STOPPED:
  transition=Automata.sequenceTransitions(config,Component.State.LOADED,Component.State.NOTREADY);
break;
case INITIALIZED:
transition=Automata.sequenceTransitions(config,Component.State.INITIALIZED,Component.State.LOADED,Component.State.NOTREADY);
break;
default :
throw new IllegalStateException("Failed to find transition for current component state: " + config.lookupComponent().toString());
}
CheckedListenableFuture<ServiceConfiguration> transitionResult=null;
try {
transitionResult=Threads.lookup(Empyrean.class).submit(transition).get();
}
 catch (InterruptedException ex) {
LOG.error(ex,ex);
transitionResult=Futures.predestinedFailedFuture(ex);
}
catch (ExecutionException ex) {
LOG.error(ex,ex);
transitionResult=Futures.predestinedFailedFuture(ex);
}
return transitionResult;
}
