{
  Component.State currState=config.lookupState();
  if (State.ENABLED.equals(currState)) {
    Callable<CheckedListenableFuture<ServiceConfiguration>> transition=Automata.sequenceTransitions(config,Component.State.ENABLED,Component.State.DISABLED,Component.State.STOPPED);
    try {
      return transition.call();
    }
 catch (    Exception ex) {
      LOG.error(ex,ex);
      throw new RuntimeException(ex);
    }
  }
 else   if (State.DISABLED.equals(currState) || State.NOTREADY.equals(currState)) {
    Callable<CheckedListenableFuture<ServiceConfiguration>> transition=Automata.sequenceTransitions(config,currState,Component.State.STOPPED);
    try {
      return transition.call();
    }
 catch (    Exception ex) {
      LOG.error(ex,ex);
      throw new RuntimeException(ex);
    }
  }
 else {
    return Futures.predestinedFuture(config);
  }
}
