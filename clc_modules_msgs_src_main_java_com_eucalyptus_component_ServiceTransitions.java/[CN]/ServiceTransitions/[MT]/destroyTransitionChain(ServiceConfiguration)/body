{
  if (!State.PRIMORDIAL.equals(config.lookupState())) {
    Callable<CheckedListenableFuture<ServiceConfiguration>> transition=Automata.sequenceTransitions(config,Component.State.ENABLED,Component.State.DISABLED,Component.State.STOPPED);
    Future<CheckedListenableFuture<ServiceConfiguration>> result=Threads.lookup(Empyrean.class,ServiceTransitions.class,config.getFullName().toString()).submit(transition);
    try {
      return result.get();
    }
 catch (    InterruptedException ex) {
      LOG.error(ex,ex);
      throw new UndeclaredThrowableException(ex);
    }
catch (    ExecutionException ex) {
      LOG.error(ex,ex);
      throw new UndeclaredThrowableException(ex.getCause());
    }
  }
 else {
    return Futures.predestinedFuture(config);
  }
}
