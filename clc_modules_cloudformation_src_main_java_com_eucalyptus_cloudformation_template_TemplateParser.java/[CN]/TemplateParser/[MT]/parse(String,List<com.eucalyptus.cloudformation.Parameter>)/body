{
  Map<String,String> paramMap=Maps.newHashMap();
  try {
    Template template=new Template();
    JSON templateJSON=JSONSerializer.toJSON(templateBody);
    if (!(templateJSON instanceof JSONObject)) {
      throw new ValidationErrorException("Template body is not a JSONObject");
    }
    JSONObject templateJSONObject=(JSONObject)templateJSON;
    parseValidTopLevelKeys(templateJSONObject);
    parseVersion(template,templateJSONObject);
    parseDescription(template,templateJSONObject);
    parseParameters(userParameters,paramMap,template,templateJSONObject);
    return template;
  }
 catch (  JSONException ex) {
    throw new ValidationErrorException(ex.getMessage());
  }
}
