{
  CompleteMultipartUploadResult result;
  try {
    LOG.info("Finalizing multipart upload: snapshotId=" + snapshotId + ", bucketName="+ bucketName+ ", keyName="+ keyName+ ", uploadId="+ uploadId);
    result=s3.completeMultipartUpload(new CompleteMultipartUploadRequest(bucketName,keyName,uploadId,partETags));
  }
 catch (  Exception ex) {
    LOG.debug("Failed to finalize multipart upload for snapshotId=" + snapshotId + ", bucketName="+ ", keyName="+ keyName,ex);
    throw new SnapshotFinalizeMpuException("Failed to initialize multipart upload part after for snapshotId=" + snapshotId + ", bucketName="+ bucketName+ ", keyName="+ keyName);
  }
  return result.getETag();
}
