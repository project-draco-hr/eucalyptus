{
  final RunInstancesType runInstances=new RunInstancesType();
  runInstances.setKernelId(launchConfiguration.getKernelId());
  runInstances.setRamdiskId(launchConfiguration.getRamdiskId());
  runInstances.setImageId(launchConfiguration.getImageId());
  runInstances.setInstanceType(launchConfiguration.getInstanceType());
  runInstances.setMinCount(1);
  runInstances.setMaxCount(1);
  for (  final BlockDeviceMapping mapping : launchConfiguration.getBlockDeviceMappings()) {
    final BlockDeviceMappingItemType type=new BlockDeviceMappingItemType();
    type.setDeviceName(mapping.getDeviceName());
    type.setVirtualName(mapping.getVirtualName());
    final EbsParameters ebsParameters=mapping.getEbsParameters();
    if (ebsParameters != null) {
      final EbsDeviceMapping ebsType=new EbsDeviceMapping();
      ebsType.setSnapshotId(ebsParameters.getSnapshotId());
      ebsType.setVolumeSize(ebsParameters.getVolumeSize());
      ebsType.setDeleteOnTermination(true);
      type.setEbs(ebsType);
    }
    runInstances.getBlockDeviceMapping().add(type);
  }
  runInstances.setKeyName(launchConfiguration.getKeyName());
  runInstances.setGroupSet(Lists.newArrayList(launchConfiguration.getSecurityGroups()));
  runInstances.setMonitoring(launchConfiguration.getInstanceMonitoring());
  return runInstances;
}
