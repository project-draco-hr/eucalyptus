{
  this.scavenge();
  if (this.entries.add(e)) {
    TimestampedElement elem=new TimestampedElement(e);
    this.timestamps.add(elem);
    return true;
  }
 else {
    LOG.debug("Potential replay attack is detected [" + e + "]");
    Long now=System.nanoTime();
    Long adjust=TimeUnit.NANOSECONDS.convert(3,TimeUnit.SECONDS);
    Long timeNanos=now - adjust;
    TimestampedElement fakeElem=new TimestampedElement(e,timeNanos);
    NavigableSet<TimestampedElement> elems=this.timestamps.tailSet(fakeElem,true);
    for (Iterator<TimestampedElement> iter=elems.iterator(); iter.hasNext(); ) {
      TimestampedElement elem=iter.next();
      E sig=elem.get();
      if (e.equals(sig)) {
        LOG.debug("Found elem with signature " + sig + " with time "+ elem.timeNanos+ " <= "+ timeNanos);
        return true;
      }
    }
    return false;
  }
}
