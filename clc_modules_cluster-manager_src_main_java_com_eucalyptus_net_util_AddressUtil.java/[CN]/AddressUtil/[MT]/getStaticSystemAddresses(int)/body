{
  List<Address> addressList=Lists.newArrayList();
  for (  Address addr : Addresses.getInstance().listValues()) {
    if (!addr.isAssigned() && !addr.isPending() && Component.eucalyptus.name().equals(addr.getUserId())) {
      Addresses.getInstance().deregister(addr.getName());
      addressList.add(addr);
      if (addressList.size() >= count)       break;
    }
  }
  if (addressList.size() < count) {
    for (    Address putBackAddr : addressList) {
      Addresses.getInstance().register(putBackAddr);
    }
    throw new NotEnoughResourcesAvailable("Not enough resources available: addresses (try --addressing private)");
  }
  return addressList;
}
