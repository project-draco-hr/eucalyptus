{
  try {
    final AccessKey adminAccessKey=Accounts.lookupSystemAdmin().getKeys().get(0);
    this.importDisk.setAccessKey(adminAccessKey.getAccessKey());
    final Calendar c=Calendar.getInstance();
    c.add(Calendar.HOUR,48);
    final SimpleDateFormat sdf=new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.S'Z'");
    sdf.setTimeZone(TimeZone.getTimeZone("GMT"));
    final String expiration=sdf.format(c.getTime());
    final String policy=String.format("{\"expiration\":\"%s\",\"conditions\":[{\"bucket\": \"%s\"}," + "[\"starts-with\", \"$key\", \"%s\"],{\"acl\":\"aws-exec-read\"}]}",expiration,bucket,prefix);
    this.importDisk.setUploadPolicy(B64.standard.encString(policy));
    final Mac hmac=Mac.getInstance("HmacSHA1");
    hmac.init(new SecretKeySpec(adminAccessKey.getSecretKey().getBytes("UTF-8"),"HmacSHA1"));
    this.importDisk.setUploadPolicySignature(B64.standard.encString(hmac.doFinal(B64.standard.encString(policy).getBytes("UTF-8"))));
  }
 catch (  final Exception ex) {
    throw Exceptions.toUndeclared(ex);
  }
  return this;
}
