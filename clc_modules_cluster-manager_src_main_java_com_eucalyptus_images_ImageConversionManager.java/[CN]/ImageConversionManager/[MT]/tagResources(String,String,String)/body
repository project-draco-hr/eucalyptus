{
  final List<String> instances=this.lookupInstanceIds(imageId);
  if (tagState.containsKey(imageId) && state.equals(tagState.get(imageId))) {
    ;
  }
 else {
    resetTag(imageId,TAG_KEY_STATE,state);
    tagState.put(imageId,state);
  }
  for (  final String instanceId : instances) {
    if (tagState.containsKey(instanceId) && state.equals(tagState.get(instanceId))) {
      ;
    }
 else {
      resetTag(instanceId,TAG_KEY_STATE,state);
      tagState.put(instanceId,state);
    }
  }
  if (statusMessage == null)   statusMessage="";
  if (tagMessage.containsKey(imageId) && statusMessage.equals(tagMessage.get(imageId))) {
    ;
  }
 else {
    resetTag(imageId,TAG_KEY_MESSAGE,statusMessage);
    tagMessage.put(imageId,statusMessage);
  }
  for (  final String instanceId : instances) {
    if (tagMessage.containsKey(instanceId) && statusMessage.endsWith(tagMessage.get(instanceId))) {
      ;
    }
 else {
      resetTag(instanceId,TAG_KEY_MESSAGE,statusMessage);
      tagMessage.put(instanceId,statusMessage);
    }
  }
}
