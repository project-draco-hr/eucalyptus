{
  for (  final String imageId : images) {
    try {
      final ImageInfo image=Images.lookupImage(imageId);
      final ImageMetadata.State imgState=image.getState();
      final String taskId=((MachineImageInfo)image).getImageConversionId();
      if (ImageMetadata.State.pending_available.equals(imgState)) {
        ;
      }
 else       if (ImageMetadata.State.pending_conversion.equals(imgState)) {
        String message="";
        try {
          Optional<DiskImageConversionTask> task=conversionTaskCache.get(taskId);
          if (task.isPresent()) {
            message=task.get().getStatusMessage();
          }
        }
 catch (        final Exception ex) {
          ;
        }
        this.tagResources(imageId,"active",message);
        taggedImages.add(imageId);
      }
 else       if (ImageMetadata.State.available.equals(imgState) && taggedImages.contains(imageId)) {
        try {
          this.removeTags(imageId);
        }
 catch (        final Exception ex) {
          ;
        }
 finally {
          taggedImages.remove(imageId);
        }
      }
    }
 catch (    final Exception ex) {
      LOG.error("Failed to update tags for resources in conversion",ex);
    }
  }
}
