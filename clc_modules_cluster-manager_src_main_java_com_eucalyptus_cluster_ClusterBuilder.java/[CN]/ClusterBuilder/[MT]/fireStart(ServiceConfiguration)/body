{
  LOG.info("Starting up cluster: " + config);
  EventRecord.here(ClusterBuilder.class,EventType.COMPONENT_SERVICE_START,config.getComponentId().name(),config.getName(),config.getUri()).info();
  try {
    if (Components.lookup(Eucalyptus.class).isLocal()) {
      try {
        ClusterCredentials credentials=null;
        if (!Clusters.getInstance().contains(config.getName())) {
          EntityWrapper<ClusterCredentials> credDb=EntityWrapper.get(ClusterCredentials.class);
          try {
            credentials=credDb.getUnique(new ClusterCredentials(config.getName()));
            credDb.commit();
          }
 catch (          EucalyptusCloudException e) {
            LOG.error("Failed to load credentials for cluster: " + config.getName());
            credDb.rollback();
            throw e;
          }
          Cluster newCluster=new Cluster((ClusterConfiguration)config,credentials);
          Clusters.getInstance().register(newCluster);
          newCluster.start();
        }
      }
 catch (      EucalyptusCloudException ex) {
        LOG.error(ex,ex);
        throw new ServiceRegistrationException("Registration failed: " + ex.getMessage(),ex);
      }
      super.fireStart(config);
    }
  }
 catch (  NoSuchElementException ex) {
    LOG.error(ex,ex);
  }
}
