{
  EntityWrapper<ClusterConfiguration> db=EntityWrapper.get(ClusterConfiguration.class);
  try {
    Example ex=Example.create(new ClusterConfiguration(){
{
        setPartition(config.getPartition());
      }
    }
).enableLike(MatchMode.EXACT);
    Criteria criteria=db.createCriteria(ClusterConfiguration.class).setCacheable(true).add(ex).add(Property.forName("name").ne(config.getName()));
    List<ClusterConfiguration> configs=criteria.list();
    if (configs.size() == 0) {
      throw new NoSuchElementException(String.format("Failed to locate any distinct clusters from the partition: partition=%s name!=%s",config.getPartition(),config.getName()));
    }
 else {
      return configs;
    }
  }
 catch (  RuntimeException ex) {
    LOG.error(ex,ex);
    db.rollback();
    throw new NoSuchElementException(String.format("Error occurred while trying to locate distinct clusters from the partition: partition=%s name!=%s because of %s.",config.getPartition(),config.getName(),ex.getMessage()));
  }
}
