{
  try {
    final Partition part=Partitions.lookupByName(partition);
    part.syncKeysToDisk();
  }
 catch (  final Exception ex) {
    Logs.extreme().error(ex,ex);
    throw new ServiceRegistrationException(String.format("Unexpected error caused cluster registration to fail for: partition=%s name=%s host=%s port=%d",partition,name,host,port),ex);
  }
  if (!Partitions.testPartitionCredentialsDirectory(partition)) {
    throw new ServiceRegistrationException("Cluster registration failed because the key directory cannot be created.");
  }
 else {
    return super.checkAdd(partition,name,host,port);
  }
}
