{
  chooseFirstProvider();
  if (initialized == false) {
    throw new IllegalStateException("MAC not initialized");
  }
  byte[] mac=spi.engineDoFinal();
  spi.engineReset();
  return mac;
}
