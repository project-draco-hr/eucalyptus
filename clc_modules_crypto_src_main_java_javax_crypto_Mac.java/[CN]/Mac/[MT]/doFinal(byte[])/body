{
  chooseFirstProvider();
  if (initialized == false) {
    throw new IllegalStateException("MAC not initialized");
  }
  update(input);
  return doFinal();
}
