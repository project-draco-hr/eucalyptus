{
  for (  Class c : MetricEntityFactory.getAllClassesForEntitiesGet()) {
    EntityTransaction db=Entities.get(c);
    try {
      Map<String,Date> criteria=new HashMap<String,Date>();
      criteria.put("before",before);
      Entities.deleteAllMatching(c,"WHERE timestamp < :before",criteria);
      db.commit();
    }
 catch (    RuntimeException ex) {
      Logs.extreme().error(ex,ex);
      throw ex;
    }
 finally {
      if (db.isActive())       db.rollback();
    }
  }
}
