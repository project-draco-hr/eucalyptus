{
  if (!hasAdministrativePrivilege) {
    throw new AuthException(AuthException.ACCESS_DENIED);
  }
  Account newAccount=Accounts.addAccount(accountName);
  Map<String,String> info=null;
  if (email != null) {
    info=Maps.newHashMap();
    info.put(User.EMAIL,email);
  }
  User admin=newAccount.addUser(User.ACCOUNT_ADMIN,"/",true,true,info);
  admin.resetToken();
  admin.createConfirmationCode();
  if (password != null) {
    admin.setPassword(Crypto.generateHashedPassword(password));
    admin.setPasswordExpires(System.currentTimeMillis() + User.PASSWORD_LIFETIME);
  }
  return newAccount;
}
