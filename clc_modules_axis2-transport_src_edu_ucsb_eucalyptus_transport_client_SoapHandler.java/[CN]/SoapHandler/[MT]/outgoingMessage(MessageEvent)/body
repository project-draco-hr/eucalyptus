{
  Object o=event.getMessage();
  if (o instanceof MappingHttpRequest) {
    MappingHttpRequest httpRequest=(MappingHttpRequest)o;
    httpRequest.setEnvelope(soapFactory.getDefaultEnvelope());
    httpRequest.getEnvelope().getBody().addChild(httpRequest.getSourceElem());
    String action=httpRequest.getSourceElem().getLocalName();
    httpRequest.addHeader("SOAPAction",action);
    SOAPHeader header=httpRequest.getEnvelope().getHeader();
    OMNamespace wsaNs=OMAbstractFactory.getOMFactory().createOMNamespace(WSA_NAMESPACE,WSA_NAMESPACE_PREFIX);
    SOAPHeaderBlock wsaToHeader=header.addHeaderBlock(WSA_TO,wsaNs);
    wsaToHeader.setText(httpRequest.getUri());
    SOAPHeaderBlock wsaActionHeader=header.addHeaderBlock(WSA_ACTION,wsaNs);
    wsaActionHeader.setText(action);
    SOAPHeaderBlock wsaMsgId=header.addHeaderBlock(WSA_MESSAGE_ID,wsaNs);
    wsaMsgId.setText("urn:uuid:" + UUID.randomUUID().toString().replaceAll("-","").toUpperCase());
  }
}
