{
  InitiateMultipartUploadResult initResponse=null;
  try {
    LOG.info("Inititating multipart upload: snapshotId=" + snapshotId + ", bucketName="+ bucketName+ ", keyName="+ keyName);
    initResponse=retryAfterRefresh(new Function<InitiateMultipartUploadRequest,InitiateMultipartUploadResult>(){
      @Override @Nullable public InitiateMultipartUploadResult apply(      @Nullable InitiateMultipartUploadRequest arg0){
        eucaS3Client.refreshEndpoint();
        return eucaS3Client.initiateMultipartUpload(arg0);
      }
    }
,new InitiateMultipartUploadRequest(bucketName,keyName),REFRESH_TOKEN_RETRIES);
  }
 catch (  Exception ex) {
    throw new SnapshotInitializeMpuException("Failed to initialize multipart upload part for snapshotId=" + snapshotId + ", bucketName="+ bucketName+ ", keyName="+ keyName,ex);
  }
  if (StringUtils.isBlank(initResponse.getUploadId())) {
    throw new SnapshotInitializeMpuException("Invalid upload ID for multipart upload part for snapshotId=" + snapshotId + ", bucketName="+ bucketName+ ", keyName="+ keyName);
  }
  return initResponse.getUploadId();
}
