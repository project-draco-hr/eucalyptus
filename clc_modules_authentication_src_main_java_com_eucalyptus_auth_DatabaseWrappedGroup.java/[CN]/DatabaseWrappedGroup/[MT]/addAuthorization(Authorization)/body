{
  if (authorization instanceof BaseAuthorization) {
    BaseAuthorization auth=(BaseAuthorization)authorization;
    EntityWrapper<BaseAuthorization> db=EntityWrapper.get(BaseAuthorization.class);
    boolean ret=false;
    try {
      db.add(auth);
      GroupEntity g=db.recast(GroupEntity.class).getUnique(searchGroup);
      ret=g.addAuthorization(auth);
      db.recast(GroupEntity.class).merge(g);
      this.group=g;
      db.commit();
      EventRecord.here(Groups.class,EventClass.GROUP,EventType.GROUP_AUTH_GRANTED).withDetails(this.getName(),authorization.getDisplayName(),"target",auth.getValue());
    }
 catch (    Throwable e) {
      ret=false;
      LOG.debug(e,e);
      db.rollback();
    }
    return ret;
  }
 else {
    throw new RuntimeException("Authorizations must extend from BaseAuthorization, passed: " + authorization.getClass().getCanonicalName());
  }
}
