{
  MappingHttpRequest request=null;
  Context reqCtx=null;
  try {
    reqCtx=Contexts.lookup(reply.getCorrelationId());
    request=reqCtx.getHttpRequest();
  }
 catch (  NoSuchContextException e1) {
    LOG.debug(e1,e1);
  }
  if (request != null) {
    if (reply == null) {
      LOG.warn("Received a null response for request: " + request.getMessageString());
      reply=new EucalyptusErrorMessageType(this.getClass().getSimpleName(),(BaseMessage)request.getMessage(),"Received a NULL reply");
    }
    EventRecord.here(reply.getClass(),EventClass.MESSAGE,EventType.MSG_SERVICED,Long.toString(System.currentTimeMillis() - this.startTime.get())).trace();
    final MappingHttpResponse response=new MappingHttpResponse(request.getProtocolVersion());
    final DownstreamMessageEvent newEvent=new DownstreamMessageEvent(ctx.getChannel(),e.getFuture(),response,null);
    response.setMessage(reply);
    ctx.sendDownstream(newEvent);
  }
}
