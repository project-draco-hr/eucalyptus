{
  final MappingHttpMessage request=this.requestLocal.get(ctx.getChannel());
  if (reply == null) {
    LOG.warn("Received a null response for request: " + request.getMessageString());
    reply=new EucalyptusErrorMessageType(this.getClass().getSimpleName(),(EucalyptusMessage)request.getMessage(),"Received a NULL reply");
  }
  LOG.info(EventRecord.create(Component.eucalyptus,reply.getUserId(),reply.getCorrelationId(),EventType.MSG_SERVICED,reply.getClass().getSimpleName()));
  HttpVersion httpVersion=request.getProtocolVersion() != null ? request.getProtocolVersion() : HttpVersion.HTTP_1_1;
  final MappingHttpResponse response=new MappingHttpResponse(httpVersion);
  final DownstreamMessageEvent newEvent=new DownstreamMessageEvent(ctx.getChannel(),e.getFuture(),response,null);
  response.setMessage(reply);
  ctx.sendDownstream(newEvent);
}
