{
  SecretKeySpec signingKey=new SecretKeySpec(queryKey.getBytes(),Hashes.Mac.HmacSHA1.toString());
  try {
    Mac mac=Mac.getInstance(Hashes.Mac.HmacSHA1.toString());
    mac.init(signingKey);
    byte[] rawHmac=mac.doFinal(subject.getBytes());
    return Base64.encode(rawHmac).replaceAll("=","");
  }
 catch (  Exception e) {
    LOG.error(e,e);
    throw new QuerySecurityException("Failed to compute signature");
  }
}
