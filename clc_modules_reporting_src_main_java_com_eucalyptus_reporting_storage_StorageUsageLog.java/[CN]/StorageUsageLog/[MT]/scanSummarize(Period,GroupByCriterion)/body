{
  final Map<String,StorageUsageSummary> results=new HashMap<String,StorageUsageSummary>();
  Iterator<StorageUsageSnapshot> iter=scanLog(period);
  while (iter.hasNext()) {
    StorageUsageSnapshot snapshot=iter.next();
    String critVal=getAttributeValue(criterion,snapshot);
    StorageUsageSummary summary=null;
    if (results.containsKey(critVal)) {
      summary=results.get(critVal);
    }
 else {
      summary=new StorageUsageSummary();
      results.put(critVal,summary);
    }
    summary.sumFrom(snapshot);
  }
  return results;
}
