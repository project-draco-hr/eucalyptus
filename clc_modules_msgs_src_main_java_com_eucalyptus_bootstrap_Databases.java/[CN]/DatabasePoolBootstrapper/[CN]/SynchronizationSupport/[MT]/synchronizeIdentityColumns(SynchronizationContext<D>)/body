{
  Statement sourceStatement=context.getConnection(context.getSourceDatabase()).createStatement();
  Statement targetStatement=context.getConnection(context.getTargetDatabase()).createStatement();
  Dialect dialect=context.getDialect();
  for (  TableProperties table : context.getSourceDatabaseProperties().getTables()) {
    Collection<String> columns=table.getIdentityColumns();
    if (!columns.isEmpty()) {
      String selectSQL=MessageFormat.format("SELECT max({0}) FROM {1}",Strings.join(columns,"), max("),table.getName());
      LOG.info(selectSQL);
      Map<String,Long> map=new HashMap<String,Long>();
      ResultSet resultSet=sourceStatement.executeQuery(selectSQL);
      if (resultSet.next()) {
        int i=0;
        for (        String column : columns) {
          map.put(column,resultSet.getLong(++i));
        }
      }
      resultSet.close();
      if (!map.isEmpty()) {
        for (        Map.Entry<String,Long> mapEntry : map.entrySet()) {
          String alterSQL=dialect.getAlterIdentityColumnSQL(table,table.getColumnProperties(mapEntry.getKey()),mapEntry.getValue() + 1);
          if (alterSQL != null) {
            LOG.info(alterSQL);
            targetStatement.addBatch(alterSQL);
          }
        }
        targetStatement.executeBatch();
      }
    }
  }
  sourceStatement.close();
  targetStatement.close();
}
