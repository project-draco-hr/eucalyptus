{
  final Set<String> databases=Sets.newLinkedHashSet();
  try {
    final DatabaseClusterMBean cluster=lookup(clusterName,0);
    final Iterable<String> databaseIds=active ? cluster.getactiveDatabases() : cluster.getinactiveDatabases();
    for (    final String databaseId : databaseIds)     try {
      final DriverDatabaseMBean database=lookupDatabase(clusterName,databaseId);
      if (!weight.isPresent() || database.getweight() == weight.get()) {
        databases.add(databaseId);
      }
    }
 catch (    NoSuchElementException e) {
    }
  }
 catch (  NoSuchElementException e) {
  }
catch (  Exception e) {
    LOG.error(e,e);
  }
  return databases;
}
