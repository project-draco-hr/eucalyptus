{
  return new Function<String,Runnable>(){
    @Override public Runnable apply(    final String ctx){
      final String contextName=ctx;
      Runnable removeRunner=new Runnable(){
        @Override public void run(){
          DatabaseClusterMBean cluster=lookup(ctx,TimeUnit.SECONDS.toMillis(5));
          if (!cluster.isAlive(contextName)) {
            throw Exceptions.toUndeclared("Database on host " + hostName + " failed liveness check and will be deactived.");
          }
        }
        @Override public String toString(){
          return "Databases.isAlive(): " + hostName + " "+ contextName;
        }
      }
;
      return removeRunner;
    }
  }
;
}
