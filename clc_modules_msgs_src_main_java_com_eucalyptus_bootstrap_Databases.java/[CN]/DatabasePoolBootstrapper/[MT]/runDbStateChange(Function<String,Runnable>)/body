{
  Map<Runnable,Future<Runnable>> runnables=Maps.newHashMap();
  for (  final String ctx : PersistenceContexts.list()) {
    Runnable run=runnableFunction.apply(ctx);
    runnables.put(run,ExecuteRunnable.INSTANCE.apply(run));
    LOG.debug("RUNNING: " + run);
  }
  Map<Runnable,Future<Runnable>> succeeded=Futures.waitAll(runnables);
  MapDifference<Runnable,Future<Runnable>> failed=Maps.difference(runnables,succeeded);
  StringBuilder builder=new StringBuilder();
  builder.append(Joiner.on("\nSUCCESS: ").join(succeeded.keySet()));
  builder.append(Joiner.on("\nFAILED:  ").join(failed.entriesOnlyOnLeft().keySet()));
  if (failed.entriesOnlyOnLeft().isEmpty()) {
    LOG.info(builder.toString());
  }
 else {
    throw Exceptions.toUndeclared(builder.toString());
  }
}
