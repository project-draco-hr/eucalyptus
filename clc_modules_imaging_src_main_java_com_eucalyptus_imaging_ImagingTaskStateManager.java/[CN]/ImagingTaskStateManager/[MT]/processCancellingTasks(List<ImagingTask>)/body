{
  for (  final ImagingTask task : tasks) {
    try {
      if (!cancellingTimer.containsKey(task.getDisplayName())) {
        cancellingTimer.put(task.getDisplayName(),Dates.minutesFromNow(CANCELLING_WAIT_MIN));
      }
      final Date cancellingExpired=cancellingTimer.get(task.getDisplayName());
      if (cancellingExpired.before(new Date())) {
        ImagingTasks.transitState(task,ImportTaskState.CANCELLING,ImportTaskState.CANCELLED,null);
      }
    }
 catch (    final Exception ex) {
      LOG.error("Could not process cancelling task " + task.getDisplayName());
    }
  }
}
