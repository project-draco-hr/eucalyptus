{
  NodeCertInfo certs=reply.getCerts();
  if (certs == null || certs.getCcCert() == null || certs.getNcCert() == null) {
    return false;
  }
  byte[] ccCert=Base64.decode(certs.getCcCert());
  X509Certificate clusterx509=Hashes.getPemCert(ccCert);
  X509Certificate realClusterx509=X509Cert.toCertificate(cluster.getCredentials().getClusterCertificate());
  boolean cc=realClusterx509.equals(clusterx509);
  byte[] ncCert=Base64.decode(certs.getNcCert());
  X509Certificate nodex509=Hashes.getPemCert(ncCert);
  X509Certificate realNodex509=X509Cert.toCertificate(cluster.getCredentials().getNodeCertificate());
  boolean nc=realNodex509.equals(nodex509);
  LOG.info(EventRecord.here(Component.cluster,EventType.CLUSTER_CERT,cluster.getName(),"cc:" + cc,"nc:" + nc));
  if (!cc) {
    LOG.debug(LogUtil.subheader("EXPECTED CERTIFICATE") + X509Cert.toCertificate(cluster.getCredentials().getClusterCertificate()));
    LOG.debug(LogUtil.subheader("RECEIVED CERTIFICATE") + clusterx509);
  }
  if (!nc) {
    LOG.debug(LogUtil.subheader("EXPECTED CERTIFICATE") + X509Cert.toCertificate(cluster.getCredentials().getNodeCertificate()));
    LOG.debug(LogUtil.subheader("RECEIVED CERTIFICATE") + nodex509);
  }
  return cc && nc;
}
