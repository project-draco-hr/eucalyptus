{
  final Object o=event.getMessage();
  if (o instanceof MappingHttpMessage) {
    final MappingHttpMessage httpRequest=(MappingHttpMessage)o;
    SOAPEnvelope envelope=httpRequest.getSoapEnvelope();
    X509Certificate cert=null;
    HoldMe.canHas.lock();
    try {
      cert=WSSecurity.getVerifiedCertificate(envelope);
    }
  finally {
      HoldMe.canHas.unlock();
    }
    httpRequest.setUser(CredentialProvider.getUser(cert));
  }
}
