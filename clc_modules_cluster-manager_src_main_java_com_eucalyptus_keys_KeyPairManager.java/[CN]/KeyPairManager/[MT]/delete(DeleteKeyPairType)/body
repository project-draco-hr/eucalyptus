{
  DeleteKeyPairResponseType reply=(DeleteKeyPairResponseType)request.getReply();
  Context ctx=Contexts.lookup();
  try {
    SshKeyPair key=KeyPairUtil.deleteUserKeyPair(ctx.getUserFullName(),request.getKeyName());
    Account keyAccount=null;
    try {
      keyAccount=Accounts.lookupAccountById(key.getOwnerAccountId());
    }
 catch (    AuthException e) {
      throw new EucalyptusCloudException(e);
    }
    if (!Permissions.isAuthorized(PolicySpec.VENDOR_EC2,PolicySpec.EC2_RESOURCE_KEYPAIR,request.getKeyName(),keyAccount,PolicySpec.requestToAction(request),ctx.getUser())) {
      throw new EucalyptusCloudException("Permission denied while trying to delete keypair " + key.getName() + " by "+ ctx.getUser());
    }
    reply.set_return(true);
  }
 catch (  Exception e1) {
    reply.set_return(true);
  }
  return reply;
}
