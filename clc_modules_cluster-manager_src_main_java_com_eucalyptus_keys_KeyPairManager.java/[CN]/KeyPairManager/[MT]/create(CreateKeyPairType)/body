{
  CreateKeyPairResponseType reply=request.getReply();
  Context ctx=Contexts.lookup();
  PrivateKey pk=KeyPairs.create(ctx.getUserFullName(),request.getKeyName());
  reply.setKeyFingerprint(Certs.getFingerPrint(pk));
  ByteArrayOutputStream byteOut=new ByteArrayOutputStream();
  PEMWriter privOut=new PEMWriter(new OutputStreamWriter(byteOut));
  try {
    privOut.writeObject(pk);
    privOut.close();
  }
 catch (  IOException e) {
    LOG.error(e);
    throw new EucalyptusCloudException(e);
  }
  reply.setKeyName(request.getKeyName());
  reply.setKeyMaterial(byteOut.toString());
  return reply;
}
