{
  Context ctx=Contexts.lookup();
  NetworkGroupUtil.makeDefault(ctx.getUserFullName());
  DeleteSecurityGroupResponseType reply=(DeleteSecurityGroupResponseType)request.getReply();
  if (Contexts.lookup().hasAdministrativePrivileges() && request.getGroupName().indexOf("::") != -1) {
    String userName=request.getGroupName().replaceAll("::.*","");
    try {
      User user=Accounts.lookupUserByName(userName);
      AccountFullName userFullName=UserFullName.getInstance(user);
      NetworkGroupUtil.deleteUserNetworkRulesGroup(userFullName,request.getGroupName().replaceAll("\\w*::",""));
    }
 catch (    AuthException ex) {
      LOG.error(ex.getMessage());
      throw new EucalyptusCloudException("Deleting security failed because of: " + ex.getMessage() + " for request "+ request.toSimpleString());
    }
  }
 else {
    if (!Permissions.isAuthorized(PolicySpec.VENDOR_EC2,PolicySpec.EC2_RESOURCE_SECURITYGROUP,request.getGroupName(),ctx.getAccount(),PolicySpec.requestToAction(request),ctx.getUser())) {
      throw new EucalyptusCloudException("Not authorized to delete network group " + request.getGroupName() + " for "+ ctx.getUser());
    }
    NetworkGroupUtil.deleteUserNetworkRulesGroup(ctx.getUserFullName(),request.getGroupName());
  }
  reply.set_return(true);
  return reply;
}
