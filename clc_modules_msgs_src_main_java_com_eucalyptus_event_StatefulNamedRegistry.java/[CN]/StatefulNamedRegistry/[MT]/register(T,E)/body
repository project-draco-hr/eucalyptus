{
  T oldValue=null;
  if (obj == null) {
    throw new IllegalArgumentException("Value cannot be null: " + obj);
  }
  this.canHas.writeLock().lock();
  try {
    oldValue=this.lookup(obj.getName());
    E oldState=this.getState(oldValue.getName());
    this.stateMaps.get(oldState).remove(obj.getName());
  }
 catch (  NoSuchElementException e) {
    this.stateMaps.get(initialState).put(obj.getName(),obj);
  }
 finally {
    this.canHas.writeLock().unlock();
    try {
      ListenerRegistry.getInstance().fireEvent(new StateEvent<T,E>(initialState,obj));
    }
 catch (    EventFailedException e) {
      LOG.warn("Registry change was vetoed: " + e,e);
    }
  }
  return oldValue;
}
