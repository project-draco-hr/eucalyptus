{
  String uri;
  try {
    if (NetworkUtil.testLocal(host) && port != -1) {
      return this.getLocalUri();
    }
 else {
      try {
        uri=String.format(this.getUriPattern(),host,port);
      }
 catch (      MissingFormatArgumentException e) {
        uri=String.format(this.getUriPattern(),host,port,this.getLocalUri().getHost().replaceAll("RequestQueue","Internal"));
      }
      try {
        URI u=new URI(uri);
        u.parseServerAuthority();
        return u;
      }
 catch (      URISyntaxException e) {
        LOG.error(e,e);
        return URI.create(uri);
      }
    }
  }
 catch (  Exception e) {
    return this.getLocalUri();
  }
}
