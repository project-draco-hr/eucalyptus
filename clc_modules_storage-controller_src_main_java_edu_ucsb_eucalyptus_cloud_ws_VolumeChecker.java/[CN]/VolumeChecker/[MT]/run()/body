{
  EntityWrapper<VolumeInfo> db=StorageProperties.getEntityWrapper();
  VolumeInfo volumeInfo=new VolumeInfo();
  volumeInfo.setStatus(StorageProperties.Status.available.toString());
  List<VolumeInfo> volumes=db.query(volumeInfo);
  for (  VolumeInfo volume : volumes) {
    try {
      LOG.info("CHECKING VOLUME: " + volume.getVolumeId());
      blockManager.checkVolume(volume.getVolumeId());
    }
 catch (    EucalyptusCloudException ex) {
      volume.setStatus(StorageProperties.Status.error.toString());
      LOG.error(ex);
    }
  }
  try {
    db.commit();
  }
 catch (  Exception ex) {
    LOG.error(ex,ex);
    db.rollback();
  }
}
