{
  Map<String,String> parameters=httpRequest.getParameters();
  String verb=httpRequest.getMethod().getName();
  String content_md5=httpRequest.getHeader("Content-MD5");
  content_md5=content_md5 == null ? "" : content_md5;
  String content_type=httpRequest.getHeader(HttpHeaders.Names.CONTENT_TYPE);
  content_type=content_type == null ? "" : content_type;
  String addrString=getS3AddressString(httpRequest,true);
  String accesskeyid=parameters.remove(SecurityParameter.AWSAccessKeyId.toString());
  String expires=parameters.remove(SecurityParameter.Expires.toString());
  if (expires == null) {
    throw new InvalidSecurityException("Expiration parameter must be specified.");
  }
  String canonicalizedAmzHeaders=getCanonicalizedAmzHeaders(httpRequest,true);
  return verb + "\n" + content_md5+ "\n"+ content_type+ "\n"+ Long.parseLong(expires)+ "\n"+ canonicalizedAmzHeaders+ addrString;
}
