{
  ComputePolicyContext.clearContext();
  if (accepted.contains(resource.getClass()) || (!rejected.contains(resource.getClass()) && CloudMetadata.class.isAssignableFrom(resource.getClass())))   try {
    ComputePolicyContext.setComputePolicyContextResource(TypeMappers.transform(resource,ComputePolicyContextResource.class));
    accepted.add(resource.getClass());
  }
 catch (  IllegalArgumentException e) {
    rejected.add(resource.getClass());
    Logs.exhaust().info("Policy context not set for resource type: " + resource.getClass().getSimpleName());
  }
}
