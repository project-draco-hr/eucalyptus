{
  Dispatcher d=null;
  if (parent.isSingleton()) {
    d=new LocalDispatcher(parent.getPeer(),service.getName(),service.getUri());
  }
 else   if (service.getEndpoint().isLocal()) {
    d=new LocalDispatcher(parent.getPeer(),service.getName(),service.getUri());
  }
 else {
    d=new RemoteDispatcher(parent.getPeer(),service.getName(),service.getUri());
  }
  ServiceDispatcher.register(service.getName(),d);
  return d;
}
