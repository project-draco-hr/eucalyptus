{
  try {
    ServiceKey serviceKey=ServiceKey.create(config);
    try {
      Future<ServiceConfiguration> transition=ServiceTransitions.transitionChain(config,Component.State.DISABLED);
      ServiceConfiguration result=transition.get();
      return result;
    }
 catch (    InterruptedException ex) {
      Thread.currentThread().interrupt();
      throw new UndeclaredThrowableException(ex);
    }
catch (    Exception ex) {
      LOG.error(ex,ex);
      throw new UndeclaredThrowableException(ex);
    }
 finally {
      Topology.getInstance().getGuard().tryDisable(serviceKey,config);
      return config;
    }
  }
 catch (  Exception ex) {
    LOG.error(ex,ex);
    throw new UndeclaredThrowableException(ex);
  }
}
