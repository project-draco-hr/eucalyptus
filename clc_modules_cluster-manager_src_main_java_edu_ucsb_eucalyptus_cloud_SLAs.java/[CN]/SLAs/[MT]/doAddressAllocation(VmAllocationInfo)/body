{
  if (!Clusters.getInstance().hasNetworking())   return;
  if ("public".equals(vmAllocInfo.getRequest().getAddressingType()) || vmAllocInfo.getRequest().getAddressingType() == null) {
    List<ResourceToken> allocTokeList=vmAllocInfo.getAllocationTokens();
    List<Address> addressList=Lists.newArrayList();
    try {
      for (      ResourceToken token : allocTokeList) {
        addressList.addAll(Addresses.getAddressManager().allocateSystemAddresses(token.getCluster(),token.getAmount()));
      }
    }
 catch (    Exception e) {
      throw new NotEnoughResourcesAvailable(e.getMessage(),e);
    }
    Iterator<Address> iter=addressList.listIterator();
    for (    ResourceToken token : allocTokeList) {
      for (int i=0; i < token.getAmount(); i++) {
        Address next=iter.next();
        token.getAddresses().add(next.getName());
      }
    }
  }
}
