{
  return new DelegatingContextSupport(ctx){
    private Boolean isSystemAdmin;
    @Override public User getUser(){
      return user;
    }
    @Override public Account getAccount(){
      try {
        return user.getAccount();
      }
 catch (      AuthException ex) {
        LOG.error(ex,ex);
        throw new IllegalStateException("Context populated with ill-defined user:  no corresponding account found.",ex);
      }
    }
    @Override public UserFullName getUserFullName(){
      return UserFullName.getInstance(user);
    }
    @Override public boolean hasAdministrativePrivileges(){
      if (isSystemAdmin == null) {
        isSystemAdmin=user.isSystemAdmin();
      }
      return isSystemAdmin;
    }
  }
;
}
