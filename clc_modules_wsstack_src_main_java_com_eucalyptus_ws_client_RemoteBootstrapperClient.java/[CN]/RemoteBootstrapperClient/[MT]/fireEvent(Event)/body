{
  if (event instanceof StartComponentEvent) {
    StartComponentEvent s=(StartComponentEvent)event;
    if (!Component.walrus.equals(s.getComponent()) || !Component.storage.equals(s.getComponent()))     return;
    if (s.isLocal() || this.heartbeatMap.containsKey(s.getConfiguration().getHostName()))     return;
    ComponentConfiguration config=s.getConfiguration();
    this.heartbeatMap.put(config.getHostName(),new HeartBeatClient(this.clientBootstrap,config.getHostName(),config.getPort()));
    this.componentMap.put(config.getHostName(),config);
    LOG.info("-> Registering heartbeat client for host: " + s);
  }
 else   if (event instanceof StopComponentEvent) {
    StopComponentEvent s=(StopComponentEvent)event;
    if (!Component.walrus.equals(s.getComponent()) || !Component.storage.equals(s.getComponent()))     return;
    if (s.isLocal() || this.heartbeatMap.containsKey(s.getConfiguration().getHostName()))     return;
    ComponentConfiguration config=s.getConfiguration();
    this.componentMap.remove(config.getHostName(),s.getConfiguration());
    LOG.info("-> Removing heartbeat client for host: " + s);
    if (this.componentMap.get(config.getHostName()).isEmpty()) {
      HeartBeatClient hb=this.heartbeatMap.remove(config.getHostName());
      hb.close();
    }
  }
}
