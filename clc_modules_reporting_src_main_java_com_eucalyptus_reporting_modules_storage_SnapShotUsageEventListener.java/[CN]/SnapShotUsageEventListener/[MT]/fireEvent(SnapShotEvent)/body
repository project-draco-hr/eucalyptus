{
  Preconditions.checkNotNull(event,"Event is required");
  ReportingAccountDao.getInstance().addUpdateAccount(event.getAccountId(),event.getAccountName());
  ReportingUserDao.getInstance().addUpdateUser(event.getOwnerId(),event.getOwnerName());
  final ReportingVolumeSnapshotEventStore eventStore=ReportingVolumeSnapshotEventStore.getInstance();
switch (event.getActionInfo().getAction()) {
case SNAPSHOTCREATE:
    eventStore.insertCreateEvent(event.getUuid(),event.getDisplayName(),event.getTimeInMs(),event.getOwnerName(),event.getSizeMegs());
  break;
case SNAPSHOTDELETE:
eventStore.insertDeleteEvent(event.getUuid(),event.getTimeInMs());
break;
}
}
