{
  String confString=" and confirmed";
  try {
    if (!user.isConfirmed().booleanValue()) {
      confString="";
      String http_eucalyptus=ServletUtils.getRequestUrl(getThreadLocalRequest());
      String confirm_link=http_eucalyptus + "?action=confirm" + "&code="+ user.getConfirmationCode();
      String email_message=signup_approval_header + "\n\n" + confirm_link+ "\n\n"+ signup_approval_footer;
      ServletUtils.sendMail(reply_email,user.getEmail(),signup_approval_subject,email_message);
    }
  }
 catch (  Exception e) {
    LOG.error("Approval mailing problem: " + e.getMessage());
    LOG.error("Confirmation code for user " + user.getUserName() + " is "+ user.getConfirmationCode());
    return "Internal problem (failed to notify user " + user.getEmail() + " by email)";
  }
  return "User '" + user.getUserName() + "' was approved"+ confString+ ", thank you.";
}
