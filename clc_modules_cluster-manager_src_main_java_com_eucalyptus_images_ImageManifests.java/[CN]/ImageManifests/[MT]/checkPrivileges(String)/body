{
  Context ctx=Contexts.lookup();
  if (diskId != null) {
    ImageInfo disk=null;
    try {
      disk=Images.lookupImage(diskId);
    }
 catch (    Exception ex) {
      LOG.error(ex,ex);
      throw new EucalyptusCloudException("Referenced image id is invalid: " + diskId,ex);
    }
    if (!RestrictedTypes.checkPrivilege(ctx.getRequest(),PolicySpec.VENDOR_EC2,PolicySpec.EC2_RESOURCE_IMAGE,diskId,disk.getOwner())) {
      throw new EucalyptusCloudException("Access to " + disk.getImageType().toString() + " image "+ diskId+ " is denied for "+ ctx.getUser().getName());
    }
  }
}
