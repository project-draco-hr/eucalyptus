{
  X509V3CertificateGenerator certGen=new X509V3CertificateGenerator();
  X500Principal dnName=new X500Principal(certDn);
  certGen.setSerialNumber(BigInteger.valueOf(System.currentTimeMillis()));
  certGen.setIssuerDN(dnName);
  certGen.addExtension(X509Extensions.BasicConstraints,true,new BasicConstraints(true));
  Calendar cal=Calendar.getInstance();
  certGen.setNotBefore(cal.getTime());
  cal.add(Calendar.YEAR,5);
  certGen.setNotAfter(cal.getTime());
  certGen.setSubjectDN(dnName);
  certGen.setPublicKey(keyPair.getPublic());
  certGen.setSignatureAlgorithm(this.keySigningAlgorithm);
  try {
    X509Certificate cert=certGen.generate(keyPair.getPrivate(),PROVIDER);
    return cert;
  }
 catch (  Exception e) {
    LOG.fatal(e,e);
    System.exit(1);
    return null;
  }
}
