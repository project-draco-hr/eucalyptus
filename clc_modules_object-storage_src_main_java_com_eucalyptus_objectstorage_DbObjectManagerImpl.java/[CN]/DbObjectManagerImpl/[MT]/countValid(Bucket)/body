{
  EntityTransaction db=Entities.get(ObjectEntity.class);
  ObjectEntity exampleObject=new ObjectEntity(bucket.getBucketName(),null,null);
  Criterion crit=Restrictions.and(ObjectEntity.QueryHelpers.getNotDeletingRestriction(),ObjectEntity.QueryHelpers.getNotPendingRestriction());
  try {
    return Entities.count(exampleObject,crit,new HashMap<String,String>());
  }
 catch (  Throwable e) {
    LOG.error("Error getting object count for bucket " + bucket.getBucketName(),e);
    throw new Exception(e);
  }
 finally {
    db.rollback();
  }
}
