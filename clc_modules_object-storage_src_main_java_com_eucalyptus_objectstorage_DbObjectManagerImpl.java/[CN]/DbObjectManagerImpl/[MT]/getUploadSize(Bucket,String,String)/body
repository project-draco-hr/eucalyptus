{
  long size=0;
  EntityTransaction db=Entities.get(PartEntity.class);
  try {
    Criteria search=Entities.createCriteria(PartEntity.class);
    PartEntity searchExample=new PartEntity(bucket.getBucketName(),objectKey,uploadId,null);
    searchExample.setUuid(null);
    List<PartEntity> results=search.add(Example.create(searchExample)).add(PartEntity.QueryHelpers.getNotPendingRestriction()).list();
    db.commit();
    for (    PartEntity part : results) {
      size+=part.getSize();
    }
  }
  finally {
    if (db != null && db.isActive()) {
      db.rollback();
    }
  }
  return size;
}
