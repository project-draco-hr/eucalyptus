{
  EntityTransaction db=Entities.get(ObjectEntity.class);
  try {
    Entities.mergeDirect(object);
    try {
      BucketManagers.getInstance().updateBucketSize(bucket.getBucketName(),object.getSize());
    }
 catch (    final Throwable f) {
      LOG.warn("Error updating bucket " + bucket.getBucketName() + " total object size. Not failing object put of .",f);
    }
    db.commit();
  }
 catch (  Exception e) {
    LOG.error("Error saving metadata object:" + bucket.getBucketName() + "/"+ object.getObjectKey()+ " version "+ object.getVersionId());
    throw e;
  }
 finally {
    if (db != null && db.isActive()) {
      db.rollback();
    }
  }
}
