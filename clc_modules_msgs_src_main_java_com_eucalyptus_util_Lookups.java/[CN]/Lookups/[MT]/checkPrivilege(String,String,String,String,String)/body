{
  Context ctx=Contexts.lookup();
  AuthContextSupplier requestUser=ctx.getAuthContext();
  Account account=null;
  if (resourceOwnerAccountId != null) {
    try {
      account=Accounts.lookupAccountById(resourceOwnerAccountId);
    }
 catch (    AuthException e) {
      RestrictedTypes.LOG.error(e,e);
      return false;
    }
  }
  return Permissions.isAuthorized(vendor,resourceType,resourceId,account,action,requestUser);
}
