{
  String signature=credentials.getSignature().replaceAll("=","");
  User user=Users.lookupQueryId(credentials.getQueryId());
  String queryKey=user.getSecretKey();
  String authSig=checkSignature(queryKey,credentials.getLoginData());
  if (authSig.equals(signature)) {
    super.setCredential(credentials.getQueryId());
    super.setPrincipal(user);
    super.getGroups().addAll(Groups.lookupUserGroups(super.getPrincipal()));
    return true;
  }
  return false;
}
