{
  KeyTool keyTool=new KeyTool();
  try {
    KeyPair sysKp=keyTool.getKeyPair();
    X509Certificate sysX509=keyTool.getCertificate(sysKp,EucalyptusProperties.getDName(name.name()));
    System.singleton.certs.put(name,sysX509);
    System.singleton.keypairs.put(name,sysKp);
    EucaKeyStore.getInstance().addKeyPair(name.name(),sysX509,sysKp.getPrivate(),name.name());
    EucaKeyStore.getInstance().store();
  }
 catch (  Exception e) {
    System.singleton.certs.remove(name);
    System.singleton.keypairs.remove(name);
    EucaKeyStore.getInstance().remove();
    throw e;
  }
}
