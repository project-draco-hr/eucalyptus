{
  double duration=(double)(period.getEndingMs() - period.getBeginningMs());
  double gap=0d;
  double result=(double)lastSnapshot.getCumulativeDiskIoMegs() - (double)firstSnapshot.getCumulativeDiskIoMegs();
  if (firstSnapshot.getTimestampMs() < period.getBeginningMs()) {
    gap=(double)(period.getBeginningMs() - firstSnapshot.getTimestampMs());
    result*=1d - (gap / duration);
  }
  if (lastSnapshot.getTimestampMs() > period.getEndingMs()) {
    gap=(double)(lastSnapshot.getTimestampMs() - period.getEndingMs());
    result*=1d - (gap / duration);
  }
  return (long)result;
}
