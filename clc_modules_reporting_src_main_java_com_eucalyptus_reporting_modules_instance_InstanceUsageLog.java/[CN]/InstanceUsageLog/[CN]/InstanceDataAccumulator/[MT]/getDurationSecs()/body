{
  if (period.getBeginningMs() >= lastSnapshot.getTimestampMs() || period.getEndingMs() <= firstSnapshot.getTimestampMs()) {
    return 0l;
  }
 else {
    long truncatedBeginMs=Math.max(period.getBeginningMs(),firstSnapshot.getTimestampMs());
    long truncatedEndMs=Math.min(period.getEndingMs(),lastSnapshot.getTimestampMs());
    return (truncatedEndMs - truncatedBeginMs) / 1000;
  }
}
