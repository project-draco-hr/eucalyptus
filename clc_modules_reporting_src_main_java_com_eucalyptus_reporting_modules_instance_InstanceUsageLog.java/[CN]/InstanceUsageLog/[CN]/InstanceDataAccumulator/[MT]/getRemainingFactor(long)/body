{
  final double periodDuration=(double)(timestampMs - lastSnapshot.getTimestampMs());
  if (periodDuration == 0)   return 0d;
  final double priorFraction=(double)(period.getBeginningMs() - lastSnapshot.getTimestampMs()) / periodDuration;
  final double afterFraction=(double)(timestampMs - period.getEndingMs()) / periodDuration;
  return Math.max(0d,1d - Math.max(0d,priorFraction) - Math.max(0d,afterFraction));
}
