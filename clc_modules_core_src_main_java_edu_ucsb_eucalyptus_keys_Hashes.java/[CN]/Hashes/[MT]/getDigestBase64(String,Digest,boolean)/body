{
  byte[] inputBytes=input.getBytes();
  byte[] digestBytes=null;
  MessageDigest digest=hash.get();
  digest.update(inputBytes);
  if (randomize) {
    SecureRandom random=new SecureRandom();
    random.setSeed(System.currentTimeMillis());
    byte[] randomBytes=random.generateSeed(inputBytes.length);
    digest.update(randomBytes);
  }
  digestBytes=digest.digest();
  return new String(UrlBase64.encode(digestBytes));
}
