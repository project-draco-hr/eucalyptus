{
  Decision result=Decision.DEFAULT;
  for (  Authorization auth : authorizations) {
    if (!evaluatePatterns(auth.getActions(),auth.isNotAction(),action)) {
      continue;
    }
    if (!evaluatePatterns(auth.getResources(),auth.isNotResource(),resource)) {
      continue;
    }
    if (!evaluateConditions(auth.getConditions(),action,auth.getType(),keyEval,contractEval)) {
      continue;
    }
    if (auth.getEffect() == EffectType.Deny) {
      return Decision.DENY;
    }
 else {
      result=Decision.ALLOW;
    }
  }
  return result;
}
