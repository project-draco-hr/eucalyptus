{
  if (resource == null) {
    return true;
  }
 else   if (auth.getAccount() != null && resourceAccountNumber != null && !resolveAccount(auth.getAccount()).equals(resourceAccountNumber)) {
    return auth.isNotResource();
  }
 else   if (PolicySpec.EC2_RESOURCE_ADDRESS.equals(auth.getType())) {
    return evaluateElement(matchOne(auth.getResources(),resource,ADDRESS_MATCHER),auth.isNotResource());
  }
 else {
    return evaluateElement(matchOne(auth.getResources(),resource,PATTERN_MATCHER),auth.isNotResource());
  }
}
