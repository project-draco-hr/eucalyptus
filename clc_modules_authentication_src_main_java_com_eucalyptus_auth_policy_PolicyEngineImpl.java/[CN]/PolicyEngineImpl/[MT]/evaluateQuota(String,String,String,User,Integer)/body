{
  try {
    if (!requestUser.isSystemAdmin()) {
      String userId=requestUser.getUserId();
      String accountId=requestUser.getAccount().getAccountId();
      List<Authorization> quotas=lookupQuotas(resourceType,userId,accountId,requestUser.isAccountAdmin());
      processQuotas(quotas,action,resourceType,resourceName,quantity);
    }
  }
 catch (  AuthException e) {
    throw e;
  }
catch (  Throwable e) {
    throw new AuthException("An error occurred while trying to evaluate policy for resource allocation.",e);
  }
}
