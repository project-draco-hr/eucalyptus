{
  try {
    if ((this.transaction != null) && this.transaction.isActive()) {
      this.transaction.rollback();
    }
    this.record.logEvent(TxState.END,TxEvent.ROLLBACK);
  }
 catch (  final Throwable e) {
    this.record.logEvent(TxState.FAIL,TxEvent.ROLLBACK);
    PersistenceExceptions.throwFiltered(e);
  }
 finally {
    this.cleanup();
  }
}
