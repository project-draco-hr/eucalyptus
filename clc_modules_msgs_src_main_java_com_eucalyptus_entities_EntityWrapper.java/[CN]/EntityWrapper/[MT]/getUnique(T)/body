{
  try {
    Object id=null;
    try {
      id=this.getEntityManager().getEntityManagerFactory().getPersistenceUnitUtil().getIdentifier(example);
    }
 catch (    final Exception ex) {
    }
    if (id != null) {
      final T res=(T)this.getEntityManager().find(example.getClass(),id);
      if (res == null) {
        throw new NoSuchElementException("@Id: " + id);
      }
 else {
        return res;
      }
    }
 else     if ((example instanceof HasNaturalId) && (((HasNaturalId)example).getNaturalId() != null)) {
      final String natId=((HasNaturalId)example).getNaturalId();
      final T ret=(T)this.createCriteria(example.getClass()).setCacheable(true).setMaxResults(1).setFetchSize(1).setFirstResult(0).add(Restrictions.naturalId().set("naturalId",natId)).uniqueResult();
      if (ret == null) {
        throw new NoSuchElementException("@NaturalId: " + natId);
      }
      return ret;
    }
 else {
      final T ret=(T)this.createCriteria(example.getClass()).setCacheable(true).setMaxResults(1).setFetchSize(1).setFirstResult(0).add(Example.create(example).enableLike(MatchMode.EXACT)).uniqueResult();
      if (ret == null) {
        throw new NoSuchElementException("example: " + LogUtil.dumpObject(example));
      }
      return ret;
    }
  }
 catch (  final NonUniqueResultException ex) {
    throw new EucalyptusCloudException("Get unique failed for " + example.getClass().getSimpleName() + " because "+ ex.getMessage(),ex);
  }
catch (  final NoSuchElementException ex) {
    throw new EucalyptusCloudException("Get unique failed for " + example.getClass().getSimpleName() + " using "+ ex.getMessage(),ex);
  }
catch (  final Exception ex) {
    final Exception newEx=PersistenceExceptions.throwFiltered(ex);
    throw new EucalyptusCloudException("Get unique failed for " + example.getClass().getSimpleName() + " because "+ newEx.getMessage(),newEx);
  }
}
