{
  try {
    Object id=null;
    try {
      id=this.getEntityManager().getEntityManagerFactory().getPersistenceUnitUtil().getIdentifier(example);
    }
 catch (    Exception ex) {
    }
    if (id != null) {
      T res=(T)this.getEntityManager().find(example.getClass(),id);
      if (res == null) {
        throw new NoSuchElementException("@Id: " + id);
      }
 else {
        return res;
      }
    }
 else     if (example instanceof HasNaturalId && ((HasNaturalId)example).getNaturalId() != null) {
      String natId=((HasNaturalId)example).getNaturalId();
      T ret=(T)this.createCriteria(example.getClass()).add(Restrictions.naturalId().set("naturalId",natId)).setCacheable(true).setMaxResults(1).setFetchSize(1).setFirstResult(0).uniqueResult();
      if (ret == null) {
        throw new NoSuchElementException("@NaturalId: " + natId);
      }
      return ret;
    }
 else {
      T ret=(T)this.createCriteria(example.getClass()).add(Example.create(example).enableLike(MatchMode.EXACT)).setCacheable(true).setMaxResults(1).setFetchSize(1).setFirstResult(0).uniqueResult();
      if (ret == null) {
        throw new NoSuchElementException("example: " + LogUtil.dumpObject(example));
      }
      return ret;
    }
  }
 catch (  NonUniqueResultException ex) {
    throw new EucalyptusCloudException("Get unique failed for " + example.getClass().getSimpleName() + " because "+ ex.getMessage(),ex);
  }
catch (  NoSuchElementException ex) {
    throw new EucalyptusCloudException("Get unique failed for " + example.getClass().getSimpleName() + " using "+ ex.getMessage(),ex);
  }
catch (  Exception ex) {
    Exception newEx=PersistenceExceptions.throwFiltered(ex);
    throw new EucalyptusCloudException("Get unique failed for " + example.getClass().getSimpleName() + " because "+ newEx.getMessage(),newEx);
  }
}
