{
  String uri;
  URI u=null;
  String pattern;
  port=(port == -1) ? this.getPort() : port;
  hostName=(port == -1) ? Internets.localHostAddress() : hostName;
  pattern=this.getExternalUriPattern();
  LOG.info("prefix = " + prefix + ", pattern = "+ pattern);
  try {
    if (pattern.startsWith("%s"))     uri=String.format(this.getExternalUriPattern(),prefix,hostName,port);
 else     uri=String.format(this.getExternalUriPattern(),hostName,port);
    LOG.info("uri = " + uri);
    u=new URI(uri);
    u.parseServerAuthority();
  }
 catch (  URISyntaxException e) {
    if (pattern.startsWith("%s"))     uri=String.format(this.getExternalUriPattern(),prefix,Internets.localHostAddress(),this.getPort());
 else     uri=String.format(this.getExternalUriPattern(),Internets.localHostAddress(),this.getPort());
    try {
      u=new URI(uri);
      u.parseServerAuthority();
    }
 catch (    URISyntaxException ex) {
      u=URI.create(uri);
    }
  }
catch (  MissingFormatArgumentException e) {
    if (pattern.startsWith("%s"))     uri=String.format(this.getExternalUriPattern(),prefix,hostName,port,this.getCapitalizedName());
 else     uri=String.format(this.getExternalUriPattern(),hostName,port,this.getCapitalizedName());
    try {
      u=new URI(uri);
      u.parseServerAuthority();
    }
 catch (    URISyntaxException ex) {
      u=URI.create(uri);
    }
  }
  return u;
}
