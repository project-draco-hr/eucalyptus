{
  Address address=null;
  try {
    address=Addresses.getInstance().lookup(addr);
  }
 catch (  NoSuchElementException e) {
    throw new EucalyptusCloudException("Permission denied while trying to release address: " + addr);
  }
  Context ctx=Contexts.lookup();
  boolean isAdmin=ctx.hasAdministrativePrivileges();
  if (!isAdmin) {
    if (address.isSystemOwned()) {
      throw new EucalyptusCloudException("Non admin user cannot manipulate system owned address " + addr);
    }
    Account addrAccount=null;
    try {
      addrAccount=Accounts.lookupAccountById(address.getOwnerAccountNumber());
    }
 catch (    AuthException e) {
      throw new EucalyptusCloudException(e);
    }
    if (!Permissions.isAuthorized(PolicySpec.VENDOR_EC2,PolicySpec.EC2_RESOURCE_ADDRESS,addr,addrAccount,PolicySpec.requestToAction(request),ctx.getUser())) {
      throw new EucalyptusCloudException("Permission denied while trying to access address " + addr + " by "+ ctx.getUser());
    }
  }
  return address;
}
