{
  String provider="" + edu.ucsb.eucalyptus.cloud.entities.SystemConfiguration.getSystemConfiguration().isDoDynamicPublicAddresses() + Iterables.all(Clusters.getInstance().listValues(),new Predicate<Cluster>(){
    @Override public boolean apply(    Cluster arg0){
      return arg0.getState().isAddressingInitialized() ? arg0.getState().hasPublicAddressing() : true;
    }
  }
);
  try {
    if (Addresses.systemAddressManager == null) {
      Addresses.systemAddressManager=(AbstractSystemAddressManager)managerMap.get(provider).newInstance();
      LOG.info("Setting the address manager to be: " + systemAddressManager.getClass().getSimpleName());
    }
 else     if (!Addresses.systemAddressManager.getClass().equals(managerMap.get(provider))) {
      AbstractSystemAddressManager oldMgr=Addresses.systemAddressManager;
      Addresses.systemAddressManager=(AbstractSystemAddressManager)managerMap.get(provider).newInstance();
      Addresses.systemAddressManager.inheritReservedAddresses(oldMgr.getReservedAddresses());
      LOG.info("Setting the address manager to be: " + systemAddressManager.getClass().getSimpleName());
    }
  }
 catch (  Throwable e) {
    LOG.debug(e,e);
  }
  return Addresses.systemAddressManager;
}
