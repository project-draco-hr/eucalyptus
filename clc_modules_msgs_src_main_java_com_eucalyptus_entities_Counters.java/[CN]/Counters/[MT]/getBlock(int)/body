{
  final Long idStart;
  if (tempId.compareAndSet(-1l,this.messageId)) {
    lastSave.set(tempId.addAndGet(Counters.period));
    idStart=tempId.addAndGet(length);
  }
 else {
    idStart=tempId.addAndGet(length);
    if ((idStart - lastSave.get()) > 1000) {
      try {
        new _this(){
{
            new _mutator(){
              public void set(              Counters c){
                c.setMessageId(idStart);
              }
            }
.set();
          }
        }
;
      }
 catch (      EucalyptusCloudException e) {
        LOG.debug(e,e);
      }
      lastSave.set(idStart);
    }
  }
  return idStart;
}
