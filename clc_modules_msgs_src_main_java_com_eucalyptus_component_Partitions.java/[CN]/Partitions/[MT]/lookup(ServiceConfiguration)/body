{
  if (config.getComponentId().isPartitioned() && config.getComponentId().isRegisterable()) {
    Partition p;
    try {
      p=Partitions.lookupByName(config.getPartition());
    }
 catch (    NoSuchElementException ex) {
      LOG.warn("Failed to lookup partition for " + config + ".  Generating new partition configuration.");
      p=Partitions.generatePartition(config);
    }
    return p;
  }
 else   if (config.getComponentId().isPartitioned()) {
    return Partitions.lookupByName(config.getPartition());
  }
 else {
    return Partitions.lookupInternal(config);
  }
}
