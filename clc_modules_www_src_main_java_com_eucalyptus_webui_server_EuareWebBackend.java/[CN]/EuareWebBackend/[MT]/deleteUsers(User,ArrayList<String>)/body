{
  boolean hasError=false;
  for (  String id : ids) {
    try {
      User user=Accounts.lookupUserById(id);
      if (!(user.isSystemAdmin() && user.isAccountAdmin())) {
        Account account=user.getAccount();
        EuarePermission.authorizeDeleteUser(requestUser,account,user);
        account.deleteUser(user.getName(),false,true);
      }
 else {
        throw new IllegalArgumentException("Can't delete admin@eucalyptus");
      }
    }
 catch (    Exception e) {
      LOG.error("Failed to delete user " + id,e);
      LOG.debug(e,e);
      hasError=true;
    }
  }
  if (hasError) {
    throw new EucalyptusServiceException("Failed to delete some users");
  }
}
