{
  if (userName == null || accountName == null) {
    throw new EucalyptusServiceException("Empty user name or account name");
  }
  try {
    Account account=Accounts.lookupAccountByName(accountName);
    User user=account.lookupUserByName(userName);
    if (!user.isEnabled() || !user.getRegistrationStatus().equals(RegistrationStatus.CONFIRMED)) {
      throw new EucalyptusServiceException("User is not enabled or confirmed");
    }
    return user;
  }
 catch (  Exception e) {
    if (e instanceof EucalyptusServiceException) {
      throw (EucalyptusServiceException)e;
    }
    LOG.error("Failed to verify user " + userName + "@"+ accountName);
    LOG.debug(e,e);
    throw new EucalyptusServiceException("Failed to verify user " + userName + "@"+ accountName+ ": "+ e.getMessage());
  }
}
