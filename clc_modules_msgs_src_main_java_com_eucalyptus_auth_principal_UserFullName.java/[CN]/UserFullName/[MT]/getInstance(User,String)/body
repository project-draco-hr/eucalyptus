{
  try {
    if (user == null) {
      return new UserFullName(Principals.nobodyAccount(),Principals.nobodyUser());
    }
 else     if (Principals.systemUser().equals(user)) {
      return new UserFullName(Principals.systemAccount(),Principals.systemUser());
    }
 else     if (Principals.nobodyUser().equals(user)) {
      return new UserFullName(Principals.nobodyAccount(),Principals.nobodyUser());
    }
 else {
      Account account=user.getAccount();
      return new UserFullName(account,user);
    }
  }
 catch (  AuthException ex) {
    LOG.error(ex.getMessage());
    try {
      return new UserFullName(Principals.nobodyAccount(),Principals.nobodyUser());
    }
 catch (    AuthException ex1) {
      LOG.error(ex1,ex1);
      throw new UndeclaredThrowableException(ex);
    }
  }
catch (  Exception ex) {
    throw new UndeclaredThrowableException(ex);
  }
}
