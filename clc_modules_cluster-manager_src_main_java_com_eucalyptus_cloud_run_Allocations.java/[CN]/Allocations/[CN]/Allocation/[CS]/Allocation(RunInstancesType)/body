{
  super();
  this.context=Contexts.lookup();
  this.request=request;
  this.minCount=request.getMinCount();
  this.maxCount=request.getMaxCount();
  try {
    this.ownerFullName=Contexts.lookup(request.getCorrelationId()).getUserFullName();
  }
 catch (  NoSuchContextException ex) {
    throw new IllegalContextAccessException(ex);
  }
  if (this.request.getInstanceType() == null || "".equals(this.request.getInstanceType())) {
    this.request.setInstanceType(VmTypes.defaultTypeName());
  }
  this.reservationIndex=Counters.getIdBlock(request.getMaxCount());
  this.reservationId=VmInstances.getId(this.reservationIndex,0).replaceAll("i-","r-");
  byte[] tmpData=new byte[0];
  if (this.request.getUserData() != null) {
    try {
      tmpData=Base64.decode(this.request.getUserData());
      this.request.setUserData(new String(Base64.encode(tmpData)));
    }
 catch (    Exception e) {
    }
  }
}
