{
  final Context ctx=Contexts.lookup();
  final User requestUser=ctx.getUser();
  if (!requestUser.isSystemUser() || !Permissions.isAuthorized(VENDOR_REPORTING,ALL_RESOURCE,"",null,getIamActionByMessageType(),requestUser)) {
    throw new ReportingException(HttpResponseStatus.UNAUTHORIZED,ReportingException.NOT_AUTHORIZED,"Not authorized");
  }
}
