{
  EntityWrapper<SystemConfiguration> db=new EntityWrapper<SystemConfiguration>();
  SystemConfiguration sysConf=null;
  try {
    sysConf=db.getUnique(new SystemConfiguration());
    sysConf.setCloudHost(systemConfig.getCloudHost());
    sysConf.setDefaultKernel(systemConfig.getDefaultKernelId());
    sysConf.setDefaultRamdisk(systemConfig.getDefaultRamdiskId());
    sysConf.setDnsDomain(systemConfig.getDnsDomain());
    sysConf.setNameserver(systemConfig.getNameserver());
    sysConf.setNameserverAddress(systemConfig.getNameserverAddress());
    sysConf.setMaxUserPublicAddresses(systemConfig.getMaxUserPublicAddresses());
    sysConf.setDoDynamicPublicAddresses(systemConfig.isDoDynamicPublicAddresses());
    sysConf.setSystemReservedPublicAddresses(systemConfig.getSystemReservedPublicAddresses());
    sysConf.setZeroFillVolumes(systemConfig.getZeroFillVolumes());
    db.commit();
    DNSProperties.update();
  }
 catch (  EucalyptusCloudException e) {
    sysConf=new SystemConfiguration(systemConfig.getDefaultKernelId(),systemConfig.getDefaultRamdiskId(),systemConfig.getMaxUserPublicAddresses(),systemConfig.isDoDynamicPublicAddresses(),systemConfig.getSystemReservedPublicAddresses(),systemConfig.getZeroFillVolumes(),systemConfig.getDnsDomain(),systemConfig.getNameserver(),systemConfig.getNameserverAddress(),systemConfig.getCloudHost());
    db.add(sysConf);
    db.commit();
    DNSProperties.update();
  }
  try {
    ListenerRegistry.getInstance().fireEvent(new GenericEvent<SystemConfiguration>(sysConf));
  }
 catch (  EventVetoedException e) {
    LOG.debug(e,e);
  }
}
