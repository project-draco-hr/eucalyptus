{
  String ipAddr=null;
  String localAddr="127.0.0.1";
  List<NetworkInterface> ifaces=null;
  try {
    ifaces=Collections.list(NetworkInterface.getNetworkInterfaces());
  }
 catch (  SocketException e1) {
  }
  for (  NetworkInterface iface : ifaces)   try {
    if (!iface.isLoopback() && !iface.isVirtual() && iface.isUp()) {
      for (      InetAddress iaddr : Collections.list(iface.getInetAddresses())) {
        if (!iaddr.isSiteLocalAddress() && !(iaddr instanceof Inet6Address)) {
          ipAddr=iaddr.getHostAddress();
        }
 else         if (iaddr.isSiteLocalAddress() && !(iaddr instanceof Inet6Address)) {
          localAddr=iaddr.getHostAddress();
        }
      }
    }
  }
 catch (  SocketException e1) {
  }
  return ipAddr == null ? localAddr : ipAddr;
}
