{
  Groups.checkNotRestricted(gi.getName());
  try {
    Group group=Groups.lookupGroup(gi.name);
    Set<String> oldZoneSet=new HashSet<String>(getGroupZones(group));
    Set<String> newZoneSet=new HashSet<String>(gi.zones);
    Set<String> toRemove=Sets.difference(oldZoneSet,newZoneSet);
    Set<String> toAdd=Sets.difference(newZoneSet,oldZoneSet);
    for (    String zone : toRemove) {
      group.removeAuthorization(new AvailabilityZonePermission(zone));
    }
    for (    String zone : toAdd) {
      group.addAuthorization(new AvailabilityZonePermission(zone));
    }
  }
 catch (  NoSuchGroupException nsge) {
    throw new Exception("Can not find the group");
  }
}
