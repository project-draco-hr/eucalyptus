{
  if (index < 0) {
    throw new IllegalArgumentException("index value must be non-negative");
  }
  this.marshallerIndex=index;
  this.dataObject=obj;
  this.bindingFactory=factory;
  boolean found=false;
  final String[] nss=factory.getNamespaces();
  int nsidx=-1;
  for (int i=0; i < nsindexes.length; i++) {
    if (uri.equals(nss[nsindexes[i]])) {
      nsidx=nsindexes[i];
      prefix=nsprefixes[i];
      found=true;
      break;
    }
  }
  this.elementName=name;
  this.elementNamespace=uri;
  this.elementNamespacePrefix=prefix;
  if (!found) {
    for (int i=0; i < nss.length; i++) {
      if (uri.equals(nss[i])) {
        nsidx=i;
        break;
      }
    }
    if (nsidx >= 0) {
      final int[] icpy=new int[nsindexes.length + 1];
      icpy[0]=nsidx;
      System.arraycopy(nsindexes,0,icpy,1,nsindexes.length);
      nsindexes=icpy;
      final String[] scpy=new String[nsprefixes.length + 1];
      scpy[0]=prefix;
      System.arraycopy(nsprefixes,0,scpy,1,nsprefixes.length);
      nsprefixes=scpy;
    }
 else {
      throw new IllegalStateException("Namespace not found");
    }
  }
  this.elementNamespaceIndex=nsidx;
  this.openNamespaceIndexes=nsindexes;
  this.openNamespacePrefixes=nsprefixes;
}
