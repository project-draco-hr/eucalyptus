{
  try {
    if (this.marshallerIndex < 0) {
      if (this.dataObject instanceof IMarshallable) {
        ((IMarshallable)this.dataObject).marshal(ctx);
      }
 else {
        throw new IllegalStateException("Object of class " + this.dataObject.getClass().getName() + " needs a JiBX <mapping> to be marshalled");
      }
    }
 else {
      final IXMLWriter wrtr=ctx.getXmlWriter();
      String name=this.elementName;
      int nsidx=0;
      if (full) {
        nsidx=this.elementNamespaceIndex;
        wrtr.startTagNamespaces(nsidx,name,this.openNamespaceIndexes,this.openNamespacePrefixes);
      }
 else {
        wrtr.openNamespaces(this.openNamespaceIndexes,this.openNamespacePrefixes);
        if (!"".equals(this.elementNamespacePrefix)) {
          name=this.elementNamespacePrefix + ':' + name;
        }
        wrtr.startTagOpen(0,name);
      }
      final IMarshaller mrsh=ctx.getMarshaller(this.marshallerIndex,this.bindingFactory.getMappedClasses()[this.marshallerIndex]);
      mrsh.marshal(this.dataObject,ctx);
      wrtr.endTag(nsidx,name);
    }
    ctx.getXmlWriter().flush();
  }
 catch (  final IOException e) {
    throw new JiBXException("Error marshalling XML representation: " + e.getMessage(),e);
  }
}
