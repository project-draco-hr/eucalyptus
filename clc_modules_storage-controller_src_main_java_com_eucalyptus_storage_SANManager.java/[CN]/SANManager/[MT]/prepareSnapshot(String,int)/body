{
  EntityWrapper<SANVolumeInfo> db=StorageProperties.getEntityWrapper();
  try {
    SANVolumeInfo volInfo=new SANVolumeInfo(snapshotId);
    volInfo.setScName(null);
    SANVolumeInfo foundVolInfo=db.getUnique(volInfo);
    SANVolumeInfo volumeInfo=new SANVolumeInfo(snapshotId,foundVolInfo.getIqn(),sizeExpected);
    volumeInfo.setStatus(foundVolInfo.getStatus());
    volumeInfo.setSnapshotOf(foundVolInfo.getSnapshotOf());
    volumeInfo.setStoreUser(foundVolInfo.getStoreUser());
    db.add(volumeInfo);
    return null;
  }
 catch (  EucalyptusCloudException e) {
  }
 finally {
    db.commit();
  }
  String iqn=connectionManager.createVolume(snapshotId,sizeExpected);
  if (iqn != null) {
    String deviceName=connectionManager.connectTarget(iqn);
    SANVolumeInfo snapInfo=new SANVolumeInfo(snapshotId,iqn,sizeExpected);
    db=StorageProperties.getEntityWrapper();
    db.add(snapInfo);
    db.commit();
    return deviceName;
  }
  return null;
}
