{
  QueuedEventCallback event=null;
  E nextState=this.states[currentState.ordinal() + 1];
  while ((event=this.pendingEvents.poll()) != null) {
    while (!event.pollForResponse(1000l))     ;
    try {
      Object o=event.pollResponse(1000l);
      if (o != null) {
        LOG.info(EventRecord.here(StatefulMessageSet.class,EventType.VM_STARTING,currentState.name(),cluster.getName(),o.getClass().getSimpleName()));
      }
    }
 catch (    Throwable t) {
      LOG.info(EventRecord.here(StatefulMessageSet.class,EventType.VM_STARTING,currentState.name(),cluster.getName(),t.getClass().getSimpleName()));
      LOG.debug(t,t);
      nextState=this.rollback();
    }
  }
  LOG.info(EventRecord.here(StatefulMessageSet.class,EventType.VM_STARTING,currentState.name(),EventType.TRANSITION.name(),nextState.name()));
  return nextState;
}
