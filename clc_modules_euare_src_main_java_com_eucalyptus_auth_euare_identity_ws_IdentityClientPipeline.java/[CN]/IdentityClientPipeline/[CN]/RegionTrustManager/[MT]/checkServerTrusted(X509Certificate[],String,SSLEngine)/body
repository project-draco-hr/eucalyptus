{
  final X509Certificate serverCertificate=x509Certificates[0];
  final String hostname=sslEngine.getHandshakeSession().getPeerHost();
  if (Objects.firstNonNull(validateHostnames.get(),Boolean.TRUE))   try {
    new BrowserCompatHostnameVerifier().verify(hostname,serverCertificate);
  }
 catch (  SSLException e) {
    throw new CertificateException("Server cert not valid for host");
  }
  if (!regionConfigurationManager.isRegionSSLCertificate(hostname,serverCertificate)) {
    throw new CertificateException("Server cert not trusted");
  }
}
