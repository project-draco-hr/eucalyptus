{
  this.parent=parent;
  this.serviceConfiguration=serviceConfig;
  if (serviceConfig.isLocal()) {
    URI uri=this.parent.getConfiguration().getLocalUri();
    this.name=parent.getName() + LOCAL_HOSTNAME;
    this.endpoint=new ServiceEndpoint(this,true,uri);
  }
 else {
    Boolean local=false;
    try {
      local=NetworkUtil.testLocal(serviceConfig.getHostName());
    }
 catch (    Exception e) {
      local=true;
    }
    URI uri=null;
    if (local) {
      this.name=parent.getName() + "@" + serviceConfig.getHostName();
      uri=this.parent.getConfiguration().makeUri(serviceConfig.getHostName(),serviceConfig.getPort());
    }
 else {
      this.name=parent.getName() + LOCAL_HOSTNAME;
      uri=this.parent.getConfiguration().getLocalUri();
    }
    this.endpoint=new ServiceEndpoint(this,local,uri);
  }
  this.keys=new Credentials(this);
  this.dispatcher=DispatcherFactory.build(parent,this);
}
