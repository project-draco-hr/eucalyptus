{
  ClientConfiguration config=new ClientConfiguration();
  config.setConnectionTimeout(CONNECTION_TIMEOUT_MS);
  config.setMaxConnections(DEFAULT_MAX_CONNECTIONS);
  config.setMaxErrorRetry(DEFAULT_MAX_ERROR_RETRY);
  config.setUseReaper(true);
  config.setSocketTimeout(DEFAULT_SOCKET_READ_TIMEOUT_MS);
  config.setProtocol(withHttps ? Protocol.HTTPS : Protocol.HTTP);
  return config;
}
