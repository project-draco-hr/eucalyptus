{
  LOG.debug(LogUtil.header("Failing run instances because of: " + e.getMessage()));
  LOG.debug(LogUtil.subheader(this.getRequest().toString()));
  LOG.debug("-> Release resource tokens for unused resources.");
  try {
    Clusters.getInstance().lookup(token.getCluster()).getNodeState().redeemToken(token);
  }
 catch (  Exception e2) {
    LOG.debug(e2,e2);
  }
  LOG.debug("-> Release network index allocation.");
  NetworkToken net=this.token.getPrimaryNetwork();
  Network network=Networks.getInstance().lookup(net.getName());
  for (  Integer index : this.token.getPrimaryNetwork().getIndexes()) {
    network.returnNetworkIndex(index);
  }
  for (  String s : this.token.getAddresses()) {
    LOG.debug("-> Release addresses from failed vm run allocation: " + s);
    AddressManager.releaseAddress(s);
  }
  this.parent.getRollback().lazySet(true);
}
