{
  super();
  this.currentEpoch=i;
  this.internalQueue=ServiceConfigurations.createEphemeral(Empyrean.INSTANCE,Topology.class.getSimpleName(),"internal",ServiceUris.internal(Empyrean.INSTANCE));
  this.externalQueue=ServiceConfigurations.createEphemeral(Empyrean.INSTANCE,Topology.class.getSimpleName(),"external",ServiceUris.internal(Empyrean.INSTANCE));
  ListenerRegistry.getInstance().register(Hertz.class,this);
  for (  final ComponentId c : ComponentIds.list()) {
    this.componentFiltered.put(c.getClass(),Maps.filterEntries(this.getServices(),componentFilter(c.getClass())));
  }
  for (  final Partition p : Partitions.list()) {
    this.partitionFiltered.put(p,Maps.filterEntries(this.getServices(),partitionFilter(p)));
  }
}
