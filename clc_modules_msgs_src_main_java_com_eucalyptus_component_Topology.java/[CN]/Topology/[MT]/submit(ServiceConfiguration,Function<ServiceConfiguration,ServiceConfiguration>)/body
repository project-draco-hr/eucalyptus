{
  final Long queueStart=System.currentTimeMillis();
  final String functionName=function.getClass().toString().replaceAll("^.*\\.","");
  return Threads.enqueue(this.externalQueue,1,new Callable<ServiceConfiguration>(){
    @Override public ServiceConfiguration call() throws Exception {
      if (Bootstrap.isShuttingDown()) {
        return null;
      }
 else {
        Bootstrap.awaitFinished();
        Long serviceStart=System.currentTimeMillis();
        LOG.trace(EventRecord.here(Topology.class,EventType.DEQUEUE,functionName,config.getFullName().toString(),Long.toString(serviceStart - queueStart),"ms"));
        try {
          ServiceConfiguration result=function.apply(config);
          LOG.trace(EventRecord.here(Topology.class,EventType.QUEUE,functionName,config.getFullName().toString(),Long.toString(System.currentTimeMillis() - serviceStart),"ms"));
          return result;
        }
 catch (        Exception ex) {
          Logs.exhaust().error(ex,ex);
          LOG.error(ex);
          throw ex;
        }
      }
    }
  }
);
}
