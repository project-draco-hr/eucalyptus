{
  Partition partition=null;
  if (maybePartition != null && maybePartition.length > 0 && ComponentIds.lookup(compClass).isPartitioned()) {
    partition=maybePartition[0];
  }
  ServiceConfiguration res=Topology.getInstance().getServices().get(ServiceKey.create(ComponentIds.lookup(compClass),partition));
  if (res == null) {
    throw new NoSuchElementException("Failed to lookup ENABLED service of type " + compClass.getSimpleName() + (partition != null ? " in partition " + partition : "."));
  }
 else {
    return res;
  }
}
