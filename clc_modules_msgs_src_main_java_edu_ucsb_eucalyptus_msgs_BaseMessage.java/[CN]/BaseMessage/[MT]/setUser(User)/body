{
  if (user == null) {
    this.setUser(FakePrincipals.NOBODY_USER);
  }
 else {
    this.user=user;
    this.userId=user.getName();
    this.effectiveUserId=this.isAdministrator() ? FakePrincipals.SYSTEM_USER.getName() : user.getName();
  }
  return this;
}
