{
  if (user == null) {
    this.setUser(FakePrincipals.NOBODY_USER);
  }
 else {
    this.userId=user.getName();
    this.effectiveUserId=(this.getUser().isSystemAdmin() || this.getUser().isSystemInternal()) ? FakePrincipals.SYSTEM_USER.getName() : user.getName();
  }
  return this;
}
