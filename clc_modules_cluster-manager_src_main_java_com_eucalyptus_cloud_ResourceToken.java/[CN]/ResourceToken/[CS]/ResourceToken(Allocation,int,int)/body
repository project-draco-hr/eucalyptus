{
  this.allocation=allocInfo;
  Contract<Date> expiry=allocInfo.getContext().getContracts().get(Contract.Type.EXPIRATION);
  this.expirationTime=expiry.getValue();
  this.launchIndex=launchIndex;
  String tempVmId=VmInstances.getId(allocInfo.getReservationIndex(),launchIndex);
  try {
    if (Contexts.lookup().getRequest() instanceof StartInstancesType) {
      tempVmId=((StartInstancesType)Contexts.lookup().getRequest()).getInstancesSet().get(launchIndex);
    }
  }
 catch (  Exception ex) {
    LOG.error(ex,ex);
  }
  this.instanceId=tempVmId;
  this.instanceUuid=UUID.randomUUID().toString();
  this.resourceAllocationSequenceNumber=resourceAllocationSequenceNumber;
  this.creationTime=Calendar.getInstance().getTime();
}
