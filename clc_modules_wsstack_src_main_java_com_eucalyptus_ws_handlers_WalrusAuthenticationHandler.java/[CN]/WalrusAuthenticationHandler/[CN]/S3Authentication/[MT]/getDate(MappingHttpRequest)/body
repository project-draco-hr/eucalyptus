{
  String date;
  String verifyDate;
  if (httpRequest.containsHeader("x-amz-date")) {
    date="";
    verifyDate=httpRequest.getHeader("x-amz-date");
  }
 else {
    date=httpRequest.getAndRemoveHeader(SecurityParameter.Date.toString());
    verifyDate=date;
    if (date == null || date.length() <= 0)     throw new AuthenticationException("User authentication failed. Date must be specified.");
  }
  try {
    Date dateToVerify=DateUtil.parseDate(verifyDate);
    Date currentDate=new Date();
    if (Math.abs(currentDate.getTime() - dateToVerify.getTime()) > WalrusProperties.EXPIRATION_LIMIT)     throw new AuthenticationException("Message expired. Sorry.");
  }
 catch (  Exception ex) {
    throw new AuthenticationException("Unable to parse date.");
  }
  return verifyDate;
}
