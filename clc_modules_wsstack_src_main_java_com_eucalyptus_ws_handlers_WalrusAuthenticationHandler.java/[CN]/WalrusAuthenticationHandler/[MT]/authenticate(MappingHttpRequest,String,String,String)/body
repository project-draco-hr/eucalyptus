{
  signature=signature.replaceAll("=","");
  try {
    String queryKey=UserCredentialProvider.getSecretKey(accessKeyID);
    String authSig=checkSignature(queryKey,data);
    if (!authSig.equals(signature))     throw new AuthenticationException("User authentication failed. Could not verify signature");
    String userName=UserCredentialProvider.getUserName(accessKeyID);
    User user=UserCredentialProvider.getUser(userName);
    httpRequest.setUser(user);
  }
 catch (  Exception ex) {
    throw new AuthenticationException("User authentication failed. Unable to obtain query key");
  }
}
