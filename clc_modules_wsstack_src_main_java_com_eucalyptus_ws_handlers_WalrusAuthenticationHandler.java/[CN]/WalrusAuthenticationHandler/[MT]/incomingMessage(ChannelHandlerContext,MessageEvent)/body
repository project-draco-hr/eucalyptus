{
  if (event.getMessage() instanceof MappingHttpRequest) {
    MappingHttpRequest httpRequest=(MappingHttpRequest)event.getMessage();
    removeDuplicateHeaderValues(httpRequest);
    canonicalizeHeaders(httpRequest);
    if (httpRequest.containsHeader(WalrusProperties.Headers.S3UploadPolicy.toString())) {
      checkUploadPolicy(httpRequest);
    }
    handle(httpRequest);
  }
}
