{
  final String userId=evt.getUserId();
  final String systemUserId=getSystemUserId();
  String acctNumber=null;
  try {
    acctNumber=Accounts.lookupUserById(userId).getAccountNumber();
  }
 catch (  final AuthException ex) {
    throw new EventHandlerException("Failed to lookup account number",ex);
  }
  try {
    roleName=this.getChain().findHandler(IamRoleSetup.class).getResult().get(0);
  }
 catch (  final Exception ex) {
    throw new EventHandlerException("failed to find the created role name",ex);
  }
  final String policyName=String.format("%s-%s-%s",VOLUME_OPS_ROLE_POLICY_NAME_PREFIX,acctNumber,evt.getDbInstanceIdentifier());
  final String rolePolicyDoc=ROLE_VOLUME_OPS_POLICY_DOCUMENT;
  try {
    final GetRolePolicyResult rolePolicy=EuareClient.getInstance().getRolePolicy(systemUserId,roleName,policyName);
    if (rolePolicy != null && policyName.equals(rolePolicy.getPolicyName()))     this.createdPolicyName=policyName;
  }
 catch (  final Exception ex) {
    ;
  }
  if (this.createdPolicyName == null) {
    try {
      EuareClient.getInstance().putRolePolicy(systemUserId,roleName,policyName,rolePolicyDoc);
      createdPolicyName=policyName;
    }
 catch (    final Exception ex) {
      throw new EventHandlerException("failed to authorize volume operations",ex);
    }
  }
}
