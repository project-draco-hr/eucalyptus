{
  UpdateARecordResponseType reply=(UpdateARecordResponseType)request.getReply();
  String zone=request.getZone();
  String name=request.getName();
  String address=request.getAddress();
  long ttl=request.getTtl();
  if (!request.isAdministrator()) {
    throw new AccessDeniedException(name);
  }
  EntityWrapper<ARecordInfo> db=new EntityWrapper<ARecordInfo>();
  ARecordInfo aRecordInfo=new ARecordInfo();
  aRecordInfo.setName(name);
  List<ARecordInfo> arecords=db.query(aRecordInfo);
  if (arecords.size() > 0) {
    aRecordInfo=arecords.get(0);
    aRecordInfo.setAddress(address);
    aRecordInfo.setTtl(ttl);
    aRecordInfo.setZone(zone);
  }
 else {
    aRecordInfo=new ARecordInfo();
    aRecordInfo.setAddress(address);
    aRecordInfo.setTtl(ttl);
    aRecordInfo.setZone(zone);
  }
  EntityWrapper<ZoneInfo> dbZone=db.recast(ZoneInfo.class);
  ZoneInfo zoneInfo=new ZoneInfo(zone);
  List<ZoneInfo> zoneInfos=dbZone.query(zoneInfo);
  if (zoneInfos.size() == 0) {
    dbZone.add(zoneInfo);
  }
  db.commit();
  return reply;
}
