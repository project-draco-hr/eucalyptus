{
  if (Bootstrap.isFinished() && Topology.isEnabledLocally(LoadBalancingBackend.class) && Topology.isEnabled(Compute.class)&& isCloudVpc()) {
    final Date now=new Date(System.currentTimeMillis());
    final int elapsedSec=(int)((now.getTime() - lastCheckTime.getTime()) / 1000.0);
    if (elapsedSec < CHECK_INTERVAL_SEC)     return;
    lastCheckTime=now;
    final List<String> availabilityZones=Lists.newArrayList(Collections2.transform(EucalyptusActivityTasks.getInstance().describeAvailabilityZones(),new Function<ClusterInfoType,String>(){
      @Nullable @Override public String apply(      @Nullable ClusterInfoType clusterInfoType){
        return clusterInfoType.getZoneName();
      }
    }
));
    for (    final String az : availabilityZones) {
      if (!KnownAvailabilityZones.contains(az)) {
        try {
          LOG.info("Trying to prepare system VPC for a new AZ: " + az);
          prepareSystemVpc();
        }
 catch (        final Exception ex) {
          LOG.error("System VPC setup failed",ex);
        }
 finally {
          KnownAvailabilityZones.add(az);
          break;
        }
      }
    }
  }
}
