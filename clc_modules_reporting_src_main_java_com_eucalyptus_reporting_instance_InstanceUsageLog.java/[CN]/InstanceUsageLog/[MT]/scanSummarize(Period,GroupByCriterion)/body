{
  Map<String,UsageSummary> results=new HashMap<String,UsageSummary>();
  for (  LogScanResult result : scanLog(period)) {
    Period resPeriod=result.getPeriod();
    UsageData usageData=result.getUsageData();
    String attrValue=getAttributeValue(criterion,result.getInstanceAttributes());
    UsageSummary summary;
    if (results.containsKey(attrValue)) {
      summary=results.get(attrValue);
    }
 else {
      summary=new UsageSummary();
      results.put(attrValue,summary);
    }
    String insType=result.getInstanceAttributes().getInstanceType();
    summary.sumFromPeriodType(resPeriod,insType);
    summary.sumFromUsageData(usageData);
  }
  return results;
}
