{
  if (period == null)   throw new IllegalArgumentException("period must not be null");
  log.debug(String.format("getPeriodInstanceUsages periodBeginMs:%d periodsEndMs:%d ",period.getBeginningMs(),period.getEndingMs()));
  Iterator resultIter=null;
  EntityWrapper entityWrapper=EntityWrapper.get(InstanceAttributes.class);
  Session sess=null;
  try {
    sess=entityWrapper.getSession();
    resultIter=sess.createQuery("from InstanceAttributes, InstanceUsageSnapshot" + " where InstanceAttributes.uuid = InstanceUsageSnapshot.uuid" + " and InstanceUsageSnapshot.timestampMs > ?"+ " and InstanceUsageSnapshot.timestampMs < ?"+ " order by InstanceAttributes.uuid").setLong(0,period.getBeginningMs()).setLong(1,period.getEndingMs()).iterate();
    entityWrapper.commit();
  }
 catch (  Exception ex) {
    log.error(ex);
    entityWrapper.rollback();
  }
  return new LogResultSet(resultIter,period);
}
