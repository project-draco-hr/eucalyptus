{
  if ("NONE".equals(eucaSource)) {
    source=null;
  }
 else   if (eucaSource.startsWith("groovy:")) {
    source=Groovyness.newInstance(eucaSource.replace("groovy:",""));
  }
 else {
    source=(DatabaseSource)ClassLoader.getSystemClassLoader().loadClass(eucaSource).newInstance();
  }
  if (source != null) {
    Runtime.getRuntime().addShutdownHook(new Thread(){
      @Override public void run(){
        for (        Sql s : StandalonePersistence.sqlConnections.values()) {
          try {
            s.close();
          }
 catch (          Exception e) {
            LOG.debug(e,e);
          }
        }
      }
    }
);
    List<String> oldContexts=ServiceJarDiscovery.contextsInDir(oldLibDir);
    for (    String ctx : oldContexts) {
      StandalonePersistence.getConnection(ctx);
    }
  }
}
