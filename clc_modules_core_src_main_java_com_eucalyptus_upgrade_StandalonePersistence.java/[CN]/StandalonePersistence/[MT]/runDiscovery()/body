{
  List<Class> classList=ServiceJarDiscovery.classesInDir(new File(BaseDirectory.LIB.toString()));
  for (  ServiceJarDiscovery d : Lists.newArrayList(new PersistenceContextDiscovery(),new UpgradeScriptDiscovery())) {
    for (    Class c : classList) {
      try {
        d.checkClass(c);
      }
 catch (      Throwable t) {
        if (t instanceof ClassNotFoundException) {
        }
 else {
          LOG.debug(t,t);
        }
      }
    }
  }
  for (  File script : SubDirectory.UPGRADE.getFile().listFiles()) {
    LOG.debug("Trying to load what looks like an upgrade script: " + script.getAbsolutePath());
    try {
      UpgradeScript u=GroovyUtil.newInstance(script.getAbsolutePath());
      registerUpgradeScript(u);
    }
 catch (    ScriptExecutionFailedException e) {
      LOG.debug(e,e);
    }
  }
}
