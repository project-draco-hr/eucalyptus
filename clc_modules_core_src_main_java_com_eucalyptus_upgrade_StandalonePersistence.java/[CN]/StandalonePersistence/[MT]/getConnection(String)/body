{
  if (source == null)   throw new SQLException("Source not available");
  Sql newSql=source.getSqlSession(persistenceContext);
  if (newSql == null) {
    return null;
  }
  Sql conn=sqlConnections.putIfAbsent(persistenceContext,newSql);
  if (conn != null) {
    newSql.close();
  }
 else {
    conn=newSql;
    LOG.info("Created new connection for: " + persistenceContext + " to "+ conn.getConnection().getMetaData().getURL());
  }
  return conn;
}
