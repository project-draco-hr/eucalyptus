{
  if (event.getMessage() instanceof MappingHttpRequest) {
    MappingHttpRequest httpRequest=(MappingHttpRequest)event.getMessage();
    String bindingVersion=httpRequest.getParameters().remove(RequiredQueryParams.Version.toString());
    if (bindingVersion.matches("\\d\\d\\d\\d-\\d\\d-\\d\\d")) {
      this.setNamespaceVersion(bindingVersion);
    }
 else {
      this.setNamespace(BindingManager.DEFAULT_BINDING_NAME);
    }
    this.binding=BindingManager.getBinding(BindingManager.sanitizeNamespace(this.namespace));
    String userName=Contexts.lookup(httpRequest.getCorrelationId()).getUser().getName();
    try {
      BaseMessage msg=(BaseMessage)this.bind(userName,true,httpRequest);
      httpRequest.setMessage(msg);
    }
 catch (    Exception e) {
      if (!(e instanceof BindingException)) {
        e=new BindingException(e);
      }
      throw e;
    }
  }
}
