{
  if (event.getMessage() instanceof MappingHttpRequest) {
    MappingHttpRequest httpRequest=(MappingHttpRequest)event.getMessage();
    String bindingVersion=httpRequest.getParameters().remove(RequiredQueryParams.Version.toString());
    if (bindingVersion.matches("\\d\\d\\d\\d-\\d\\d-\\d\\d")) {
      this.namespace="http://ec2.amazonaws.com/doc/" + bindingVersion + "/";
    }
 else {
      this.namespace="http://msgs.eucalyptus.ucsb.edu";
    }
    String userName=CredentialProvider.getUserName(httpRequest.getParameters().get(SecurityParameter.AWSAccessKeyId));
    httpRequest.setMessage(this.bind(userName,true,httpRequest));
  }
}
