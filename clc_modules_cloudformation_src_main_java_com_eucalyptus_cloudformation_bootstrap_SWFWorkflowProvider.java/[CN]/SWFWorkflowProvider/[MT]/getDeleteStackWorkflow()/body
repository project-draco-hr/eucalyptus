{
  DeleteStackWorkflow deleteStackWorkflow;
  if (deleteStackWorkflowWorker != null) {
    LOG.info("Using SWF mode for delete");
    WorkflowClientFactory workflowClientFactory=new WorkflowClientFactory(simpleWorkflowClient,SWF_DOMAIN,SWF_TASKLIST);
    WorkflowDescriptionTemplate workflowDescriptionTemplate=new DeleteStackWorkflowDescriptionTemplate();
    InterfaceBasedWorkflowClient<DeleteStackWorkflow> client=workflowClientFactory.getNewWorkflowClient(DeleteStackWorkflow.class,workflowDescriptionTemplate,new WorkflowTags());
    deleteStackWorkflow=new DeleteStackWorkflowClient(client);
  }
 else {
    LOG.info("Using local mode for delete (in SWF)");
    deleteStackWorkflow=new DeleteStackWorkflowImpl();
    ((DeleteStackWorkflowImpl)deleteStackWorkflow).setWorkflowOperations(LocalWorkflowOperations.<StackActivity>of(new StackActivityImpl()));
  }
  return deleteStackWorkflow;
}
