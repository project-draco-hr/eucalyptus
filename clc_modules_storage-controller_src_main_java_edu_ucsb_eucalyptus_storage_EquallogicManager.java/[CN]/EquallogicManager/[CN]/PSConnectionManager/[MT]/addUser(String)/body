{
  EntityWrapper<CHAPUserInfo> db=StorageController.getEntityWrapper();
  try {
    CHAPUserInfo userInfo=db.getUnique(new CHAPUserInfo(userName));
    db.commit();
  }
 catch (  EucalyptusCloudException ex) {
    db.rollback();
    try {
      String returnValue=execCommand("stty hardwrap off\u001Achapuser create " + userName + "\u001A");
      String password=matchPattern(returnValue,USER_CREATE_PATTERN);
      db=StorageController.getEntityWrapper();
      CHAPUserInfo userInfo=new CHAPUserInfo(userName,encryptSCTargetPassword(password));
      db.add(userInfo);
      db.commit();
    }
 catch (    EucalyptusCloudException e) {
      LOG.error(e);
      throw e;
    }
  }
}
