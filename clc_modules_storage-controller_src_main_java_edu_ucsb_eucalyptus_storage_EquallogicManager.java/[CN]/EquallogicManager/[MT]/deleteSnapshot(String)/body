{
  String volumeId;
  EntityWrapper<EquallogicVolumeInfo> db=StorageController.getEntityWrapper();
  try {
    EquallogicVolumeInfo volumeInfo=db.getUnique(new EquallogicVolumeInfo(snapshotId));
    volumeId=volumeInfo.getSnapshotOf();
  }
 catch (  EucalyptusCloudException ex) {
    LOG.error(ex);
    throw new NoSuchEntityException(snapshotId);
  }
 finally {
    db.commit();
  }
  if (connectionManager.deleteSnapshot(volumeId,snapshotId)) {
    try {
      db=StorageController.getEntityWrapper();
      EquallogicVolumeInfo snapInfo=db.getUnique(new EquallogicVolumeInfo(snapshotId));
      db.delete(snapInfo);
    }
 catch (    EucalyptusCloudException ex) {
      LOG.error(ex);
      throw ex;
    }
 finally {
      db.commit();
    }
  }
}
