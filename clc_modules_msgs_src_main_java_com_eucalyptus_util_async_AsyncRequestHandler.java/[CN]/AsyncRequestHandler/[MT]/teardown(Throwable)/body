{
  if (t != null && !this.response.isDone()) {
    LOG.debug("RESULT:" + t.getMessage() + ":REQUEST:"+ ((request.get() != null) ? request.get().getClass() : "REQUEST IS NULL"));
    if (t instanceof RetryableConnectionException) {
      LOG.trace(t.getMessage());
    }
 else     if (t instanceof ConnectionException) {
      LOG.trace(t.getMessage());
    }
 else     if (t instanceof IOException) {
      LOG.trace(t.getMessage());
    }
    this.response.setException(t);
  }
 else   if (t != null && this.response.isDone()) {
    LOG.trace(t.getMessage());
    this.response.setException(t);
  }
  if (this.connectFuture != null) {
    if (this.connectFuture.isDone() && this.connectFuture.isSuccess()) {
      Channel channel=this.connectFuture.getChannel();
      if (channel != null && channel.isOpen()) {
        channel.close().addListener(new ChannelFutureListener(){
          @Override public void operationComplete(          ChannelFuture future) throws Exception {
            EventRecord.here(AsyncRequestHandler.this.request.get().getClass(),EventClass.SYSTEM_REQUEST,EventType.CHANNEL_CLOSED).trace();
          }
        }
);
      }
 else {
        EventRecord.here(AsyncRequestHandler.this.request.get().getClass(),EventClass.SYSTEM_REQUEST,EventType.CHANNEL_CLOSED,"ALREADY_CLOSED").trace();
      }
    }
 else     if (!this.connectFuture.isDone() && !this.connectFuture.cancel()) {
      LOG.error("Failed to cancel in-flight connection request: " + this.connectFuture.toString());
      Channel channel=this.connectFuture.getChannel();
      if (channel != null) {
        channel.close();
      }
    }
 else     if (!this.connectFuture.isSuccess()) {
      Channel channel=this.connectFuture.getChannel();
      if (channel != null) {
        channel.close();
      }
    }
  }
 else {
    this.response.setException(t);
  }
}
