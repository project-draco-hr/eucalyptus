{
  StringBuilder sb=new StringBuilder();
  List<StackTraceElement> filteredStes=Lists.newArrayList();
  for (  final StackTraceElement ste : ex.getStackTrace()) {
    boolean printSte=Iterables.any(fqClassPrefixes,new Predicate<String>(){
      @Override public boolean apply(      String arg0){
        return ste.getClassName().startsWith(arg0);
      }
    }
);
    printSte|=Iterables.any(fqClassPrefixes,new Predicate<String>(){
      @Override public boolean apply(      String arg0){
        return ste.toString().matches(".*" + arg0 + ".*");
      }
    }
);
    filteredStes.add(ste);
    if (filteredStes.size() >= maxDepth) {
      break;
    }
  }
  return filteredStes;
}
