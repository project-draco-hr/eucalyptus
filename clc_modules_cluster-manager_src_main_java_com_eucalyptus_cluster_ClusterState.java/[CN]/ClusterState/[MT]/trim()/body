{
  NavigableSet<Integer> newVlanList=Sets.newTreeSet();
  int min=2;
  int max=4095;
  try {
    for (    ServiceConfiguration conf : ServiceConfigurations.list(ClusterController.class)) {
      ClusterConfiguration cc=(ClusterConfiguration)conf;
      if (cc.getMinVlan() != null)       min=cc.getMinVlan() > min ? cc.getMinVlan() : min;
      if (cc.getMaxVlan() != null)       max=cc.getMaxVlan() < max ? cc.getMaxVlan() : max;
    }
  }
 catch (  PersistenceException e) {
    LOG.debug(e,e);
  }
  for (int i=min; i < max; i++)   newVlanList.add(i);
  newVlanList.removeAll(availableVlans);
  availableVlans.removeAll(availableVlans.headSet(min));
  availableVlans.removeAll(availableVlans.tailSet(max));
  for (int i=min; i < max; i++) {
    if (!newVlanList.contains(i)) {
      availableVlans.add(i);
    }
  }
  EventRecord.here(ClusterState.class,EventType.CONFIG_VLANS,Integer.toString(min),Integer.toString(max),availableVlans.toString().substring(0,50 > availableVlans.toString().length() ? availableVlans.toString().length() : 50)).debug();
}
