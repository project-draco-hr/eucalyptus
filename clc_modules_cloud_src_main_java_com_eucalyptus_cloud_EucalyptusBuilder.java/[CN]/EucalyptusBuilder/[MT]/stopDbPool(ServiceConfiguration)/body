{
  final String hostName=config.getHostName();
  for (  String ctx : PersistenceContexts.list()) {
    final String contextName=ctx.startsWith("eucalyptus_") ? ctx : "eucalyptus_" + ctx;
    String dbUrl="jdbc:" + ComponentIds.lookup(Database.class).makeExternalRemoteUri(hostName,8777,"http").toASCIIString() + "_"+ contextName.replace("eucalyptus_","");
    try {
      DriverDatabaseClusterMBean cluster=Mbeans.lookup(jdbcJmxDomain,ImmutableMap.builder().put("cluster",contextName).build(),DriverDatabaseClusterMBean.class);
      try {
        if (cluster.getActiveDatabases().contains(hostName)) {
          cluster.deactivate(hostName);
        }
        if (cluster.getInactiveDatabases().contains(hostName)) {
          cluster.remove(hostName);
        }
      }
 catch (      Exception ex) {
        LOG.error(ex,ex);
      }
    }
 catch (    NoSuchElementException ex1) {
      LOG.error(ex1,ex1);
    }
catch (    Exception ex1) {
      LOG.error(ex1,ex1);
    }
  }
}
