{
  if (event.getMessage() instanceof MappingHttpMessage) {
    MappingHttpMessage httpMessage=(MappingHttpMessage)event.getMessage();
    Class msgType=null;
    try {
      msgType=ClassLoader.getSystemClassLoader().loadClass("edu.ucsb.eucalyptus.msgs." + httpMessage.getOmMessage().getLocalName() + "Type");
    }
 catch (    ClassNotFoundException e) {
    }
    BaseMessage msg=null;
    OMElement elem=httpMessage.getOmMessage();
    OMNamespace omNs=elem.getNamespace();
    String namespace=omNs.getNamespaceURI();
    try {
      this.binding=BindingManager.getBinding(BindingManager.sanitizeNamespace(namespace));
    }
 catch (    Exception e1) {
      if (this.binding == null) {
        throw new WebServicesException(e1);
      }
    }
    try {
      if (httpMessage instanceof MappingHttpRequest) {
        if (msgType != null) {
          msg=(BaseMessage)this.binding.fromOM(httpMessage.getOmMessage(),msgType);
        }
 else {
          msg=(BaseMessage)this.binding.fromOM(httpMessage.getOmMessage());
        }
      }
 else {
        msg=(BaseMessage)this.binding.fromOM(httpMessage.getOmMessage());
      }
    }
 catch (    Exception e1) {
      LOG.fatal("FAILED TO PARSE:\n" + httpMessage.getMessageString());
      throw new WebServicesException(e1);
    }
    msg.setCorrelationId(httpMessage.getCorrelationId());
    httpMessage.setMessage(msg);
  }
}
