{
  if (event.getMessage() instanceof MappingHttpMessage) {
    MappingHttpMessage httpMessage=(MappingHttpMessage)event.getMessage();
    Class msgType=Class.forName("edu.ucsb.eucalyptus.msgs." + httpMessage.getOmMessage().getLocalName() + "Type");
    EucalyptusMessage msg=null;
    OMElement elem=httpMessage.getOmMessage();
    OMNamespace omNs=elem.getNamespace();
    String namespace=omNs.getNamespaceURI();
    try {
      this.binding=BindingManager.getBinding(BindingManager.sanitizeNamespace(namespace));
    }
 catch (    Exception e1) {
      if (this.binding == null) {
        throw new WebServicesException(e1);
      }
    }
    try {
      msg=(EucalyptusMessage)this.binding.fromOM(httpMessage.getOmMessage(),msgType);
    }
 catch (    Exception e1) {
      LOG.fatal("FAILED TO PARSE:\n" + httpMessage.getMessageString());
      throw new WebServicesException(e1);
    }
    httpMessage.setMessage(msg);
  }
}
