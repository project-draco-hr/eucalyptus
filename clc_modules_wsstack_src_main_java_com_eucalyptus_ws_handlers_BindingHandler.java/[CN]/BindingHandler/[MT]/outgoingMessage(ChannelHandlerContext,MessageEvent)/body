{
  if (event.getMessage() instanceof MappingHttpMessage) {
    MappingHttpMessage httpRequest=(MappingHttpMessage)event.getMessage();
    if (httpRequest.getMessage() instanceof EucalyptusErrorMessageType || httpRequest.getMessage() == null) {
      return;
    }
    Class targetClass=httpRequest.getMessage().getClass();
    while (!targetClass.getSimpleName().endsWith("Type"))     targetClass=targetClass.getSuperclass();
    Class responseClass=Class.forName(targetClass.getName());
    ctx.setAttachment(responseClass);
    OMElement omElem=this.binding.toOM(httpRequest.getMessage());
    httpRequest.setOmMessage(omElem);
  }
}
