{
  logRequest(request);
  ObjectEntity objectEntity;
  Bucket bucket;
  try {
    bucket=BucketMetadataManagers.getInstance().lookupExtantBucket(request.getBucket());
    objectEntity=ObjectMetadataManagers.getInstance().lookupObject(bucket,request.getKey(),request.getVersionid());
  }
 catch (  NoSuchElementException e) {
    throw new NoSuchVersionException(request.getBucket() + "/" + request.getKey()+ "?versionId="+ request.getVersionid());
  }
catch (  Exception e) {
    LOG.error("Error getting metadata for delete version operation on " + request.getBucket() + "/"+ request.getKey()+ "?version="+ request.getVersionid());
    throw new InternalErrorException(request.getBucket());
  }
  if (OsgAuthorizationHandler.getInstance().operationAllowed(request,bucket,objectEntity,0)) {
    throw new NotImplementedException("DELETE ?version");
  }
 else {
    throw new AccessDeniedException(request.getBucket());
  }
}
