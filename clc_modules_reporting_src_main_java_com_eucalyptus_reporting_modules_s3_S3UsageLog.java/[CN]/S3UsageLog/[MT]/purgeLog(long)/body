{
  log.info(String.format("purge earlierThan:%d ",earlierThanMs));
  EntityWrapper<S3UsageSnapshot> entityWrapper=EntityWrapper.get(S3UsageSnapshot.class);
  try {
    entityWrapper.createSQLQuery("DELETE FROM s3_usage_snapshot " + "WHERE timestamp_ms < ?").setLong(0,new Long(earlierThanMs)).executeUpdate();
    entityWrapper.commit();
  }
 catch (  Exception ex) {
    log.error(ex);
    entityWrapper.rollback();
    throw new RuntimeException(ex);
  }
}
