{
  EntityWrapper<WalrusInfo> db=EntityWrapper.get(WalrusInfo.class);
  WalrusInfo walrusInfo=null;
  try {
    walrusInfo=db.getUnique(new WalrusInfo());
    if (walrusInfo.getStorageMaxTotalCapacity() == null) {
      walrusInfo.setStorageMaxTotalCapacity(estimateWalrusCapacity());
    }
  }
 catch (  Exception ex) {
    walrusInfo=new WalrusInfo(WalrusProperties.NAME,WalrusProperties.bucketRootDirectory,WalrusProperties.MAX_BUCKETS_PER_ACCOUNT,(int)(WalrusProperties.MAX_BUCKET_SIZE / WalrusProperties.M),(int)(WalrusProperties.IMAGE_CACHE_SIZE / WalrusProperties.M),WalrusProperties.MAX_TOTAL_SNAPSHOT_SIZE,estimateWalrusCapacity());
    db.add(walrusInfo);
  }
 finally {
    db.commit();
  }
  return walrusInfo;
}
