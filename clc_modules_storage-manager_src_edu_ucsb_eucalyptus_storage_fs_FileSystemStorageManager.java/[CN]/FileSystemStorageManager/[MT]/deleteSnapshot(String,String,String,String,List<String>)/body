{
  ArrayList<String> loDevices=new ArrayList<String>();
  String snapshotLoDev=null;
  for (  String snapshot : snapshotSet) {
    String loDevName=createLoopback(rootDirectory + FILE_SEPARATOR + bucket+ FILE_SEPARATOR+ snapshot);
    if (loDevName.length() == 0)     throw new EucalyptusCloudException("could not create loopback device for " + snapshot);
    if (snapshot.equals(snapshotId))     snapshotLoDev=loDevName;
    loDevices.add(loDevName);
  }
  String absoluteLVName=lvmRootDirectory + FILE_SEPARATOR + vgName+ FILE_SEPARATOR+ lvName;
  String returnValue=removeLogicalVolume(absoluteLVName);
  returnValue=reduceVolumeGroup(vgName,snapshotLoDev);
  returnValue=removePhysicalVolume(snapshotLoDev);
  for (  String loDevice : loDevices) {
    returnValue=removeLoopback(loDevice);
  }
}
