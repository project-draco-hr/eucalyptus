{
  try {
    if (!address.isPending()) {
      for (      VmInstance vm : VmInstances.getInstance().listValues()) {
        if (addrInfo.getInstanceIp().equals(vm.getPrivateAddress()) && VmState.RUNNING.equals(vm.getRuntimeState())) {
          LOG.warn("Out of band address state change: " + LogUtil.dumpObject(addrInfo) + " address="+ address+ " vm="+ vm);
          if (!address.isAllocated()) {
            address.pendingAssignment().assign(vm).clearPending();
          }
 else {
            address.assign(vm).clearPending();
          }
          cluster.getState().clearOrphan(addrInfo);
          return;
        }
      }
    }
  }
 catch (  IllegalStateException e) {
    LOG.error(e);
  }
}
