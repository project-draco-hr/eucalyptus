{
  StringBuffer salt=new StringBuffer();
  java.security.SecureRandom randgen=Crypto.getSecureRandomSupplier().get();
  while (salt.length() < 8) {
    int index=(int)(randgen.nextFloat() * SALTCHARS.length());
    salt.append(SALTCHARS.substring(index,index + 1));
  }
  return MD5Crypt.apacheCrypt(password,salt.toString());
}
