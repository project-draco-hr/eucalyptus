{
  if (md5CryptText.startsWith("$1$")) {
    return md5CryptText.equals(MD5Crypt.crypt(plaintextPass,md5CryptText));
  }
 else   if (md5CryptText.startsWith("$apr1$")) {
    return md5CryptText.equals(MD5Crypt.apacheCrypt(plaintextPass,md5CryptText));
  }
 else {
    throw new IllegalArgumentException("Bad md5CryptText");
  }
}
