{
  String workerType=com.eucalyptus.imaging.ImagingServiceProperties.IMAGING_WORKER_INSTANCE_TYPE;
  String emiName=com.eucalyptus.imaging.ImagingServiceProperties.IMAGING_WORKER_EMI;
  if (workerType == null || emiName == null)   return false;
  List<VmTypeDetails> allTypes=com.eucalyptus.imaging.EucalyptusActivityTasks.getInstance().describeVMTypes();
  long diskSizeBytes=0;
  for (  VmTypeDetails type : allTypes) {
    if (type.getName().equalsIgnoreCase(workerType)) {
      diskSizeBytes=type.getDisk() * GIG;
      break;
    }
  }
  MachineImageInfo emi=LookupMachine.INSTANCE.apply(emiName);
  long spaceLeft=diskSizeBytes - emi.getImageSizeBytes() - img.getImageSizeBytes()- 100 * 2 * MB;
  if (spaceLeft > 0)   return true;
  return false;
}
