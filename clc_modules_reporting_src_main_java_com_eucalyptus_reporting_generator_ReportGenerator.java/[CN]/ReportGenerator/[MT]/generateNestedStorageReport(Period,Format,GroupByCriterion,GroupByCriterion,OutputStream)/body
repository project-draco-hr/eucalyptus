{
  StorageUsageLog usageLog=StorageUsageLog.getStorageUsageLog();
  Map<String,Map<String,StorageUsageSummary>> summaryMap=usageLog.scanSummarize(period,groupBy,criterion);
  List items=new ArrayList(summaryMap.size());
  for (  String outerKey : summaryMap.keySet()) {
    Map<String,StorageUsageSummary> innerMap=summaryMap.get(outerKey);
    for (    String innerKey : innerMap.keySet()) {
      items.add(new StorageReportLine(innerKey,outerKey,innerMap.get(innerKey)));
    }
  }
  generateReport(new File(baseDir,NESTED_STORAGE_REPORT_FILENAME),format,groupBy.toString(),criterion.toString(),items,dest);
}
