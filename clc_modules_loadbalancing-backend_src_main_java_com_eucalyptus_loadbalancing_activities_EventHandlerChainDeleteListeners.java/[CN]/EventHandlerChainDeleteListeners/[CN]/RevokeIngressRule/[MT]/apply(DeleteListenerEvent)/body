{
  final Collection<Integer> ports=evt.getPorts();
  LoadBalancer lb=null;
  String groupName=null;
  try {
    lb=LoadBalancers.getLoadbalancer(evt.getContext(),evt.getLoadBalancer());
    final LoadBalancerSecurityGroupCoreView group=lb.getGroup();
    if (group != null)     groupName=group.getName();
  }
 catch (  Exception ex) {
    throw new EventHandlerException("could not find the loadbalancer",ex);
  }
  if (groupName == null) {
    LOG.warn("Group name is not found in the db");
    return;
  }
  String[] protocols=new String[]{"tcp"};
  for (  String protocol : protocols) {
    for (    Integer port : ports) {
      try {
        EucalyptusActivityTasks.getInstance().revokeSecurityGroup(groupName,protocol,port);
        LOG.debug(String.format("rule revoked (%s-%d)",groupName,port));
      }
 catch (      Exception ex) {
        LOG.warn("Unable to revoke the security group",ex);
      }
    }
  }
}
