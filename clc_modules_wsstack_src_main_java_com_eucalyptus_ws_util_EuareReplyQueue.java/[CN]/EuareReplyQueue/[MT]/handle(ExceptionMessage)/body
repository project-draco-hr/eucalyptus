{
  EventRecord.here(EuareReplyQueue.class,EventType.MSG_REPLY,exMsg.getPayload().getClass().getSimpleName()).debug();
  LOG.trace("Caught exception while servicing: " + exMsg.getPayload());
  Throwable exception=exMsg.getException();
  if (exception instanceof MessagingException && exception.getCause() instanceof EuareException) {
    LOG.debug("BEFORE create ErrorResponseType ");
    EuareException euareException=(EuareException)exception.getCause();
    ErrorResponseType errorResp=new ErrorResponseType();
    BaseMessage payload=null;
    try {
      payload=parsePayload(((MessagingException)exception).getUmoMessage().getPayload());
    }
 catch (    Exception e) {
      LOG.error("Failed to parse payload ",e);
    }
    if (payload != null) {
      errorResp.setCorrelationId(payload.getCorrelationId());
      errorResp.setRequestId(payload.getCorrelationId());
      ErrorType error=new ErrorType();
      error.setType("Receiver");
      error.setCode(euareException.getCode());
      error.setMessage(euareException.getError());
      error.getDetail().setContent(euareException.getMessage());
      errorResp.getErrorList().add(error);
      this.handle(errorResp);
    }
  }
}
