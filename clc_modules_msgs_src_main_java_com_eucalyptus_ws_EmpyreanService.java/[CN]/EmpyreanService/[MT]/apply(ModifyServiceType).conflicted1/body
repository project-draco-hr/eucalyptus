{
  try {
    final TopologyChanges.Transitions transition=TopologyChanges.Transitions.valueOf(request.getState().toUpperCase());
    String name=request.getName();
    ServiceConfiguration config=findService(name);
    if (TopologyChanges.Transitions.RESTART.equals(transition)) {
      Topology.stop(config).get();
      try {
        Topology.start(config).get();
      }
 catch (      Exception ex) {
        Exceptions.maybeInterrupted(ex);
        Logs.extreme().error(ex,ex);
        throw Exceptions.toUndeclared(ex);
      }
    }
 else {
      Topology.transition(transition.get()).apply(config).get();
    }
  }
 catch (  final Exception ex) {
    Exceptions.maybeInterrupted(ex);
    Logs.extreme().error(ex,ex);
    throw Exceptions.toUndeclared(ex);
  }
  return true;
}
