{
  try {
    final TransitionName transition=TransitionName.valueOf(request.getState().toUpperCase());
    String name=request.getName();
    ServiceConfiguration config=findService(name);
switch (transition) {
case DISABLE:
      Topology.disable(config).get();
    break;
case ENABLE:
  Topology.enable(config).get();
break;
case STOP:
Topology.stop(config).get();
break;
case START:
Topology.start(config).get();
break;
case RESTART:
Topology.stop(config).get();
try {
Topology.start(config).get();
}
 catch (Exception ex) {
Exceptions.maybeInterrupted(ex);
Logs.extreme().error(ex,ex);
}
break;
}
}
 catch (final Exception ex) {
Exceptions.maybeInterrupted(ex);
Logs.extreme().error(ex,ex);
return false;
}
return true;
}
