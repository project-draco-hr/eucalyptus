{
  DisableServiceResponseType reply=request.getReply();
  for (  ServiceInfoType serviceInfo : request.getServices()) {
    try {
      Component c=Components.lookup(serviceInfo.getType());
      for (      ServiceConfiguration config : c.lookupServiceConfigurations()) {
        String partition=config.getPartition();
        String name=config.getName();
        if (partition.equals(serviceInfo.getPartition()) && name.equals(serviceInfo.getName())) {
          if (Component.State.ENABLED.equals(config.lookupState())) {
            try {
              c.disableTransition(config);
              reply.getServices().add(serviceInfo);
            }
 catch (            ServiceRegistrationException ex) {
              LOG.error("DISABLE'ing service failed: " + ex.getMessage(),ex);
              return reply.markFailed();
            }
          }
 else {
            LOG.error("Attempt to DISABLE a service which is not currently ENABLED: " + config.toString());
            return reply.markFailed();
          }
        }
      }
    }
 catch (    NoSuchElementException ex) {
      Exceptions.trace("Failed to lookup component of type: " + serviceInfo.getType(),ex);
      return reply.markFailed();
    }
  }
  return reply;
}
