{
  EventRecord.here(AddressCategory.class,EventClass.ADDRESS,EventType.ADDRESS_ASSIGNING).withDetails(vm.getOwnerId(),addr.getName(),"instanceid",vm.getInstanceId()).withDetails("type",addr.isSystemOwned() ? "SYSTEM" : "USER").withDetails("cluster",addr.getCluster());
  return Callbacks.newClusterRequest(addr.assign(vm.getInstanceId(),vm.getPrivateAddress()).getCallback()).then(new Callback.Success<BaseMessage>(){
    public void fire(    BaseMessage response){
      vm.updatePublicAddress(addr.getName());
    }
  }
);
}
