{
  final String instanceId=addr.getInstanceId();
  return addr.unassign().getCallback().then(new SuccessCallback(){
    public void apply(    BaseMessage response){
      try {
        VmInstance vm=VmInstances.getInstance().lookup(instanceId);
        EventRecord.here(AddressCategory.class,EventClass.ADDRESS,EventType.ADDRESS_UNASSIGNING,"user=" + vm.getOwnerId(),"address=" + addr.getName(),"instanceid=" + vm.getInstanceId(),addr.isSystemOwned() ? "SYSTEM" : "USER").info();
        Addresses.system(vm);
      }
 catch (      NoSuchElementException e) {
      }
    }
  }
);
}
