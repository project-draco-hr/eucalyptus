{
  ExceptionMessage em=(ExceptionMessage)msg;
  try {
    String eucaMsgString=em.getPayloadAsString("UTF-8");
    EucalyptusMessage sourceMessage=(EucalyptusMessage)BindingManager.getBinding(BindingUtil.sanitizeNamespace("http://msgs.eucalyptus.ucsb.edu/")).fromOM(eucaMsgString);
    int i=0;
    Throwable exception=em.getException().getCause();
    EucalyptusCloudException myEx=null;
    if (exception instanceof EucalyptusCloudException)     myEx=(EucalyptusCloudException)exception;
 else     myEx=new EucalyptusCloudException(exception.getMessage(),exception);
    msg=new EucalyptusErrorMessageType(em.getEndpoint().getAddress(),sourceMessage,myEx.getMessage());
  }
 catch (  Exception e) {
    LOG.error(e,e);
  }
  return msg;
}
