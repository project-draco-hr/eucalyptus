{
  env.put(Context.INITIAL_CONTEXT_FACTORY,LDAP_CONTEXT_FACTORY);
  env.put(Context.PROVIDER_URL,lic.getServerUrl());
  env.put(Context.SECURITY_AUTHENTICATION,lic.getAuthMethod());
  if (!LicParser.LDAP_AUTH_METHOD_SASL_GSSAPI.equals(lic.getAuthMethod())) {
    env.put(Context.SECURITY_PRINCIPAL,lic.getAuthPrincipal());
    try {
      String credentials=sc.decryptOpenssl(lic.getAuthCredentials());
      env.put(Context.SECURITY_CREDENTIALS,credentials);
    }
 catch (    GeneralSecurityException e) {
      LOG.error(e,e);
      throw new LdapException("Decryption failure",e);
    }
  }
  if (lic.isUseSsl()) {
    env.put(Context.SECURITY_PROTOCOL,"ssl");
  }
}
