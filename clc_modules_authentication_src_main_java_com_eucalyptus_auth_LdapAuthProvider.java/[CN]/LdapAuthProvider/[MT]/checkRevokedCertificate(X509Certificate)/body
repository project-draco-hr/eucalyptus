{
  try {
    UserEntity searchUser=new UserEntity();
    searchUser.setEnabled(true);
    searchUser.setX509Certificate(cert);
    searchUser.revokeX509Certificate();
    User found;
    if ((found=LdapCache.getInstance().getUserByRevokedCert(searchUser.getCertificates().get(0).getPemCertificate())) == null) {
      found=EucaLdapHelper.getUsers(searchUser,null).get(0);
      LdapCache.getInstance().addUser(found);
    }
    if (found.isEnabled()) {
      return true;
    }
  }
 catch (  EntryNotFoundException e) {
    LOG.error(e,e);
    throw new NoSuchCertificateException("No user with the specified certificate.",e);
  }
catch (  LdapException e) {
    LOG.error(e,e);
  }
  return false;
}
