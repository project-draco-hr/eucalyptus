{
  try {
    UserEntity searchUser=new UserEntity();
    searchUser.setEnabled(true);
    searchUser.setX509Certificate(cert);
    List<User> users=EucaLdapHelper.getUsers(searchUser,null,null);
    if (users.size() != 1) {
      throw new NoSuchUserException((users.size() == 0) ? "No user with the specified certificate." : "Multiple users with the same certificate.");
    }
  }
 catch (  EntryNotFoundException e) {
    LOG.error(e,e);
    throw new NoSuchUserException(e);
  }
catch (  LdapException e) {
    LOG.error(e,e);
  }
  return null;
}
