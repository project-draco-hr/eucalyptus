{
  final Integer successes=regionDispatchAndReduce(new NonNullFunction<IdentityProvider,Either<AuthException,String>>(){
    @Nonnull @Override public Either<AuthException,String> apply(    final IdentityProvider identityProvider){
      try {
        identityProvider.reserveGlobalName(namespace,name,duration);
        return Either.right("");
      }
 catch (      AuthException e) {
        return Either.left(e);
      }
    }
  }
,0,CollectionUtils.<String>count(Predicates.notNull()));
  final int numberOfRegions=Iterables.size(regionConfigurationManager.getRegionInfos());
  if (successes < (1 + (numberOfRegions / 2))) {
    throw new AuthException(AuthException.CONFLICT);
  }
}
