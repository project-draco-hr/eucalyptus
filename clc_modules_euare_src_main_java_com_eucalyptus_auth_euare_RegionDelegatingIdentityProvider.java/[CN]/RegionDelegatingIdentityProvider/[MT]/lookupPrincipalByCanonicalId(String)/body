{
  if (regionConfigurationManager.getRegionInfo().isPresent() && Contexts.exists() && Contexts.lookup().getUser().getCanonicalId().equals(canonicalId)) {
    return Contexts.lookup().getUser();
  }
  return localProvider.lookupPrincipalByCanonicalId(canonicalId);
}
