{
  try {
    for (    UnrollableStage s : stages) {
      pipeline.addLast("pre-" + s.getStageName(),new StageBottomHandler(s));
      s.unrollStage(pipeline);
      pipeline.addLast("post-" + s.getStageName(),new StageTopHandler(s));
    }
    if (this.msgReceiver != null) {
      pipeline.addLast("service-sink",new ServiceSinkHandler(this.msgReceiver));
    }
 else {
      pipeline.addLast("service-sink",new ServiceSinkHandler());
    }
    for (    Map.Entry<String,ChannelHandler> e : pipeline.toMap().entrySet()) {
      LOG.info(" - handler: key=" + e.getKey() + " class="+ e.getValue().getClass().getSimpleName());
    }
  }
 catch (  Exception e) {
    LOG.error("Error unrolling pipeline: " + this.getPipelineName());
    LOG.error(e,e);
    pipeline.getChannel().close();
  }
}
