{
  Bucket searchBucket=new Bucket();
  searchBucket.setHidden(includeHidden);
  searchBucket.setOwnerCanonicalId(canonicalId);
  EntityTransaction db=Entities.get(Bucket.class);
  try {
    return Entities.count(searchBucket);
  }
 catch (  Exception e) {
    LOG.error("Error counting buckets for account canonicalId " + canonicalId + " due to DB transaction error",e);
    throw new ExecutionException(e);
  }
 finally {
    db.rollback();
  }
}
