{
  GetWalrusSnapshotResponseType reply=(GetWalrusSnapshotResponseType)request.getReply();
  String snapshotId=request.getKey();
  EntityWrapper<WalrusSnapshotInfo> db=EntityWrapper.get(WalrusSnapshotInfo.class);
  WalrusSnapshotInfo snapshotInfo=new WalrusSnapshotInfo(snapshotId);
  List<WalrusSnapshotInfo> snapshotInfos=db.query(snapshotInfo);
  if (snapshotInfos.size() > 0) {
    WalrusSnapshotInfo foundSnapshotInfo=snapshotInfos.get(0);
    String bucketName=foundSnapshotInfo.getSnapshotBucket();
    db.commit();
    GetObjectType getObjectType=new GetObjectType();
    getObjectType.setBucket(bucketName);
    getObjectType.setUserId(request.getUserId());
    getObjectType.setEffectiveUserId(request.getEffectiveUserId());
    getObjectType.setKey(snapshotId);
    getObjectType.setChannel(request.getChannel());
    getObjectType.setDeleteAfterGet(false);
    getObjectType.setGetData(true);
    getObjectType.setInlineData(false);
    getObjectType.setGetMetaData(false);
    getObjectType.setIsCompressed(false);
    try {
      walrusManager.getObject(getObjectType);
    }
 catch (    EucalyptusCloudException ex) {
      LOG.error(ex,ex);
      throw ex;
    }
  }
 else {
    db.rollback();
    throw new NoSuchEntityException(snapshotId);
  }
  return null;
}
